(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{372:function(e,t,a){e.exports=a(750)},377:function(e,t,a){},39:function(e){e.exports={url:{store:"https://stored.azurewebsites.net",auth:"https://storeauth.azurewebsites.net"},_github:{id:"c426e790821064328634"},_google:{id:"548560778490-kpllp0k9fhf7bdkfvlbjl0p4m88t0ipt.apps.googleusercontent.com"},strava:{id:"39689"},"2fa":!1,home:"/activities",configId:"5c606e8afb6fc06f052da3c9"}},727:function(e,t,a){},750:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a(12),s=a(14),i=a(13),c=a(15),l=a(0),o=a.n(l),u=a(43),p=a.n(u),d=(a(377),a(343)),h=a(147),f=a(47),m=a(338),v=a.n(m),b=a(37),g=a.n(b),w=a(339),O=a.n(w),E=a(9),k=a.n(E);function x(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}var y=o.a.createContext(),C=function(e){return function(t){return o.a.createElement(y.Consumer,null,function(a){return o.a.createElement(e,Object.assign({},t,{user:a}))})}},j=a(22),S=a(292),D=a.n(S),_=a(102),T=a.n(_),I=a(290),N=a.n(I),F=a(196),P=a.n(F),R=a(195),L=a.n(R),A=a(120),M=a.n(A),W=a(121),q=a.n(W),U=a(101),V=a.n(U),z=a(293),B=a.n(z),H=a(69),G=a.n(H),Y=a(27),K=a.n(Y),Z=a(294),J=a.n(Z),X=a(70),$=a.n(X),Q=a(150),ee=a.n(Q),te=a(7),ae=a(148),ne=a.n(ae),re=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleMenu=function(e){a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleClickAccount=function(){a.props.history.push("/account"),a.handleClose()},a.handleDrawerToggle=function(){a.setState(function(e){return{mobileOpen:!e.mobileOpen}})},a.redirect=function(e){Object(ae.isWidthDown)("md",a.props.width)&&a.handleDrawerToggle(),a.props.history.push(e.path)},a.state={mobileOpen:!1,anchorEl:null},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.theme,r=t.routes,s=t.user,i=this.state.anchorEl,c=Boolean(i),l=this.props.history.location.pathname,u=r.find(function(e){return e.path===l}),p=o.a.createElement("div",null,o.a.createElement("div",{className:a.toolbar}),o.a.createElement(N.a,null),o.a.createElement(M.a,null,r.map(function(t){return!t.exact||t.hidden||t.permission&&!s.hasPermission(t.permission)?null:o.a.createElement(q.a,{button:!0,key:t.name,onClick:function(){return e.redirect(t)}},o.a.createElement(V.a,{primary:t.label}))})));return u&&u.anonymous?o.a.createElement("div",{className:a.root},this.props.children):o.a.createElement("div",{className:a.root},o.a.createElement(T.a,null),o.a.createElement(D.a,{position:"fixed",className:a.appBar},o.a.createElement(G.a,null,o.a.createElement(g.a,{color:"inherit","aria-label":"Open drawer",onClick:this.handleDrawerToggle,className:a.menuButton},o.a.createElement(B.a,null)),o.a.createElement(K.a,{variant:"h6",color:"inherit",noWrap:!0,className:a.grow},u?u.label:"App"),o.a.createElement("div",null,o.a.createElement("span",null,s.user?s.user.name:null),o.a.createElement(g.a,{"aria-owns":c?"menu-appbar":void 0,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},o.a.createElement(J.a,null)),o.a.createElement(ee.a,{id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:c,onClose:this.handleClose},o.a.createElement($.a,{onClick:this.handleClickAccount},"My account"))))),o.a.createElement("nav",{className:a.drawer},o.a.createElement(L.a,{lgUp:!0,implementation:"css"},o.a.createElement(P.a,{variant:"temporary",anchor:"rtl"===n.direction?"right":"left",open:this.state.mobileOpen,onClose:this.handleDrawerToggle,classes:{paper:a.drawerPaper}},p)),o.a.createElement(L.a,{mdDown:!0,implementation:"css"},o.a.createElement(P.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0},p))),o.a.createElement("main",{className:a.content},o.a.createElement("div",{className:a.toolbar}),this.props.children))}}]),t}(o.a.Component),se=x(ne()(),Object(te.withStyles)(function(e){return{root:{display:"flex"},grow:{flexGrow:1},drawer:Object(j.a)({},e.breakpoints.up("lg"),{width:240,flexShrink:0}),appBar:Object(j.a)({marginLeft:240},e.breakpoints.up("lg"),{width:"calc(100% - ".concat(240,"px)")}),menuButton:Object(j.a)({marginRight:20},e.breakpoints.up("lg"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:240},content:{flexGrow:1,padding:2*e.spacing.unit,overflow:"auto"}}},{withTheme:!0}),f.f)(re),ie=a(33),ce=a.n(ie),le=a(24),oe=a.n(le),ue=a(3),pe=a.n(ue),de=a(5),he=a(156);var fe=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:160}}})(function(e){var t=e.classes;return o.a.createElement(he.a,{className:t.formControl,keyboard:!0,label:e.label,format:"MM/DD/YYYY",clearable:!e.required,mask:function(e){return e?[/\d/,/\d/,"/",/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/]:[]},value:e.value||null,onChange:function(t){return e.onChange(e.field,t?t.toDate():null)},disableOpenOnEnter:!0,animateYearScrolling:!1,style:{flex:1,display:"flex"},disabled:e.disabled})}),me=a(58),ve=a.n(me),be=a(55),ge=a.n(be),we=a(57),Oe=a.n(we);var Ee=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:100}}})(function(e){var t=e.classes;return o.a.createElement(ve.a,{className:t.formControl,fullWidth:e.fullWidth,required:e.required},o.a.createElement(Oe.a,{htmlFor:e.field},e.label),o.a.createElement(ge.a,{type:"new-password"===e.type?"password":e.type,id:e.field,value:e.value||"",onChange:function(t){return e.onChange(e.field,t.target.value)},placeholder:e.placeholder,autoComplete:"new-password"===e.type?"new-password":null,disabled:e.disabled,multiline:e.multiline,rows:e.rows,startAdornment:e.startAdornment}))});var ke=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWwidth:80}}})(function(e){var t=e.classes;return o.a.createElement(ve.a,{className:t.formControl,required:e.required,fullWidth:e.fullWidth},o.a.createElement(Oe.a,{htmlFor:e.field},e.label),o.a.createElement(ge.a,{id:e.field,value:e.value?e.value.toString():"0",onChange:function(t){return e.onChange(e.field,Number(t.target.value))},type:"number",disabled:e.disabled,inputProps:{min:e.min,max:e.max,step:e.step}}))}),xe=a(146),ye=a.n(xe),Ce=a(103),je=a.n(Ce);var Se=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:120}}})(function(e){var t=e.classes,a=e.data,n=e.textField,r=e.required,s=e.value,i=e.onChange,c=e.field,l=e.multiple;r&&null===s&&a&&a.length>0&&i(c,a[0]._id);var u=function(e){var t=a.find(function(t){return t._id===e});return t?t[n]:null};return o.a.createElement(ve.a,{className:t.formControl,required:r,fullWidth:e.fullWidth},e.label&&o.a.createElement(Oe.a,{htmlFor:e.field},e.label),o.a.createElement(ye.a,{value:null!==e.value?e.value:"",onChange:function(t){return i(e.field,t.target.value)},id:e.field,multiple:e.multiple,renderValue:function(e){return l?e.map(function(e){return u(e)}).join(" | "):u(e)},disabled:e.disabled},!e.required&&!l&&o.a.createElement($.a,{value:""},o.a.createElement("em",null,"None")),a.map(function(e){return o.a.createElement($.a,{key:e._id,value:e._id},l&&o.a.createElement(je.a,{checked:void 0!==s.find(function(t){return t===e._id})}),o.a.createElement(V.a,{primary:e[n]}))})))}),De=a(35),_e=a.n(De),Te=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.handleSubmit=function(e){e.preventDefault(),a.props.onSubmit()},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.inline,n=e.disabled;return o.a.createElement("form",{className:a?t.formInline:t.form,onSubmit:this.handleSubmit},this.props.children,!n&&o.a.createElement(_e.a,{className:t.submitButton,type:"submit",variant:"contained",color:"primary",disabled:n},"Save"))}}]),t}(o.a.Component),Ie=Object(te.withStyles)(function(e){return{formInline:{display:"flex",flexWrap:"wrap",flexDirection:"row"},form:{display:"flex",flexDirection:"column"},submitButton:{margin:e.spacing.unit}}})(Te),Ne=o.a.createContext(),Fe=function(e){return function(t){return o.a.createElement(Ne.Consumer,null,function(a){return o.a.createElement(e,Object.assign({},t,{store:a}))})}},Pe={date:new Date,name:"",duration:0,projectId:null,taskId:null},Re=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||Pe,a.handleChangeProject=function(e,t){var n=a.props.user.user,r=a.props.store,s=r.getOpenedTasks,i=r.handleChange;s(t,n),a.props.data||i(e,t),a.handleChange(e,t)},a.handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addTimeRecord,r=t.refreshTimeRecords,s=t.editTimeRecord,i=a.props.user.user,a.state.projectId){e.next=4;break}return e.abrupt("return");case 4:if(e.prev=4,!a.state._id){e.next=10;break}return e.next=8,s(a.state,i);case 8:e.next=12;break;case 10:return e.next=12,n(a.state,i);case 12:r(),a.setState(Pe),a.props.onSubmit&&a.props.onSubmit(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),a.props.user.showError(e.t0);case 20:case"end":return e.stop()}},e,null,[[4,17]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.date,n=t.name,r=t.duration,s=t.projectId,i=t.taskId,c=this.props.store,l=c.projects,u=c.tasks;return o.a.createElement(Ie,{onSubmit:this.handleSubmit,inline:!0},o.a.createElement("div",{className:e.nameTextInput},o.a.createElement(Ee,{label:"Name",value:n,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0})),o.a.createElement(Se,{label:"Project",value:s,field:"projectId",onChange:this.handleChangeProject,data:l.data,textField:"name",required:!0}),o.a.createElement(Se,{label:"Task",value:i,field:"taskId",onChange:this.handleChange,data:u.data,textField:"name"}),o.a.createElement(fe,{label:"Date",value:a,field:"date",onChange:this.handleChange,required:!0}),o.a.createElement(ke,{label:"Duration",value:r,field:"duration",onChange:this.handleChange,min:0,step:.25,required:!0}))}}]),t}(o.a.Component),Le=x(Object(te.withStyles)(function(e){return{nameTextInput:{display:"flex",flex:1}}}),Fe,C)(Re),Ae=a(45),Me=a(308),We=a.n(Me),qe=a(309),Ue=a.n(qe),Ve=a(64),ze=a.n(Ve),Be=a(310),He=a.n(Be),Ge=a(122),Ye=a.n(Ge),Ke=a(300),Ze=a.n(Ke),Je=a(301),Xe=a.n(Je),$e=a(48),Qe=a.n($e),et=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.onSelectAllClick,n=t.sort,r=t.numSelected,s=t.rowCount,i=t.rows,c=t.sortable;return o.a.createElement(Ze.a,null,o.a.createElement(Ye.a,null,o.a.createElement(ze.a,{padding:"checkbox"},o.a.createElement(je.a,{indeterminate:r>0&&r<s,checked:r===s,onChange:a})),i.map(function(t){return o.a.createElement(ze.a,{key:t.field,align:"num"===t.type?"right":"left",padding:t.disablePadding?"none":"default",sortDirection:n.field===t.field&&n.dir},!1===c||!1===t.sortable?t.label:o.a.createElement(Qe.a,{title:"Sort",placement:"num"===t.type?"bottom-end":"bottom-start",enterDelay:300},o.a.createElement(Xe.a,{active:n.field===t.field,direction:n.dir,onClick:e.createSortHandler(t.field)},t.label)))},this),o.a.createElement(ze.a,{padding:"none"})))}}]),t}(o.a.Component),tt=a(6),at=a.n(tt),nt=a(302),rt=a.n(nt),st=a(303),it=a.n(st),ct=a(152),lt=a.n(ct),ot=a(153),ut=a.n(ot),pt=a(62),dt=Object(te.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(pt.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 auto"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}})(function(e){var t=e.numSelected,a=e.classes,n=e.onDelete,r=e.onFilter,s=e.title,i=e.onExport,c=e.isFilterSet,l=e.actions,u=e.onRefresh,p=e.exportDisabled;return o.a.createElement(G.a,{className:at()(a.root,Object(j.a)({},a.highlight,t>0))},o.a.createElement("div",{className:a.title},t>0?o.a.createElement(K.a,{color:"inherit",variant:"subtitle1"},t," selected"):o.a.createElement(K.a,{variant:"h6",id:"tableTitle"},s)),o.a.createElement("div",{className:a.spacer}),o.a.createElement("div",{className:a.actions},l,t>0?o.a.createElement(Qe.a,{title:"Delete"},o.a.createElement(g.a,{"aria-label":"Delete",onClick:n},o.a.createElement(rt.a,null))):o.a.createElement(Qe.a,{title:"Filter list"},o.a.createElement(g.a,{"aria-label":"Filter list",color:c?"primary":"default",onClick:r},o.a.createElement(lt.a,null))),o.a.createElement(Qe.a,{title:"Export"},o.a.createElement(g.a,{"aria-label":"Export",onClick:i,disabled:p},o.a.createElement(it.a,null))),o.a.createElement(Qe.a,{title:"Refresh list"},o.a.createElement(g.a,{"aria-label":"Refresh list",onClick:u},o.a.createElement(ut.a,null)))))}),ht=a(63),ft=a.n(ht),mt=a(77),vt=a.n(mt),bt=a(151),gt=a.n(bt),wt=a(304),Ot=a.n(wt),Et=a(78),kt=a.n(Et);var xt=function(e){return o.a.createElement(ft.a,{open:e.isOpen,onClose:e.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},o.a.createElement(kt.a,{id:"alert-dialog-title"},e.title),o.a.createElement(gt.a,null,o.a.createElement(Ot.a,{id:"alert-dialog-description"},e.description)),o.a.createElement(vt.a,null,o.a.createElement(_e.a,{onClick:e.onClose,color:"primary"},"Cancel"),o.a.createElement(_e.a,{onClick:e.onConfirm,color:"primary",autoFocus:!0},"OK")))},yt=a(23),Ct=a.n(yt),jt=function(e,t,a){var n,r,s=[];a&&(t.forEach(function(e){r=e.field,(n=a[r])&&s.push.apply(s,Object(Ae.a)(e.data.find(function(e){return e._id===n}).filters))}),e.forEach(function(e){switch(e.type){case"num":r=e.field,(n=a[r])&&s.push({field:r,op:"eq",value:n});break;case"date":r=e.field,(n=a[r])&&(s.push({field:r,op:"lte",value:Ct()(n).endOf("day").toDate()}),s.push({field:r,op:"gte",value:Ct()(n).startOf("day").toDate()}));break;case"enum":r=e.idField,(n=a[r])&&n.length>0&&s.push({field:r,op:"in",value:n});break;default:r=e.field,(n=a[r])&&s.push({field:r,op:"regex",value:n})}}));return s},St=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.handleClear=function(){var e={};a.props.filters.forEach(function(t){e[t.field]=null}),a.props.rows.forEach(function(t){var a="enum"===t.type?t.idField:t.field;e[a]=null}),a.props.onConfirm(null),a.setState(e)},a.handleSubmit=function(){a.props.onConfirm(a.state)},a.buildFilter=function(e){if(!1===e.filterable)return null;switch(e.type){case"enum":var t=e.field.split(".").pop();return o.a.createElement(Se,{key:e.label,label:e.label,value:a.state[e.idField]||[],field:e.idField,onChange:a.handleChange,data:a.props.store[e.data].data,textField:t,multiple:!0});case"date":return o.a.createElement(fe,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange});case"num":return o.a.createElement(ke,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange,min:0});default:return o.a.createElement(Ee,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange})}},a.state=e.defaultState||{},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props;return o.a.createElement(ft.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:t.isOpen,onClose:t.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0},o.a.createElement(kt.a,{id:"alert-dialog-title"},"Filters"),this.props.filters.map(function(t){return o.a.createElement(Se,{value:e.state[t.field],field:t.field,label:t.label,onChange:e.handleChange,data:t.data,textField:"name"})}),t.rows.map(function(t){return e.buildFilter(t)}),o.a.createElement(vt.a,null,o.a.createElement(_e.a,{onClick:this.handleClear,color:"primary"},"Clear"),o.a.createElement(_e.a,{onClick:this.handleSubmit,color:"primary",autoFocus:!0},"OK")))}}]),t}(o.a.Component),Dt=a(305),_t=a.n(Dt),Tt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={anchorEl:null,isOpenDelete:!1},a.handleOpenMenu=function(e){a.setState({anchorEl:e.currentTarget})},a.handleCloseMenu=function(){a.setState({anchorEl:null})},a.handleCloseDelete=function(){a.setState({isOpenDelete:!1})},a.handleOpenDelete=function(){a.setState({isOpenDelete:!0,anchorEl:null})},a.onDelete=function(){a.props.onDelete(),a.handleCloseDelete()},a.onEdit=function(){a.props.onEdit(),a.handleCloseMenu()},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.anchorEl,a=e.isOpenDelete;return o.a.createElement("div",null,o.a.createElement(g.a,{"aria-owns":t?"actions-menu":void 0,"aria-haspopup":"true",edge:"end","aria-label":"actions",onClick:this.handleOpenMenu,disabled:this.props.disabled},o.a.createElement(_t.a,null)),o.a.createElement(ee.a,{id:"actions-menu",anchorEl:t,open:Boolean(t),onClose:this.handleCloseMenu},o.a.createElement($.a,{onClick:this.onEdit},"Edit"),o.a.createElement($.a,{onClick:this.handleOpenDelete},"Delete")),o.a.createElement(xt,{isOpen:a,onClose:this.handleCloseDelete,onConfirm:this.onDelete,title:"Delete",description:"Are you sure?"}))}}]),t}(o.a.Component),It=a(306),Nt=a.n(It);var Ft=Object(te.withStyles)(function(e){return{progress:{backgroundColor:"white",opacity:.8,position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1800,display:"flex",justifyContent:"center",alignItems:"center"}}})(function(e){var t=e.classes;return e.isLoading?o.a.createElement("div",{className:t.progress},o.a.createElement(Nt.a,null)):null}),Pt=a(307),Rt=a(50),Lt=a.n(Rt),At=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleRequestSort=function(e,t){var n=t,r="desc";a.state.sort.field===t&&"desc"===a.state.sort.dir&&(r="asc");var s={field:n,dir:r},i=a.state,c=i.filters,l=i.page,o=i.rowsPerPage;a.onChange(c,l,o,s),a.setState({sort:s})},a.handleSelectAllClick=function(e){if(e.target.checked){var t=a.props.store[a.props.data].data;a.setState(function(e){return{selected:t.filter(function(e){return!1===a.props.isDisabled(e)}).map(function(e){return e._id})}})}else a.setState({selected:[]})},a.handleClick=function(e){var t=a.state.selected,n=t.indexOf(e),r=[];-1===n?r=r.concat(t,e):0===n?r=r.concat(t.slice(1)):n===t.length-1?r=r.concat(t.slice(0,-1)):n>0&&(r=r.concat(t.slice(0,n),t.slice(n+1))),a.setState({selected:r})},a.handleChangePage=function(e,t){var n=a.state,r=n.filters,s=n.rowsPerPage,i=n.sort;a.onChange(r,t,s,i),a.setState({page:t})},a.handleChangeRowsPerPage=function(e){var t=e.target.value,n=a.state,r=n.filters,s=n.page,i=n.sort;a.onChange(r,s,t,i),a.setState({rowsPerPage:t})},a.isSelected=function(e){return-1!==a.state.selected.indexOf(e)},a.onChange=function(e,t,n,r){a.props.onChange(e,{limit:n,skip:n*t},r)},a.componentDidMount=function(){var e=a.state,t=e.filters,n=e.page,r=e.rowsPerPage,s=e.sort;a.onChange(t,n,r,s)},a.handleOpenFilter=function(){a.setState({isOpenFilter:!0})},a.handleCloseFilter=function(){a.setState({isOpenFilter:!1})},a.handleConfirmFilter=function(e){var t=jt(a.props.rows,a.props.filters,e),n=a.state,r=n.rowsPerPage,s=n.sort;a.onChange(t,0,r,s),a.setState({filters:t,page:0,isOpenFilter:!1})},a.onDeleteMultiple=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.selected,r=t.filters,s=t.page,i=t.rowsPerPage,c=t.sort,e.next=3,Promise.all(n.map(function(e){return a.props.onDelete(e)}));case 3:a.onChange(r,s,i,c),a.setState({selected:[]}),a.handleCloseDelete();case 6:case"end":return e.stop()}},e)})),a.strToDate=function(e){return new Date(e).toLocaleDateString("en-US")},a.getValue=function(e,t){var n=Lt.a.get(e,t.field);if(t.cell)return t.cell(e);switch(t.type){case"date":return a.strToDate(n);default:return n}},a.onDeleteSingle=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,r=n.filters,s=n.page,i=n.rowsPerPage,c=n.sort,e.next=3,a.props.onDelete(t);case 3:a.onChange(r,s,i,c);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleCloseDelete=function(){a.setState({isOpenDelete:!1})},a.handleOpenDelete=function(){a.setState({isOpenDelete:!0})},a.onExport=Object(de.a)(pe.a.mark(function e(){var t,n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.filters,r=t.sort,e.next=3,a.props.onChange(n,void 0,r);case 3:(s=e.sent)&&(a.setState({exported:s.data}),a.exportRef.current.link.click());case 5:case"end":return e.stop()}},e)})),a.handleRefresh=function(){var e=a.state,t=e.filters,n=e.page,r=e.rowsPerPage,s=e.sort;a.onChange(t,n,r,s)},a.state={selected:[],page:0,rowsPerPage:5,filters:jt(e.rows,e.filters,e.defaultFilters),sort:e.defaultSort||{field:"_id",dir:"asc"},isOpenDelete:!1,isOpenFilter:!1,filter:null,exported:[]},a.exportRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.rows,r=t.sortable,s=t.title,i=this.state,c=i.selected,l=i.rowsPerPage,u=i.page,p=i.sort,d=i.isOpenDelete,h=i.isOpenFilter,f=this.props.store[this.props.data],m=l-Math.min(l,f.total-u*l),v=this.props.filename||"data";return o.a.createElement(oe.a,{className:a.root},o.a.createElement(dt,{numSelected:c.length,onDelete:this.handleOpenDelete,onExport:this.onExport,onFilter:this.handleOpenFilter,title:s,isFilterSet:this.state.filters.length>0,actions:this.props.actions,onRefresh:this.handleRefresh,exportDisabled:!this.props.headers}),o.a.createElement("div",{className:a.tableWrapper},o.a.createElement(Ft,{isLoading:f.isLoading}),o.a.createElement(We.a,{className:a.table,"aria-labelledby":"tableTitle",size:"small"},o.a.createElement(et,{numSelected:c.length,sort:p,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:f.total,rows:n,sortable:r}),o.a.createElement(Ue.a,null,f.data.map(function(t){var a=e.isSelected(t._id),r=e.props.isDisabled(t);return o.a.createElement(Ye.a,{hover:!0,role:"checkbox","aria-checked":a,tabIndex:-1,key:t._id,selected:a},o.a.createElement(ze.a,{padding:"checkbox"},o.a.createElement(je.a,{checked:a,onClick:function(a){return e.handleClick(t._id)},disabled:r})),n.map(function(a){return o.a.createElement(ze.a,{key:a.field,align:"num"===a.type?"right":"left",padding:a.disablePadding?"none":"default"},e.getValue(t,a))}),o.a.createElement(ze.a,null,o.a.createElement(Tt,{onDelete:function(){return e.onDeleteSingle(t._id)},onEdit:function(){return e.props.onEdit(t)},disabled:r})))}),m>0&&o.a.createElement(Ye.a,{style:{height:49*m}},o.a.createElement(ze.a,{colSpan:6}))))),o.a.createElement(He.a,{rowsPerPageOptions:[5,10,25],component:"div",count:f.total,rowsPerPage:l,page:u,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}),o.a.createElement(xt,{isOpen:d,onClose:this.handleCloseDelete,onConfirm:this.onDeleteMultiple,title:"Delete time records",description:"Are you sure?"}),o.a.createElement(St,{isOpen:h,onClose:this.handleCloseFilter,onConfirm:this.handleConfirmFilter,store:this.props.store,rows:this.props.rows,filters:this.props.filters,defaultState:this.props.defaultFilters}),o.a.createElement(Pt.CSVLink,{data:this.state.exported,headers:this.props.headers,filename:"".concat(v,".csv"),style:{display:"none"},ref:this.exportRef,target:"_blank"}))}}]),t}(o.a.Component),Mt=Object(te.withStyles)(function(e){return{root:{width:"100%"},table:{},tableWrapper:{overflowX:"auto",position:"relative"}}})(At);var Wt,qt=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,width:160}}})(function(e){return o.a.createElement(ft.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:e.isOpen,fullWidth:!0},o.a.createElement(kt.a,{id:"simple-dialog-title"},e.title),e.children)}),Ut=function(e){return[{field:"name",disablePadding:!0,label:"Name"},{field:"date",type:"date",label:"Date"},{field:"_project.name",label:"Project",type:"enum",data:"projects",idField:"projectId"},{field:"_task.name",label:"Task",type:"enum",data:"tasks",idField:"taskId",filterable:!1},{field:"_user.name",label:"User",type:"enum",data:"users",idField:"userId",filterable:void 0===e.find(function(e){return"userId"===e.field})},{field:"duration",type:"num",label:"Duration",filterable:!1}]},Vt=[{label:"Name",key:"name"},{label:"Date",key:"date"},{label:"Project",key:"project.name"},{label:"Task",key:"task.name"},{label:"User",key:"user.name"},{label:"Duration",key:"duration"}],zt=[{label:"Period",field:"period",data:[{_id:1,name:"today",filters:[{field:"date",op:"lte",value:Ct()().endOf("day").toDate()},{field:"date",op:"gte",value:Ct()().startOf("day").toDate()}]},{_id:2,name:"this week",filters:[{field:"date",op:"lte",value:Ct()().endOf("week").toDate()},{field:"date",op:"gte",value:Ct()().startOf("week").toDate()}]},{_id:3,name:"last week",filters:[{field:"date",op:"lte",value:Ct()().subtract(1,"weeks").endOf("week").toDate()},{field:"date",op:"gte",value:Ct()().subtract(1,"weeks").startOf("week").toDate()}]},{_id:4,name:"this month",filters:[{field:"date",op:"lte",value:Ct()().endOf("month").toDate()},{field:"date",op:"gte",value:Ct()().startOf("month").toDate()}]},{_id:5,name:"last month",filters:[{field:"date",op:"lte",value:Ct()().subtract(1,"month").endOf("month").toDate()},{field:"date",op:"gte",value:Ct()().subtract(1,"month").startOf("month").toDate()}]},{_id:6,name:"this year",filters:[{field:"date",op:"lte",value:Ct()().endOf("year").toDate()},{field:"date",op:"gte",value:Ct()().startOf("year").toDate()}]},{_id:7,name:"last year",filters:[{field:"date",op:"lte",value:Ct()().subtract(1,"year").endOf("month").toDate()},{field:"date",op:"gte",value:Ct()().subtract(1,"year").startOf("year").toDate()}]}]}],Bt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleClose=function(){var e=a.props.user.user,t=a.props.store,n=t.projectId;(0,t.getOpenedTasks)(n,e),a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=[].concat(Object(Ae.a)(a.props.filters),Object(Ae.a)(t)),e.next=4,a.props.store.getTimeRecords(r,n);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),a.props.user.showError(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),a.onEdit=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.user.user,e.next=3,a.props.store.getOpenedTasks(t.projectId,n);case 3:a.setState({x:t,isOpen:!0});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a.state={x:null,isOpen:!1},Wt=Ut(e.filters),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(de.a)(pe.a.mark(function e(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{this.props.store.getClients()}catch(t){this.props.user.showError(t)}case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.store.deleteTimeRecord;return o.a.createElement("div",null,o.a.createElement(Mt,{rows:Wt,data:"timeRecords",onChange:this.handleChange,sortable:!1,onDelete:e,title:"Time records",onEdit:this.onEdit,store:this.props.store,filters:zt,defaultFilters:this.props.defaultFilters,isDisabled:this.isDisabled,headers:Vt}),o.a.createElement(qt,{title:"Edit time record",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(Le,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),Ht=x(Fe,C)(Bt);var Gt=x(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),C)(function(e){var t=e.user.user;return o.a.createElement(ce.a,{container:!0,spacing:16},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(oe.a,{className:e.classes.paper},o.a.createElement(Le,null))),o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(Ht,{filters:[{field:"userId",value:t._id}]})))}),Yt=a(104),Kt=a.n(Yt),Zt=a(154),Jt=a.n(Zt),Xt=a(39),$t=a(41),Qt=a.n($t);var ea=function(e){return o.a.createElement(Qt.a,e,o.a.createElement("path",{d:"M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"}))},ta=function(e){return Xt.github?o.a.createElement(_e.a,{fullWidth:e.fullWidth,variant:"outlined",color:"primary",tooltip:"Github",onClick:function(){var e="https://github.com/login/oauth/authorize?client_id=".concat(Xt.github.id,"&scope=user&redirect_uri=").concat("https://kristianduda.sk/app","?provider=1");window.location.replace(e)},disabled:e.disabled},o.a.createElement(ea,{fontSize:"large"})," ",o.a.createElement("span",{style:{width:200}},e.title)):null};var aa=function(e){return o.a.createElement(Qt.a,e,o.a.createElement("path",{d:"M21.35,11.1H12.18V13.83H18.69C18.36,17.64 15.19,19.27 12.19,19.27C8.36,19.27 5,16.25 5,12C5,7.9 8.2,4.73 12.2,4.73C15.29,4.73 17.1,6.7 17.1,6.7L19,4.72C19,4.72 16.56,2 12.1,2C6.42,2 2.03,6.8 2.03,12C2.03,17.05 6.16,22 12.25,22C17.6,22 21.5,18.33 21.5,12.91C21.5,11.76 21.35,11.1 21.35,11.1V11.1Z"}))},na=function(e){return Xt.google?o.a.createElement(_e.a,{fullWidth:e.fullWidth,variant:"outlined",color:"primary",onClick:function(){var e="https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/userinfo.profile&redirect_uri=".concat("https://kristianduda.sk/app","?provider=2&response_type=code&client_id=").concat(Xt.google.id);window.location.replace(e)},disabled:e.disabled},o.a.createElement(aa,{fontSize:"large"})," ",o.a.createElement("span",{style:{width:200}},e.title)):null};var ra=function(e){return o.a.createElement(Qt.a,e,o.a.createElement("path",{d:"M14.92 17.16l1.83-3.63h2.7l-4.51 8.97l-4.57-8.97h2.7l1.85 3.63m-4.29-8.5l-2.45 4.89H4.55L10.61 1.5l6.13 12.05h-3.63l-2.48-4.89z"}))},sa=function(e){return Xt.strava?o.a.createElement(_e.a,{fullWidth:e.fullWidth,variant:"outlined",color:"primary",onClick:function(){var e="https://www.strava.com/oauth/authorize?client_id=".concat(Xt.strava.id,"&response_type=code&scope=read,activity:read&redirect_uri=").concat("https://kristianduda.sk/app","?provider=4");window.location.replace(e)},disabled:e.disabled},o.a.createElement(ra,{fontSize:"large"})," ",o.a.createElement("span",null,e.title)):null},ia=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleSubmit=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({disabled:!0}),n=a.state,r=n.username,s=n.password,i=n.token,e.prev=3,e.next=6,a.props.user.auth(r.trim().toLowerCase(),s,i);case 6:null===e.sent&&a.props.user.showMsg("Unauthorized"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),a.props.user.showError(e.t0);case 13:a.setState({disabled:!1});case 14:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){a.setState(Object(j.a)({},e.target.name,e.target.value))},a.handleClickReset=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=a.state.username)){e.next=11;break}return e.prev=2,e.next=5,a.props.user.reset(t.trim().toLowerCase());case 5:a.props.user.showMsg("Mail sended."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),a.props.user.showError(e.t0);case 11:case"end":return e.stop()}},e,null,[[2,8]])})),a.state={username:"",password:"",token:"",disabled:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.user,n=this.state,r=n.username,s=n.password,i=n.disabled,c=n.oAuth,l=n.token,u=(this.props.location.state||{from:{pathname:Xt.home}}).from;return c?null:a.user?o.a.createElement(f.a,{to:u}):o.a.createElement("main",{className:t.main},o.a.createElement(T.a,null),o.a.createElement(oe.a,{className:t.paper},o.a.createElement(Kt.a,{className:t.avatar},o.a.createElement(Jt.a,null)),o.a.createElement(ta,{fullWidth:!0,disabled:i,title:"Sign in with Github"}),o.a.createElement(na,{fullWidth:!0,disabled:i,title:"Sign in with Google"}),o.a.createElement(sa,{fullWidth:!0,disabled:i,title:"Sign in with Strava"}),o.a.createElement(K.a,{variant:"body1"},"or use your account"),o.a.createElement("form",{className:t.form,onSubmit:this.handleSubmit},o.a.createElement(ve.a,{margin:"normal",required:!0,fullWidth:!0},o.a.createElement(Oe.a,{htmlFor:"username"},"Username"),o.a.createElement(ge.a,{id:"username",name:"username",autoComplete:"username",autoFocus:!0,value:r,onChange:this.handleChange})),o.a.createElement(ve.a,{margin:"normal",required:!0,fullWidth:!0},o.a.createElement(Oe.a,{htmlFor:"password"},"Password"),o.a.createElement(ge.a,{name:"password",type:"password",id:"password",autoComplete:"current-password",value:s,onChange:this.handleChange})),Xt["2fa"]&&o.a.createElement(ve.a,{margin:"normal",fullWidth:!0},o.a.createElement(Oe.a,{htmlFor:"password"},"Token"),o.a.createElement(ge.a,{name:"token",id:"token",value:l,onChange:this.handleChange})),o.a.createElement(_e.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,disabled:i},"Sign in"))))}}]),t}(o.a.Component),ca=x(k()(function(e){return{main:Object(j.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:2*e.spacing.unit,marginBottom:2*e.spacing.unit},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main,marginBottom:2*e.spacing.unit},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit},forgot:{marginTop:e.spacing.unit}}}),C,Fe)(ia),la={name:"",collaborators:[]},oa=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||la,a.handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addProject,r=t.getProjects,s=t.editProject,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,i);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i);case 10:r(),a.setState(la),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(de.a)(pe.a.mark(function e(){var t,a,n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.user.getUsers,a=this.props.user.user,n=[{field:"_id",op:"ne",value:a._id}],e.prev=3,e.next=6,t(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),this.props.user.showError(e.t0);case 11:case"end":return e.stop()}},e,this,[[3,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.name,n=t.collaborators,r=this.props.user.users;return o.a.createElement(Ie,{onSubmit:this.handleSubmit,inline:!0},o.a.createElement(Ee,{label:"Name",value:a,field:"name",onChange:this.handleChange,required:!0}),o.a.createElement("div",{className:e.collaborators},o.a.createElement(Se,{label:"Collaborators",value:n,field:"collaborators",onChange:this.handleChange,data:r.data,textField:"name",fullWidth:!0,multiple:!0})))}}]),t}(o.a.Component),ua=x(Object(te.withStyles)(function(e){return{collaborators:{display:"flex",flex:1}}}),Fe,C)(oa),pa=a(311),da=a.n(pa),ha=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).onDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,r=n.onDelete,s=n.onChange,e.next=3,r(t);case 3:s();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.onChange()}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.onClick,r=t.primaryTextField,s=t.secondaryTextField,i=t.onEdit,c=t.isDisabled,l=t.classes;return o.a.createElement(oe.a,{className:l.listWrapper},o.a.createElement(Ft,{isLoading:a.isLoading}),o.a.createElement(M.a,null,a.data.map(function(t){return o.a.createElement(q.a,{key:t._id,button:!0,onClick:function(){return n(t._id)}},o.a.createElement(V.a,{primary:Lt.a.get(t,r),secondary:s?Lt.a.get(t,s):null}),o.a.createElement(da.a,null,o.a.createElement(Tt,{disabled:c(t),onEdit:function(){return i(t)},onDelete:function(){return e.onDelete(t._id)}})))})))}}]),t}(o.a.Component),fa=Object(te.withStyles)(function(e){return{listWrapper:{position:"relative"}}})(ha),ma=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleClick=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props.history.location.pathname+"/"+t,a.props.history.push(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){try{a.props.store.getProjects(a.props.user.user)}catch(t){a.props.user.showError(t)}},a.handleEdit=function(e){a.setState({x:e,isOpen:!0})},a.handleDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.deleteProject,e.prev=1,e.next=4,n(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.projects;return o.a.createElement("div",{className:e.list},o.a.createElement(fa,{data:t,primaryTextField:"name",onClick:this.handleClick,onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled}),o.a.createElement(qt,{title:"Edit project",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(ua,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),va=x(Object(te.withStyles)(function(e){return{list:{marginTop:e.spacing.unit}}}),Fe,C,f.f)(ma);var ba=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return o.a.createElement(ce.a,{container:!0,spacing:24},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(oe.a,{className:e.classes.paper},o.a.createElement(ua,null)),o.a.createElement(va,null)))}),ga={name:"",assignedToId:null,stateId:1},wa=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||ga,a.handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addTask,r=t.refreshTasks,s=t.editTask,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i,a.props.projectId);case 10:r(),a.setState(ga),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.states,a=this.state,n=a.name,r=a.assignedToId,s=a.stateId,i=this.props.store.users;return o.a.createElement(Ie,{onSubmit:this.handleSubmit,inline:!0},o.a.createElement("div",{className:e.name},o.a.createElement(Ee,{label:"Name",value:n,field:"name",onChange:this.handleChange,required:!0,fullWidth:!0})),o.a.createElement(Se,{label:"Assigned to",value:r,field:"assignedToId",onChange:this.handleChange,data:i.data,textField:"name"}),o.a.createElement(Se,{label:"State",value:s,field:"stateId",onChange:this.handleChange,data:t.data,required:!0,textField:"name"}))}}]),t}(o.a.Component),Oa=x(Object(te.withStyles)(function(e){return{name:{display:"flex",flex:1}}}),Fe,C)(wa),Ea=[{field:"name",disablePadding:!0,label:"Name"},{field:"_assignedTo.name",label:"Assigned to",type:"enum",data:"users",idField:"assignedToId",sortable:!1},{field:"_state.name",label:"State",type:"enum",data:"states",idField:"stateId",sortable:!1}],ka=[{label:"Name",key:"name"},{label:"Assigned to",key:"assignedTo.name"},{label:"State",key:"state.name"}],xa=[],ya=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getTasks(a.props.projectId,t,n,r);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onEdit=function(e){a.setState({x:e,isOpen:!0})},a.isDisabled=function(e){return a.props.user.user._id!==e.userId&&a.props.user.user._id!==e.assignedToId},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store,t=e.deleteTask,a=e.project,n=a?"".concat(a.name,"_tasks"):null;return o.a.createElement("div",null,o.a.createElement(Mt,{rows:Ea,data:"tasks",onChange:this.handleChange,onDelete:t,title:"Tasks",onEdit:this.onEdit,store:this.props.store,filters:xa,isDisabled:this.isDisabled,filename:n,headers:ka}),o.a.createElement(qt,{title:"Edit task",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(Oa,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),Ca=x(Fe,C)(ya),ja=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(de.a)(pe.a.mark(function e(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.store.getProject(this.props.match.params.id);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.props.user.showError(e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return o.a.createElement(ce.a,{container:!0,spacing:24},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(oe.a,{className:this.props.classes.paper},o.a.createElement(Oa,{projectId:this.props.match.params.id}))),o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(Ca,{projectId:this.props.match.params.id})))}}]),t}(o.a.Component),Sa=x(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),Fe)(ja),Da=a(34);var _a=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,width:160}}})(function(e){return o.a.createElement(ft.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:e.isOpen,fullWidth:!0},o.a.createElement(kt.a,{id:"simple-dialog-title"},e.title),e.children,o.a.createElement(vt.a,null,e.onCancel&&o.a.createElement(_e.a,{onClick:e.onCancel,color:"primary"},"Cancel"),e.onConfirm&&o.a.createElement(_e.a,{onClick:e.onConfirm,color:"primary",autoFocus:!0},"OK")))}),Ta=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.defaultValue,n=e.tooltip,r=e.onClick,s=e.className,i=e.placement;return o.a.createElement(Qe.a,{title:n,"aria-label":n,placement:i},o.a.createElement(Kt.a,{style:{textTransform:"uppercase"},alt:a,src:t?"data:image/jpeg;base64,"+t:null,onClick:r,className:s},n[0]))}}]),t}(o.a.Component),Ia=Object(te.withStyles)(function(e){return{}})(Ta),Na=function(e){return{col:{display:"flex",flex:1,flexDirection:"column",marginBottom:e.spacing.unit},row:{display:"flex",flexWrap:"wrap",flexDirection:"row"},center:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},paper:{padding:e.spacing.unit},flex:{display:"flex"},grow:{display:"flex",flex:1}}},Fa=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).resize=function(e,t){return new Promise(function(n){var r=new Image,s=a.canvasRef.current;r.onload=function(){r.height>t&&(r.width*=t/r.height,r.height=t);var e=s.getContext("2d");e.clearRect(0,0,s.width,s.height),s.width=r.width,s.height=r.height,e.drawImage(r,0,0,r.width,r.height);var a=s.toDataURL("image/jpeg");n(a)},r.src=e})},a.onChange=function(e){e.preventDefault();var t=new FileReader;t.onloadend=Object(de.a)(pe.a.mark(function e(){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.resize(t.result,320);case 2:n=(n=e.sent).split(",").pop(),a.props.onChange(a.props.field,n);case 5:case"end":return e.stop()}},e)})),t.readAsDataURL(e.target.files[0])},a.onClick=function(){a.props.disabled||a.inputRef.current.click()},a.inputRef=o.a.createRef(),a.canvasRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.value,n=e.tooltip,r=e.disabled;return o.a.createElement("div",{className:t.center,style:{cursor:r?"default":"pointer"}},o.a.createElement(Ia,{className:t.bigAvatar,value:a,onClick:this.onClick,tooltip:n,placement:"right"}),o.a.createElement("input",{ref:this.inputRef,style:{display:"none"},type:"file",accept:"image/jpeg",onChange:this.onChange}),o.a.createElement("canvas",{style:{display:"none"},ref:this.canvasRef}))}}]),t}(o.a.Component),Pa=Object(te.withStyles)(function(e){return Object(Da.a)({},Na(e),{bigAvatar:{margin:e.spacing.unit,width:80,height:80}})})(Fa),Ra=a(312),La=a.n(Ra),Aa=a(313),Ma=a.n(Aa);var Wa=Object(te.withStyles)(function(e){return{formControl:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit}}})(function(e){var t=e.classes;return o.a.createElement(La.a,{className:t.formControl,control:o.a.createElement(Ma.a,{checked:e.value,onChange:function(t){return e.onChange(e.field,t.target.checked)},value:e.field,disabled:e.disabled}),label:e.label})}),qa={password:"",repeatedPassword:"",name:"",username:"",email:"",otp:!1,avatar:null},Ua=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=Object(Da.a)({},qa,a.props.user.user,{isOpenSecretDialog:!1,avatarChanged:!1}),a.handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.handleChangeAvatar=function(e,t){var n;a.setState((n={},Object(j.a)(n,e,t),Object(j.a)(n,"avatarChanged",!0),n))},a.generateSecret=Object(de.a)(pe.a.mark(function e(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.user.generateSecret();case 3:a.handleOpenSecretDialog(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])})),a.handleOpenSecretDialog=function(){a.setState({isOpenSecretDialog:!0})},a.handleCloseSecretDialog=function(){a.setState({isOpenSecretDialog:!1})},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c,l,o,u;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.password,r=t.repeatedPassword,s=t.name,i=t.username,c=t.email,l=t.otp,o=t.avatar,u=t.avatarChanged,n===r){e.next=4;break}return a.props.user.showMsg("Passwords do not match."),e.abrupt("return");case 4:return e.prev=4,e.next=7,a.props.user.updateUser(a.state._id,{name:s,username:i,email:c,password:n,otp:l,avatar:u?o:null});case 7:a.setState(Object(Da.a)({},a.props.user.user)),a.props.user.showMsg("Ok."),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),a.props.user.showError(e.t0);case 14:case"end":return e.stop()}},e,null,[[4,11]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.password,s=n.repeatedPassword,i=n.username,c=n.name,l=n.email,u=n.otp,p=n.avatar;return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ie,{onSubmit:this.handleSubmit,disabled:a},o.a.createElement(Pa,{field:"avatar",onChange:this.handleChangeAvatar,value:p,disabled:a,tooltip:c||""}),o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{label:"Name",value:c,field:"name",onChange:this.handleChange,required:!0,disabled:a})),o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{label:"Email",value:l,field:"email",onChange:this.handleChange,disabled:a}))),o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{label:"Username",value:i,field:"username",onChange:this.handleChange,required:!0,disabled:!0})),o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{label:"Password",value:r,field:"password",type:"new-password",onChange:this.handleChange,disabled:a})),o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{label:"Password again",value:s,field:"repeatedPassword",type:"password",onChange:this.handleChange,disabled:a}))),Xt["2fa"]&&o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement("div",null,o.a.createElement(Wa,{label:"2FA",value:u,field:"otp",onChange:this.handleChange,disabled:a}),o.a.createElement(_e.a,{color:"primary",disabled:a||!this.state.otp,onClick:this.generateSecret},"Generate secret"))))),o.a.createElement(_a,{title:"Secret",isOpen:this.state.isOpenSecretDialog,onConfirm:this.handleCloseSecretDialog},o.a.createElement("div",{className:t.center},this.props.user.secret&&o.a.createElement("img",{src:"data:image/jpeg;base64,"+this.props.user.secret.qrCode,alt:"secret",width:320,height:320}))))}}]),t}(o.a.Component),Va=x(Object(te.withStyles)(function(e){return Object(Da.a)({},Na(e),{heading:{marginLeft:e.spacing.unit},detailHeading:{marginLeft:e.spacing.unit,marginTop:3*e.spacing.unit},actions:{float:"right",margin:e.spacing.unit}})}),Fe,C)(Ua),za={user:1,store:2,mail:4,file:8,report:16,tags:1024,tasks:2048,events:4096,activities:2};var Ba=x(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit},heading:{marginLeft:e.spacing.unit},connected:{padding:e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"flex-start"}}}),C)(function(e){var t=e.user,a=t.user,n=!(0,t.hasPermission)(za.user);return o.a.createElement(ce.a,{container:!0,spacing:16},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(oe.a,{className:e.classes.paper},o.a.createElement(Va,{disabled:n}))),o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(oe.a,{className:e.classes.connected},o.a.createElement(K.a,{variant:"h6",className:e.classes.heading},"Connected apps"),o.a.createElement(ta,{disabled:n||a.github,title:e.user.user.github?e.user.user.github.name:"Connect Github"}),o.a.createElement(na,{disabled:n||a.google,title:e.user.user.google?e.user.user.google.name:"Connect Google"}),o.a.createElement("div",null,o.a.createElement(sa,{disabled:n,title:e.user.user.strava?"Sync":"Connect"}),e.user.user.strava&&e.user.user.strava.synced&&o.a.createElement("span",null," (last sync ",new Date(e.user.user.strava.synced).toLocaleDateString(),") ")))))}),Ha=a(87),Ga=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.stats,t=this.props.theme;return o.a.createElement(oe.a,{className:this.props.classes.paper},o.a.createElement(Ha.b,{width:800,height:300,data:e.data},o.a.createElement(Ha.c,{strokeDasharray:"3 3"}),o.a.createElement(Ha.e,{dataKey:"name"}),o.a.createElement(Ha.f,null),o.a.createElement(Ha.d,null),o.a.createElement(Ha.a,{dataKey:"val",fill:t.palette.primary.main})),o.a.createElement(K.a,{variant:"body2",color:"textPrimary",component:"p",className:this.props.classes.heading},"Total: ",e.sum))}}]),t}(l.PureComponent),Ya=x(Fe,Object(te.withStyles)(function(e){return{paper:{width:"100%",padding:e.spacing.unit,overflowX:"auto",margin:"auto"},heading:{marginLeft:e.spacing.unit}}}),Object(te.withTheme)())(Ga);var Ka,Za,Ja,Xa=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return o.a.createElement(ce.a,{container:!0,spacing:16},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(Ya,null)),o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(Ht,{filters:[],defaultFilters:{period:4}})))}),$a=function(e){function t(e){var a;Object(n.a)(this,t),a=Object(s.a)(this,Object(i.a)(t).call(this,e));var r=new URLSearchParams(a.props.location.search);return Za=r.get("provider"),Ka=r.get("code"),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Za||Ja){e.next=22;break}if(Ja=!0,t=this.props.user,e.prev=3,!t.user){e.next=10;break}return e.next=7,t.updateOauth(Za,Ka);case 7:this.props.history.replace("/account"),e.next=15;break;case 10:return e.next=12,t.oAuth(Za,Ka);case 12:if(e.sent){e.next=14;break}t.showMsg("Unauthorized");case 14:this.props.history.replace(Xt.home);case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),this.props.user.showError(e.t0),this.props.history.replace("/login");case 21:Ja=!1;case 22:case"end":return e.stop()}},e,this,[[3,17]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.classes;return Za?o.a.createElement("main",{className:e.main},o.a.createElement(T.a,null),o.a.createElement(oe.a,{className:e.paper},o.a.createElement(Kt.a,{className:e.avatar},o.a.createElement(Jt.a,null)),o.a.createElement("div",{className:e.loader},o.a.createElement(K.a,{component:"h1",variant:"h5"},"loading...")))):o.a.createElement(f.a,{to:{pathname:Xt.home}})}}]),t}(o.a.Component),Qa=x(k()(function(e){return{main:Object(j.a)({width:"100%",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},loader:{marginTop:e.spacing.unit}}}),C,Fe)($a),en={name:"",address:"",ico:"",dic:"",icdph:"",rate:0,reportId:"",activity:""},tn=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||en,a.handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addClient,r=t.getClients,s=t.editClient,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,i);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i);case 10:r(),a.props.onSubmit&&a.props.onSubmit(),a.setState(en),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.name,s=n.address,i=n.ico,c=n.dic,l=n.icdph,u=n.rate,p=n.reportId,d=n.activity;return o.a.createElement(Ie,{onSubmit:this.handleSubmit,disabled:a},o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{label:"Name",value:r,field:"name",onChange:this.handleChange,required:!0,disabled:a}))),o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{className:t.col,label:"Address",value:s,field:"address",onChange:this.handleChange,required:!0,disabled:a}))),o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{label:"I\u010cO",value:i,field:"ico",onChange:this.handleChange,required:!0,disabled:a})),o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{className:t.col,label:"DI\u010c",value:c,field:"dic",onChange:this.handleChange,required:!0,disabled:a})),o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{className:t.col,label:"I\u010c DPH",value:l,field:"icdph",onChange:this.handleChange,required:!0,disabled:a}))),o.a.createElement("div",{className:t.row},o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{label:"Activity",value:d,field:"activity",onChange:this.handleChange,required:!0,disabled:a})),o.a.createElement("div",{className:t.col},o.a.createElement(ke,{label:"Rate",value:u,field:"rate",onChange:this.handleChange,min:0,step:.5,required:!0})),o.a.createElement("div",{className:t.col},o.a.createElement(Ee,{className:t.col,label:"ReportId",value:p,field:"reportId",onChange:this.handleChange,required:!0,disabled:a}))))}}]),t}(o.a.Component),an=x(Object(te.withStyles)(function(e){return Object(Da.a)({},Na(e))}),Fe,C)(tn),nn=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleClick=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props.history.location.pathname+"/"+t,a.props.history.push(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){try{a.props.store.getClients()}catch(t){a.props.user.showError(t)}},a.handleEdit=function(e){a.setState({x:e,isOpen:!0})},a.handleDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.deleteClient,e.prev=1,e.next=4,n(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.clients;return o.a.createElement("div",{className:e.list},o.a.createElement(fa,{data:t,primaryTextField:"name",onClick:this.handleClick,onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled}),o.a.createElement(qt,{title:"Edit client",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(an,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),rn=x(Object(te.withStyles)(function(e){return{list:{marginTop:e.spacing.unit}}}),Fe,C,f.f)(nn);var sn=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return o.a.createElement(ce.a,{container:!0,spacing:24},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(oe.a,{className:e.classes.paper},o.a.createElement(an,null)),o.a.createElement(rn,null)))}),cn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).getInitState=function(e){var t=e.date||Ct()().add(1,"days").toDate();return{start:t,end:t,name:"",eventTypeId:1}},a.handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.handleChangeStart=function(e,t){t.getTime()>a.state.end.getTime()?a.setState({start:t,end:t}):a.setState({start:t})},a.handleChangeEnd=function(e,t){t.getTime()<a.state.start.getTime()?a.setState({start:t,end:t}):a.setState({end:t})},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addEvent,r=t.refreshEvents,s=t.editEvent,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,i);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i);case 10:r(),a.setState(a.getInitState(a.props)),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a.state=e.data||a.getInitState(e),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.name,s=n.eventTypeId,i=n.start,c=n.end,l=this.props.store.eventTypes;return o.a.createElement(Ie,{onSubmit:this.handleSubmit,inline:!0,disabled:a},o.a.createElement("div",{className:t.nameTextInput},o.a.createElement(Ee,{label:"Name",value:r,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:a})),o.a.createElement(Se,{label:"Type",value:s,field:"eventTypeId",onChange:this.handleChange,data:l.data,textField:"name",required:!0,disabled:a}),o.a.createElement("div",{className:t.nameTextInput},o.a.createElement(fe,{label:"Start",value:i,field:"start",onChange:this.handleChangeStart,required:!0,disabled:a}),o.a.createElement(fe,{label:"End",value:c,field:"end",onChange:this.handleChangeEnd,required:!0,disabled:a})))}}]),t}(o.a.Component),ln=x(Object(te.withStyles)(function(e){return{nameTextInput:{display:"flex",flex:1}}}),Fe,C)(cn),on=[{field:"name",disablePadding:!0,label:"Name"},{field:"_eventType.name",label:"Type",type:"enum",data:"eventTypes",idField:"eventTypeId"},{field:"start",type:"date",label:"Start",filterable:!1},{field:"end",type:"date",label:"End",filterable:!1},{field:"_user.name",label:"User",type:"enum",data:"users",idField:"userId"}],un=[{label:"Name",key:"name"},{label:"Type",key:"eventType.name"},{label:"Start",key:"start"},{label:"End",key:"end"},{label:"User",key:"user.name"}],pn=[{label:"Period",field:"period",data:[{_id:1,name:"today",filters:[{field:"start",op:"lte",value:Ct()().endOf("day").toDate()},{field:"start",op:"gte",value:Ct()().startOf("day").toDate()}]},{_id:2,name:"this week",filters:[{field:"start",op:"lte",value:Ct()().endOf("week").toDate()},{field:"start",op:"gte",value:Ct()().startOf("week").toDate()}]},{_id:3,name:"last week",filters:[{field:"start",op:"lte",value:Ct()().subtract(1,"weeks").endOf("week").toDate()},{field:"start",op:"gte",value:Ct()().subtract(1,"weeks").startOf("week").toDate()}]},{_id:4,name:"this month",filters:[{field:"start",op:"lte",value:Ct()().endOf("month").toDate()},{field:"start",op:"gte",value:Ct()().startOf("month").toDate()}]},{_id:5,name:"last month",filters:[{field:"start",op:"lte",value:Ct()().subtract(1,"month").endOf("month").toDate()},{field:"start",op:"gte",value:Ct()().subtract(1,"month").startOf("month").toDate()}]}]}],dn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChangeClient=function(e,t){a.setState({clientId:t})},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getEvents(t,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.onEdit=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({x:t,isOpen:!0});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a.state={x:null,isOpen:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.deleteEvent;return o.a.createElement("div",null,o.a.createElement(Mt,{rows:on,data:"events",onChange:this.handleChange,sortable:!1,onDelete:e,title:"Events",onEdit:this.onEdit,store:this.props.store,filters:pn,isDisabled:this.isDisabled,headers:un}),o.a.createElement(qt,{title:"Edit event",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(ln,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),hn=x(Fe,C)(dn);var fn=x(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),C)(function(e){return o.a.createElement(ce.a,{container:!0,spacing:16},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(oe.a,{className:e.classes.paper},o.a.createElement(ln,null))),o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(hn,null)))}),mn=a(322),vn=a(112),bn=a(323),gn=a(324),wn=(a(724),a(725),a(726),a(727),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).calendarComponentRef=o.a.createRef(),a.state={defaultView:"dayGridMonth",defaultDate:new Date},a.eventDataTransform=function(e){return e.id=e._id,e.title=e[a.props.textField],e.color=a.props.getColor(e),e},a.handleDateClick=function(e){a.props.onSelect(null,e.date)},a.handleEventClick=function(e){var t=a.props.data.data.find(function(t){return t._id===e.event.id});a.props.onSelect(t,e.date)},a.handleViewDisplay=function(e){var t=[{field:"start",op:"gte",value:e.view.activeStart},{field:"end",op:"lte",value:e.view.activeEnd}];a.props.onChange(t,{limit:200,skip:0},null),a.setState({defaultView:e.view.type,defaultDate:e.view.activeStart})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.defaultDate,a=e.defaultView;return o.a.createElement("div",{className:"Calendar"},o.a.createElement(mn.a,{defaultView:a,defaultDate:t,header:{left:"today, prev, next, title",right:"dayGridMonth, timeGridWeek"},plugins:[vn.d,bn.a,gn.a],ref:this.calendarComponentRef,weekends:!0,events:this.props.data.data,dateClick:this.handleDateClick,eventClick:this.handleEventClick,eventDataTransform:this.eventDataTransform,datesRender:this.handleViewDisplay,eventColor:this.props.theme.palette.primary.main}))}}]),t}(o.a.Component)),On=Object(te.withTheme)()(wn),En=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).getColor=function(e){var t=a.props.theme;switch(e.eventTypeId){case 1:return t.palette.primary.main;case 2:default:return t.palette.secondary.main}},a.handleSelect=function(e,t){a.setState({x:e,isOpen:!0,date:t})},a.handleClose=function(){a.setState({isOpen:!1})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getEvents(t,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.state={x:null,isOpen:!1,date:null},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.events,t=this.props.user.user,a=this.state.x&&this.state.x.userId!==t._id;return o.a.createElement(ce.a,{container:!0,spacing:16},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(oe.a,{className:this.props.classes.paper},o.a.createElement(On,{onSelect:this.handleSelect,onChange:this.handleChange,textField:"name",data:e,getColor:this.getColor}),o.a.createElement(qt,{title:"Event",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(ln,{data:this.state.x,onSubmit:this.handleClose,date:this.state.date,disabled:a})))))}}]),t}(o.a.Component),kn=x(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),C,Fe,Object(te.withTheme)())(En),xn=a(86),yn=a(325),Cn=a.n(yn),jn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).state={delay:500,legacy:!0},a.handleScan=a.handleScan.bind(Object(xn.a)(Object(xn.a)(a))),a.openImageDialog=a.openImageDialog.bind(Object(xn.a)(Object(xn.a)(a))),a.myRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"handleScan",value:function(e){if(e){var t=e.split(".");if(2===t.length)try{this.props.user.verify(t[0],t[1])}catch(a){this.props.user.showError(a)}}}},{key:"handleError",value:function(e){console.error(e)}},{key:"openImageDialog",value:function(){var e=this;this.setState({legacy:!0},function(){e.myRef.current.openImageDialog()})}},{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{className:e.row},o.a.createElement("div",{className:e.col},o.a.createElement("div",{className:e.center},o.a.createElement(Cn.a,{ref:this.myRef,delay:this.state.delay,style:{height:320,width:320},onError:this.handleError,onScan:this.handleScan,legacyMode:this.state.legacy}),o.a.createElement(_e.a,{variant:"contained",color:"primary",className:e.submit,onClick:this.openImageDialog},"Scan"))),o.a.createElement("div",{className:e.col},o.a.createElement(oe.a,{className:e.paper},o.a.createElement(K.a,{variant:"h6"},"Data"),this.props.user.signature&&o.a.createElement("div",null,o.a.createElement(K.a,{variant:"body1"},this.props.user.signature.data)))))}}]),t}(l.Component),Sn=x(Object(te.withStyles)(function(e){return Object(Da.a)({},Na(e))}),Fe,C)(jn),Dn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleSubmit=function(){try{a.props.user.sign(a.state.data)}catch(e){a.props.user.showError(e)}},a.handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.state={data:""},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{className:e.row},o.a.createElement("div",{className:e.col},o.a.createElement(oe.a,{className:e.paper},o.a.createElement(Ie,{onSubmit:this.handleSubmit},o.a.createElement("div",{className:e.flex},o.a.createElement(Ee,{label:"Data",value:this.state.data,field:"data",onChange:this.handleChange,required:!0,multiline:!0,fullWidth:!0,rows:8}))))),o.a.createElement("div",{className:e.col},o.a.createElement("div",{className:e.center},this.props.user.signature&&o.a.createElement("img",{src:"data:image/jpeg;base64,"+this.props.user.signature.qrCode,alt:"signature",width:320,height:320}))))}}]),t}(l.Component),_n=x(Object(te.withStyles)(function(e){return Object(Da.a)({},Na(e))}),Fe,C)(Dn),Tn=a(327),In=a.n(Tn);var Nn=Object(te.withStyles)(function(e){return{}})(function(e){var t=e.color,a=e.onClick,n=e.tooltip,r=e.disabled,s=e.className;return o.a.createElement(Qe.a,{title:n},o.a.createElement(g.a,{color:t,onClick:a,"aria-label":n,disabled:r,className:s},e.children))}),Fn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).onChange=function(e){e.preventDefault();var t=e.target.files[0];a.props.onChange(a.props.field,t)},a.onClick=function(){a.props.disabled||a.inputRef.current.click()},a.inputRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.value,n=e.disabled,r=e.mimeType;return o.a.createElement("div",null,o.a.createElement(Nn,{className:t.button,tooltip:"Attach file",color:a?"primary":"default",onClick:this.onClick,disabled:n},o.a.createElement(In.a,null)),o.a.createElement("input",{ref:this.inputRef,style:{display:"none"},type:"file",accept:r,onChange:this.onChange}))}}]),t}(o.a.Component),Pn=Object(te.withStyles)(function(e){return Object(Da.a)({},Na(e),{button:{marginTop:e.spacing.unit,marginBottom:e.spacing.unit}})})(Fn),Rn={name:"",likes:[],likesCnt:0,typesId:[],unavailable:!1,_img:null},Ln=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||Rn,a.handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addTag,r=t.getTags,s=t.editTag,i=t.tags,c=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,c);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,c);case 10:r(i.filters),a.setState(Rn),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.name,n=t.typesId,r=t.unavailable,s=t._img,i=this.props.store.tagTypes;return o.a.createElement(Ie,{onSubmit:this.handleSubmit,inline:!0},o.a.createElement(Ee,{label:"Name",value:a,field:"name",onChange:this.handleChange,required:!0}),o.a.createElement("div",{className:e.collaborators},o.a.createElement(Se,{label:"Types",value:n,field:"typesId",onChange:this.handleChange,data:i.data,textField:"name",fullWidth:!0,multiple:!0})),o.a.createElement(Pn,{mimeType:"image/jpeg",value:s,field:"_img",onChange:this.handleChange,disabled:void 0!==this.state._id}),o.a.createElement(Wa,{label:"",value:r,field:"unavailable",onChange:this.handleChange}))}}]),t}(o.a.Component),An=x(Object(te.withStyles)(function(e){return{collaborators:{display:"flex",flex:1}}}),Fe,C)(Ln),Mn=a(335),Wn=a.n(Mn),qn=a(336),Un=a.n(qn),Vn=a(329),zn=a.n(Vn),Bn=a(330),Hn=a.n(Bn),Gn=a(331),Yn=a.n(Gn),Kn=a(202),Zn=a.n(Kn),Jn=a(332),Xn=a.n(Jn),$n=a(334),Qn=a.n($n),er=a(193),tr=a.n(er),ar=a(333),nr=a.n(ar),rr=a(328),sr=a.n(rr),ir=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={imgViz:!1,img:null},a.state={expanded:!1},a.handleExpandClick=function(){a.setState(function(e){return{expanded:!e.expanded}})},a.onViz=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onViz();case 2:n=e.sent,a.setState({imgViz:!0}),n&&((r=new FileReader).onloadend=function(){a.setState({img:r.result})},r.readAsDataURL(n));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.actions,n=e.children,r=e.cardActions,s=e.primary,i=e.secondary,c=e.avatar,l=e.defaultAvatar,u=e.tooltip,p=e.content;return o.a.createElement(sr.a,{partialVisibility:!0,onChange:this.onViz},o.a.createElement(zn.a,{className:t.card},o.a.createElement(Hn.a,{avatar:o.a.createElement(Ia,{className:t.bigAvatar,defaultValue:l,value:c,tooltip:u}),action:a,title:s,subheader:i}),o.a.createElement(Yn.a,{className:t.media,image:this.state.img||"https://next.material-ui.com/static/images/cards/paella.jpg",title:"media",style:{opacity:this.state.imgViz?1:.25,transition:"opacity 500ms linear"}}),o.a.createElement(Zn.a,null,p),o.a.createElement(Xn.a,{className:t.actions,disableActionSpacing:!0},r,n&&o.a.createElement(g.a,{className:at()(t.expand,Object(j.a)({},t.expandOpen,this.state.expanded)),onClick:this.handleExpandClick,"aria-expanded":this.state.expanded,"aria-label":"Show more"},o.a.createElement(nr.a,null))),o.a.createElement(Qn.a,{in:this.state.expanded,timeout:"auto",unmountOnExit:!0},o.a.createElement(Zn.a,null,n))))}}]),t}(o.a.Component),cr=Object(te.withStyles)(function(e){return{card:{margin:e.spacing.unit,width:"100%",maxWidth:480},media:{height:0,paddingTop:"56.25%"},actions:{display:"flex"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:tr.a[500]}}})(ir),lr=Object(te.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(pt.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 auto"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}})(function(e){var t=e.classes,a=e.onFilter,n=e.title,r=e.isFilterSet,s=e.actions,i=e.onRefresh;return o.a.createElement(G.a,{className:t.root},o.a.createElement("div",{className:t.title},o.a.createElement(K.a,{variant:"h6",id:"tableTitle"},n)),o.a.createElement("div",{className:t.spacer}),o.a.createElement("div",{className:t.actions},s,o.a.createElement(Qe.a,{title:"Filter list"},o.a.createElement(g.a,{"aria-label":"Filter list",color:r?"primary":"default",onClick:a},o.a.createElement(lt.a,null))),o.a.createElement(Qe.a,{title:"Refresh list"},o.a.createElement(g.a,{"aria-label":"Refresh list",onClick:i},o.a.createElement(ut.a,null)))))}),or=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleOpenFilter=function(){a.setState({isOpenFilter:!0})},a.handleCloseFilter=function(){a.setState({isOpenFilter:!1})},a.onDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,r=n.onDelete,s=n.onChange,e.next=3,r(t);case 3:s(a.state.filters);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleConfirmFilter=function(e){var t=jt(a.props.rows,a.props.filters,e);a.props.onChange(t),a.setState({filters:t,isOpenFilter:!1})},a.handleRefresh=function(){a.props.onChange(a.state.filters)},a.state={isOpenFilter:!1,filters:jt(e.rows,e.filters,e.defaultFilters)},a.exportRef=o.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.onChange(this.state.filters)}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.primaryTextField,r=t.secondaryTextField,s=t.onEdit,i=t.isDisabled,c=t.classes,l=t.onLike,u=t.isLiked,p=t.avatarField,d=t.defaultAvatarField,h=t.tooltipField,f=t.onMsg,m=t.cntField,v=t.theme,b=t.onViz;return o.a.createElement(oe.a,{className:c.listWrapper},o.a.createElement(lr,{onFilter:this.handleOpenFilter,isFilterSet:this.state.filters.length>0,actions:this.props.actions,title:this.props.title,onRefresh:this.handleRefresh}),o.a.createElement(Ft,{isLoading:a.isLoading}),o.a.createElement("div",{className:c.list},a.data.map(function(t){return o.a.createElement(cr,{content:e.props.getContent(t),primary:Lt.a.get(t,n),secondary:Lt.a.get(t,r),avatar:Lt.a.get(t,p),defaultAvatar:Lt.a.get(t,d),tooltip:Lt.a.get(t,h),onLike:function(){return l(t)},onViz:function(){return b(t)},actions:o.a.createElement(Tt,{disabled:i(t),onEdit:function(){return s(t)},onDelete:function(){return e.onDelete(t)}}),cardActions:o.a.createElement(o.a.Fragment,null,o.a.createElement(Qe.a,{title:"Like"},o.a.createElement(_e.a,{onClick:function(){return l(t._id)},style:{color:u(t)?v.palette.primary.main:"rgba(0, 0, 0, 0.54)"}},o.a.createElement(Wn.a,null),Lt.a.get(t,m))),o.a.createElement(Nn,{tooltip:"Send message",onClick:function(){return f(t)}},o.a.createElement(Un.a,null)))})})),o.a.createElement(St,{isOpen:this.state.isOpenFilter,onClose:this.handleCloseFilter,onConfirm:this.handleConfirmFilter,store:this.props.store,rows:this.props.rows,filters:this.props.filters,defaultState:this.props.defaultFilters}))}}]),t}(o.a.Component),ur=Object(te.withTheme)()(Object(te.withStyles)(function(e){return{listWrapper:{position:"relative"},list:{display:"flex",flexWrap:"wrap"}}})(or)),pr=[{field:"user.name",label:"Tag",type:"enum",data:"tagTypes",idField:"typesId"}],dr=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getTags(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),a.props.user.showError(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),a.handleEdit=function(e){a.setState({x:e,isOpen:!0})},a.handleDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.deleteTag,e.prev=1,e.next=4,n(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a.handleLike=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.likeTag,r=a.props.user.user,e.prev=2,e.next=5,n(t,r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),a.props.user.showError(e.t0);case 10:case"end":return e.stop()}},e,null,[[2,7]])}));return function(t){return e.apply(this,arguments)}}(),a.handleMsg=function(e){var t=a.props.user.user;window.open("mailto:".concat(e._user.email,"?subject=APP: ").concat(e.name,"&body=%0D%0A").concat(t.name),"_self")},a.isLiked=function(e){return e.likes.includes(a.props.user.user._id)},a.getContent=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(K.a,{variant:"subtitle1",color:"textPrimary"},e.name),o.a.createElement(K.a,{variant:"body2",color:"textSecondary",component:"p"},e._tagTypesStr||"\u017eiadne"))},a.getFilters=function(){return[{label:"Likes",field:"likes",data:[{_id:1,name:"Me",filters:[{field:"likes",value:a.props.user.user._id}]}]}]},a.handleViz=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.imgId){e.next=6;break}return e.next=3,a.props.store.getFile(t.imgId);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=null;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.tags;return o.a.createElement("div",{className:e.list},o.a.createElement(ur,{data:t,getContent:this.getContent,primaryTextField:"_user.name",secondaryTextField:"_dateStr",avatarField:"_user.avatar",tooltipField:"_user.name",cntField:"likesCnt",onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled,onLike:this.handleLike,isLiked:this.isLiked,filters:this.getFilters(),onViz:this.handleViz,rows:pr,store:this.props.store,title:"Tags",onMsg:this.handleMsg}),o.a.createElement(qt,{title:"Edit tag",onClose:this.handleClose,isOpen:this.state.isOpen},o.a.createElement(An,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(o.a.Component),hr=x(Object(te.withStyles)(function(e){return{list:{marginTop:e.spacing.unit}}}),Fe,C,f.f)(dr);var fr,mr,vr,br,gr,wr,Or,Er,kr=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return o.a.createElement(ce.a,{container:!0,spacing:24},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(oe.a,{className:e.classes.paper},o.a.createElement(An,null)),o.a.createElement(hr,null)))}),xr=a(337),yr=a.n(xr),Cr=[{_id:1,name:"total distance"},{_id:2,name:"total elevation"},{_id:3,name:"total time"},{_id:8,name:"total kudos"},{_id:4,name:"max distance"},{_id:5,name:"max elevation"},{_id:6,name:"max time"},{_id:9,name:"max kudos"},{_id:7,name:"count"}],jr=[{_id:8,name:"#tatranskakoza (12.11. - 12.12.)"},{_id:1,name:"this week"},{_id:2,name:"last week"},{_id:3,name:"this month"},{_id:4,name:"last month"},{_id:5,name:"this year"},{_id:6,name:"my months"},{_id:7,name:"my years"}],Sr=[{_id:0,name:"all"},{_id:1,name:"ride"},{_id:2,name:"run"},{_id:3,name:"walk"},{_id:4,name:"hike"}],Dr=function(e){switch(e){case 6:return"month";case 7:return"year";default:return"userId"}},_r=function(e){switch(e){case 1:case 2:case 3:case 8:return"sum";case 4:case 5:case 6:case 9:return"max";case 7:default:return"count"}},Tr=function(e){switch(e){case 1:case 4:return"dis";case 2:case 5:return"total_elevation_gain";case 3:case 6:return"moving_time";case 8:case 9:return"kudos_count";default:return"_id"}},Ir=function(e,t){return{field:Dr(e),op:_r(t),opField:Tr(t)}},Nr=function(e){switch(e){case 1:return[{field:"type",value:"Ride"}];case 2:return[{field:"type",value:"Run"}];case 3:return[{field:"type",value:"Walk"}];case 4:return[{field:"type",value:"Hike"}];case 0:default:return[]}},Fr=function(e,t){switch(e){case 1:return[{field:"start_date",op:"lte",value:Ct()().endOf("week").toDate()},{field:"start_date",op:"gte",value:Ct()().startOf("week").toDate()}];case 2:return[{field:"start_date",op:"lte",value:Ct()().subtract(1,"weeks").endOf("week").toDate()},{field:"start_date",op:"gte",value:Ct()().subtract(1,"weeks").startOf("week").toDate()}];case 3:return[{field:"start_date",op:"lte",value:Ct()().endOf("month").toDate()},{field:"start_date",op:"gte",value:Ct()().startOf("month").toDate()}];case 4:return[{field:"start_date",op:"lte",value:Ct()().subtract(1,"month").endOf("month").toDate()},{field:"start_date",op:"gte",value:Ct()().subtract(1,"month").startOf("month").toDate()}];case 5:return[{field:"start_date",op:"lte",value:Ct()().endOf("year").toDate()},{field:"start_date",op:"gte",value:Ct()().startOf("year").toDate()}];case 6:case 7:return[{field:"userId",value:t._id}];case 8:return[{field:"start_date",op:"lte",value:new Date(2020,11,12,23,59,0,0)},{field:"start_date",op:"gte",value:new Date(2020,10,12,0,0,0,0)}];default:return[]}},Pr=function(e){var t=Lt.a.get(e,"_user.name");return o.a.createElement(yr.a,{color:"inherit",href:"https://www.strava.com/athletes/".concat(e._user.strava.oAuthId),target:"_blank",rel:"noopener noreferrer"},t)},Rr=function(e){switch(e){case 6:return{field:"_id",label:"Months",filterable:!1,disablePadding:!0};case 7:return{field:"_id",label:"Years",filterable:!1,disablePadding:!0};default:return{field:"_user.name",label:"User",filterable:!1,sortable:!1,disablePadding:!0,cell:Pr}}},Lr=function(e){switch(e){case 1:case 4:return{field:"val",label:"Distance *",filterable:!1};case 2:case 5:return{field:"val",label:"Elevation",filterable:!1};case 3:case 6:return{field:"val",label:"Time",filterable:!1};case 7:return{field:"val",label:"Count",filterable:!1};case 8:case 9:return{field:"val",label:"Kudos",filterable:!1};default:return{field:"val",label:"Value",filterable:!1}}},Ar=function(e,t){return[Rr(e),Lr(t)]},Mr=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e,t,n){gr=e,mr=n,vr=t,a.getList()},a.getList=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=[].concat(Object(Ae.a)(fr),Object(Ae.a)(gr),Object(Ae.a)(wr),Object(Ae.a)(Er)),e.next=4,a.props.store.getActivities(br,t,vr,mr);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),a.props.user.showError(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])})),a.isDisabled=function(e){return!0},a.handleChangeType=function(e,t){a.setState(Object(j.a)({},e,t)),wr=Nr(t),a.getList()},a.handleChangeOp=function(e,t){a.setState(Object(j.a)({},e,t)),br=Ir(a.state.groupId,t),a.getList()},a.handleChangeGroup=function(e,t){var n=a.props.user.user;a.setState(Object(j.a)({},e,t)),fr=Fr(t,n),br=Ir(t,a.state.opId),a.getList()},a.handleChangeSearch=function(e,t){a.setState(Object(j.a)({},e,t)),clearTimeout(Or),Or=setTimeout(function(){Er=t?[{field:"name",op:"regex",value:t}]:[],a.getList()},500)};return a.state={opId:1,groupId:8,typeId:0,search:""},fr=Fr(8,e.user.user),br=Ir(8,1),wr=[],Er=[],a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e,t=this.state,a=t.opId,n=t.groupId,r=t.typeId,s=this.props.classes;return o.a.createElement("div",null,o.a.createElement(oe.a,{className:at()(s.paper,s.row)},o.a.createElement(Se,{label:"Type",value:r,field:"typeId",onChange:this.handleChangeType,data:Sr,textField:"name",required:!0}),o.a.createElement(Se,{label:"Stats",value:a,field:"opId",onChange:this.handleChangeOp,data:Cr,textField:"name",required:!0}),o.a.createElement(Se,{label:"Group",value:n,field:"groupId",onChange:this.handleChangeGroup,data:jr,textField:"name",required:!0}),o.a.createElement("div",{className:s.grow}),this.props.user.user.strava&&o.a.createElement("span",{className:s.sync},o.a.createElement(sa,{title:"sync"}))),o.a.createElement(Mt,{rows:Ar(this.state.groupId,this.state.opId),data:"activities",onChange:this.handleChange,title:"Activities",store:this.props.store,filters:(e=this.props.store.getUsersInClub,[{label:"Club",field:"club",data:[{_id:1,name:"VYPADNI VON",filters:[{field:"userId",op:"in",value:function(){return e(562456)}}]},{_id:2,name:"TATRANSK\xc9 KOZY",filters:[{field:"userId",op:"in",value:function(){return e(771781)}}]}]},{label:"Sex",field:"sex",data:[{_id:1,name:"Male",filters:[{field:"sex",op:"eq",value:"M"}]},{_id:2,name:"Female",filters:[{field:"sex",op:"eq",value:"F"}]}]}]),defaultSort:{field:"val",dir:"desc"},isDisabled:this.isDisabled}),o.a.createElement(K.a,{variant:"body1",className:this.props.classes.footer},"* bike distance calc as distance * 0.33"))}}]),t}(o.a.Component),Wr=x(Fe,C,Object(te.withStyles)(function(e){return Object(Da.a)({},Na(e),{paper:{marginBottom:e.spacing.unit},footer:{marginTop:e.spacing.unit},sync:{padding:e.spacing.unit}})}))(Mr);var qr=x(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),C)(function(e){return o.a.createElement(ce.a,{container:!0,spacing:16},o.a.createElement(ce.a,{item:!0,xs:12},o.a.createElement(Wr,null)))}),Ur=[{name:"records",path:"/records",component:Gt,label:"Records",exact:!0,permission:za.tasks},{name:"clients",path:"/clients",component:sn,label:"Clients",exact:!0,permission:za.report},{name:"projects",path:"/projects",component:ba,label:"Projects",exact:!0,permission:za.tasks},{name:"reports",path:"/reports",component:Xa,label:"Reports",exact:!0,permission:za.tasks},{name:"events",path:"/events",component:fn,label:"Events",exact:!0,permission:za.tasks},{name:"calendar",path:"/calendar",component:kn,label:"Calendar",exact:!0,permission:za.events},{name:"sign",path:"/sign",component:_n,label:"Sign data",exact:!0,permission:za.report},{name:"verify",path:"/verify",component:Sn,label:"Verify data",exact:!0,permission:za.report},{name:"project",path:"/projects/:id",component:Sa,label:"Project",permission:za.tasks},{name:"login",path:"/login",component:ca,label:"Login",anonymous:!0,exact:!0,hidden:!0},{name:"oauth",path:"/",component:Qa,label:"Auth",anonymous:!0,exact:!0,hidden:!0},{name:"tags",path:"/tags",component:kr,label:"Tags",exact:!0,permission:za.tags},{name:"activities",path:"/activities",component:qr,label:"Activities",exact:!0,permission:za.activities},{name:"account",path:"/account",component:Ba,label:"Account",exact:!0}],Vr="/",zr=function(e){function t(e){var a;Object(n.a)(this,t),a=Object(s.a)(this,Object(i.a)(t).call(this,e));var r=new URL("https://kristianduda.sk/app");return Vr=r.pathname,a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.classes;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.a,{basename:Vr},o.a.createElement(se,{user:t,routes:Ur},Ur.map(function(e){return e.anonymous?o.a.createElement(f.b,{key:e.name,path:e.path,exact:e.exact,component:e.component}):o.a.createElement(Br,{exact:e.exact,key:e.name,path:e.path,component:e.component,user:t,permission:e.permission})}))),o.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t.msg,autoHideDuration:6e3,onClose:t.hideMsg,ContentProps:{"aria-describedby":"message-id"},message:o.a.createElement("span",{id:"message-id"},t.msg),action:[o.a.createElement(g.a,{key:"close","aria-label":"Close",color:"inherit",className:a.close,onClick:t.hideMsg},o.a.createElement(O.a,null))]}))}}]),t}(o.a.Component);function Br(e){var t=e.component,a=e.user,n=e.permission,r=Object(d.a)(e,["component","user","permission"]);return o.a.createElement(f.b,Object.assign({},r,{render:function(e){return a.user?n&&!a.hasPermission(n)?o.a.createElement(f.a,{to:{pathname:Xt.home,state:{from:e.location}}}):o.a.createElement(t,e):o.a.createElement(f.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var Hr=x(k()(function(e){return{close:{padding:e.spacing.unit/2}}}),C)(zr);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Gr,Yr=a(17),Kr=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r=arguments;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>2&&void 0!==r[2]?r[2]:"",e.prev=1,e.next=4,Yr.auth.auth(t,a,n);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),e.t0;case 10:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t,a){return e.apply(this,arguments)}}(),Zr=function(e){return"".concat("https://kristianduda.sk/app","?provider=").concat(e)},Jr=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.oAuth(t,a,Zr(t),Xt.configId);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),Xr=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.reset(t,"https://kristianduda.sk/app");case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),$r=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.updateOauth(t,a,Zr(t));case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),Qr=function(){var e=Object(de.a)(pe.a.mark(function e(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.generateSecret();case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),es=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.sign(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),ts=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.verify(t,a);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),as=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.getUsers(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),ns=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.getUserCached(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),rs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.getUser(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),ss=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.auth.updateUser(t,a);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),is=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={user:Yr.storage.getUser(),msg:null,users:{total:0,data:[]},secret:null,signature:null},a.showMsg=function(e){a.setState({msg:e})},a.showError=function(e){a.setState({msg:e.message})},a.hideMsg=function(){a.setState({msg:null})},a.auth=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r){var s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Kr(t,n,r);case 3:return s=e.sent,a.setState({user:s}),e.abrupt("return",s);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.generateSecret=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qr();case 3:t=e.sent,a.setState({secret:t}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])})),a.sign=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,es(btoa(t));case 3:n=e.sent,a.setState({signature:n}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.verify=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ts(t,n);case 3:r=e.sent,a.setState({signature:{data:r?atob(t):"NOT VALID",signature:n}}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),a.oAuth=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Jr(t,n);case 3:return r=e.sent,a.setState({user:r}),e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),a.updateOauth=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$r(t,n);case 3:r=e.sent,a.setState({user:r}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),a.updateUser=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ss(t,n);case 3:return r=e.sent,a.setState({user:r}),e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),a.reset=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xr(t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),a.getUsers=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,as(t);case 3:n=e.sent,a.setState({users:n}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.hasPermission=function(e){return a.state.user&&(a.state.user.permissions&e)>0},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.children;return o.a.createElement(y.Provider,{value:Object(Da.a)({auth:this.auth,hideMsg:this.hideMsg,showMsg:this.showMsg,showError:this.showError,generateSecret:this.generateSecret,oAuth:this.oAuth,updateOauth:this.updateOauth,getUsers:this.getUsers,getUser:rs,updateUser:this.updateUser,hasPermission:this.hasPermission,reset:this.reset,sign:this.sign,verify:this.verify},this.state)},e)}}]),t}(o.a.Component),cs=a(203),ls=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.date.setHours(0,0,0,0),e.next=5,Yr.store.post("timeRecords",t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),os=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.start.setHours(0,0,0,0),t.end.setHours(23,59,0,0),e.next=6,Yr.store.post("events",t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),us=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.collaborators=[].concat(Object(Ae.a)(t.collaborators),[a._id]),e.next=5,Yr.store.post("projects",t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),ps=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,e.next=4,Yr.store.post("clients",t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),ds=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.postFile(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),hs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.getFile(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),fs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.delFile(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),ms=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.date=new Date,e.next=5,Yr.store.getLocation();case 5:if(t.location=e.sent,!t._img){e.next=12;break}return e.next=9,ds(t._img);case 9:n=e.sent,t.imgId=n._id,t._img=null;case 12:return e.next=14,Yr.store.post("tags",t);case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}},e,null,[[0,16]])}));return function(t,a){return e.apply(this,arguments)}}(),vs=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.collaborators=[].concat(Object(Ae.a)(t.collaborators),[a._id]),e.next=4,Yr.store.put("projects",t,t._id);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),bs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.date.setHours(0,0,0,0),e.next=4,Yr.store.put("timeRecords",t,t._id);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),gs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.start.setHours(0,0,0,0),t.end.setHours(23,59,0,0),e.next=5,Yr.store.put("events",t,t._id);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),ws=function(){var e=Object(de.a)(pe.a.mark(function e(){var t,a,n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Yr.storage.getUser(),a={field:"_id",dir:"desc"},n=[{field:"collaborators",op:"eq",value:t._id}],e.next=6,Yr.store.get("projects",n,a);case 6:return(r=e.sent).data.forEach(function(e){e.collaborators=e.collaborators.filter(function(e){return e!==t._id})}),e.abrupt("return",r);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}(),Os=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r,s,i,c,l,o,u,p,d,h,f;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.getLocation();case 3:return(n=e.sent).max=null,r=Ct()().subtract(1,"day").toDate(),s=[].concat(Object(Ae.a)(t),[{field:"location",op:"near",value:n},{field:"date",op:"gt",value:r}]),i={field:"location",dir:"asc"},e.next=10,Yr.store.get("tags",s,i);case 10:(c=e.sent).filters=t,l=!0,o=!1,u=void 0,e.prev=15,p=c.data[Symbol.iterator]();case 17:if(l=(d=p.next()).done){e.next=30;break}return(h=d.value).date=h.date?new Date(h.date):null,h._dateStr=h.date.toLocaleString(),e.next=23,Yr.auth.getUserCached(h.userId);case 23:h._user=e.sent,f="",h.typesId.forEach(function(e,t){0!==t&&(f+=" | ");var n=a.data.find(function(t){return t._id===e});f+=n.name}),h._tagTypesStr=f;case 27:l=!0,e.next=17;break;case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(15),o=!0,u=e.t0;case 36:e.prev=36,e.prev=37,l||null==p.return||p.return();case 39:if(e.prev=39,!o){e.next=42;break}throw u;case 42:return e.finish(39);case 43:return e.finish(36);case 44:return e.abrupt("return",c);case 47:throw e.prev=47,e.t1=e.catch(0),e.t1;case 50:case"end":return e.stop()}},e,null,[[0,47],[15,32,36,44],[37,,39,43]])}));return function(t,a){return e.apply(this,arguments)}}(),Es=function(e,t){switch(e.opField){case"dis":return"".concat(Math.round(t/100)/10," km");case"total_elevation_gain":return"".concat(t," m");case"moving_time":return function(e){var t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return a<10&&(a="0"+a),n<10&&(n="0"+n),"".concat(t,":").concat(a,":").concat(n)}(t);default:return t.toString()}},ks=function(e){return function(e){var t=e.substring(0,4),a=e.substring(4,6),n=e.substring(6,8);return new Date(t,a,n)}(e.toString()).toLocaleString("default",{month:"long",year:"numeric"})},xs=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.get("userClubs",[{field:"clubs",value:t}],{field:"_id",dir:"asc"},{limit:200,skip:0},["_id"]);case 3:return a=e.sent,e.abrupt("return",a.data.map(function(e){return e._id}));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),ys=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n,r){var s,i,c,l,o,u,p,d,h,f,m,v,b;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,s=!0,i=!1,c=void 0,e.prev=4,l=a[Symbol.iterator]();case 6:if(s=(o=l.next()).done){e.next=15;break}if(!((u=o.value).value instanceof Function)){e.next=12;break}return e.next=11,u.value();case 11:u.value=e.sent;case 12:s=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),i=!0,c=e.t0;case 21:e.prev=21,e.prev=22,s||null==l.return||l.return();case 24:if(e.prev=24,!i){e.next=27;break}throw c;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return e.next=31,Yr.store.aggregation("activities",t,a,r,n);case 31:p=e.sent,d=!0,h=!1,f=void 0,e.prev=35,m=p.data[Symbol.iterator]();case 37:if(d=(v=m.next()).done){e.next=50;break}if(b=v.value,"userId"!==t.field){e.next=45;break}return e.next=42,Yr.auth.getUserCached(b._id);case 42:b._user=e.sent,e.next=46;break;case 45:"month"===t.field?b._id=ks(b._id):"year"===t.field&&(b._id=b._id.toString().substring(0,4));case 46:b.val=Es(t,b.val);case 47:d=!0,e.next=37;break;case 50:e.next=56;break;case 52:e.prev=52,e.t1=e.catch(35),h=!0,f=e.t1;case 56:e.prev=56,e.prev=57,d||null==m.return||m.return();case 59:if(e.prev=59,!h){e.next=62;break}throw f;case 62:return e.finish(59);case 63:return e.finish(56);case 64:return e.abrupt("return",p);case 67:throw e.prev=67,e.t2=e.catch(0),e.t2;case 70:case"end":return e.stop()}},e,null,[[0,67],[4,17,21,29],[22,,24,28],[35,52,56,64],[57,,59,63]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),Cs=function(){var e=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.get("clients");case 3:return t=e.sent,e.abrupt("return",t);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),js=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.getById("projects",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Ss=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.getById("clients",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Ds=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a,n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={field:"date",op:"sum",opField:"duration"},e.next=4,Yr.store.aggregation("timeRecords",a,t);case 4:return(n=e.sent).sum=0,n.data.forEach(function(e){e.name=new Date(e._id).toLocaleDateString("en-US"),n.sum+=e.val}),e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),_s=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n){var r,s,i,c,l,o,u,p;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={field:"date",dir:"desc"},e.next=4,Yr.store.get("timeRecords",a,r,n);case 4:s=e.sent,i=!0,c=!1,l=void 0,e.prev=8,o=pe.a.mark(function e(){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=p.value).date=a.date?new Date(a.date):null,a._project=t.find(function(e){return e._id===a.projectId}),!a.taskId){e.next=9;break}return e.next=6,Bs(a.taskId);case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0={name:null};case 10:return a._task=e.t0,e.next=13,Yr.auth.getUserCached(a.userId);case 13:a._user=e.sent;case 14:case"end":return e.stop()}},e)}),u=s.data[Symbol.iterator]();case 11:if(i=(p=u.next()).done){e.next=16;break}return e.delegateYield(o(),"t0",13);case 13:i=!0,e.next=11;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(8),c=!0,l=e.t1;case 22:e.prev=22,e.prev=23,i||null==u.return||u.return();case 25:if(e.prev=25,!c){e.next=28;break}throw l;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",s);case 33:throw e.prev=33,e.t2=e.catch(0),e.t2;case 36:case"end":return e.stop()}},e,null,[[0,33],[8,18,22,30],[23,,25,29]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Ts=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n){var r,s,i,c,l,o,u,p;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={field:"start",dir:"desc"},e.next=4,Yr.store.get("events",a,r,n);case 4:s=e.sent,i=!0,c=!1,l=void 0,e.prev=8,o=pe.a.mark(function e(){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=p.value).start=a.start?new Date(a.start):null,a.end=a.end?new Date(a.end):null,e.next=5,Yr.auth.getUserCached(a.userId);case 5:a._user=e.sent,a._eventType=t.find(function(e){return e._id===a.eventTypeId});case 7:case"end":return e.stop()}},e)}),u=s.data[Symbol.iterator]();case 11:if(i=(p=u.next()).done){e.next=16;break}return e.delegateYield(o(),"t0",13);case 13:i=!0,e.next=11;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(8),c=!0,l=e.t1;case 22:e.prev=22,e.prev=23,i||null==u.return||u.return();case 25:if(e.prev=25,!c){e.next=28;break}throw l;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",s);case 33:throw e.prev=33,e.t2=e.catch(0),e.t2;case 36:case"end":return e.stop()}},e,null,[[0,33],[8,18,22,30],[23,,25,29]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Is=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.delById("timeRecords",t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Ns=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.delById("events",t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Fs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.delById("projects",t);case 3:return e.next=5,Yr.store.del("tasks",[{field:"projectId",value:t}]);case 5:return e.next=7,Yr.store.del("timeRecords",[{field:"projectId",value:t}]);case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),Ps=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.delById("tasks",t);case 3:return e.next=5,Yr.store.del("timeRecords",[{field:"taskId",value:t}]);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Rs=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.projectId=n,e.next=5,Yr.store.post("tasks",t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Ls=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.put("tasks",t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),As=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.put("clients",t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Ms=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.put("tags",t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Ws=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.delById("clients",t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),qs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.delById("tags",t._id);case 3:if(!t.imgId){e.next=6;break}return e.next=6,fs(t.imgId);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),Us=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n,r){var s,i,c,l,o,u,p;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.get("tasks",a,r,n);case 3:s=e.sent,i=!0,c=!1,l=void 0,e.prev=7,o=pe.a.mark(function e(){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=p.value).assignedToId){e.next=7;break}return e.next=4,Yr.auth.getUserCached(a.assignedToId);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=null;case 8:a._assignedTo=e.t0,a._state=t.find(function(e){return e._id===a.stateId});case 10:case"end":return e.stop()}},e)}),u=s.data[Symbol.iterator]();case 10:if(i=(p=u.next()).done){e.next=15;break}return e.delegateYield(o(),"t0",12);case 12:i=!0,e.next=10;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(7),c=!0,l=e.t1;case 21:e.prev=21,e.prev=22,i||null==u.return||u.return();case 24:if(e.prev=24,!c){e.next=27;break}throw l;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return e.abrupt("return",s);case 32:throw e.prev=32,e.t2=e.catch(0),e.t2;case 35:case"end":return e.stop()}},e,null,[[0,32],[7,17,21,29],[22,,24,28]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),Vs=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yr.store.getById("tasks",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),zs={},Bs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,zs[t]){e.next=5;break}return e.next=4,Vs(t);case 4:zs[t]=e.sent;case 5:return e.abrupt("return",zs[t]);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),Hs=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).getProjects=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{projects:Object(Da.a)({},e.projects,{isLoading:!0})}}),e.next=4,ws();case 4:(t=e.sent).isLoading=!1,a.setState({projects:t}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])})),a.getTags=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{tags:Object(Da.a)({},e.tags,{isLoading:!0})}}),e.next=4,Os(t,a.state.tagTypes);case 4:(n=e.sent).isLoading=!1,a.setState({tags:n}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),a.setState(function(e){return{tags:Object(Da.a)({},e.tags,{isLoading:!1})}}),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),a.getActivities=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r,s){var i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{activities:Object(Da.a)({},e.activities,{isLoading:!0})}}),e.next=4,ys(t,n,r,s);case 4:(i=e.sent).isLoading=!1,a.setState({activities:i}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),a.setState(function(e){return{activities:Object(Da.a)({},e.activities,{isLoading:!1})}}),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),a.handleChange=function(e,t){a.setState(Object(j.a)({},e,t))},a.getProject=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s,i,c,l,o,u,p;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,js(t);case 3:n=e.sent,r=[],s=!0,i=!1,c=void 0,e.prev=8,l=n.collaborators[Symbol.iterator]();case 10:if(s=(o=l.next()).done){e.next=19;break}return u=o.value,e.next=14,ns(u);case 14:p=e.sent,r.push(p);case 16:s=!0,e.next=10;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(8),i=!0,c=e.t0;case 25:e.prev=25,e.prev=26,s||null==l.return||l.return();case 28:if(e.prev=28,!i){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(25);case 33:a.setState({project:n,users:{total:r.length,data:r}}),e.next=39;break;case 36:throw e.prev=36,e.t1=e.catch(0),e.t1;case 39:case"end":return e.stop()}},e,null,[[0,36],[8,21,25,33],[26,,28,32]])}));return function(t){return e.apply(this,arguments)}}(),a.getClient=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ss(t);case 3:n=e.sent,a.setState({client:n}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.getClients=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{clients:Object(Da.a)({},e.clients,{isLoading:!0})}}),e.next=4,Cs();case 4:(t=e.sent).isLoading=!1,a.setState({clients:t}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])})),a.refreshTimeRecords=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{timeRecords:Object(Da.a)({},e.timeRecords,{isLoading:!0})}}),t=a.state.timeRecords,n=t.filters,r=t.page,e.next=5,ws();case 5:return s=e.sent,e.next=8,_s(s.data,n,r);case 8:return i=e.sent,e.next=11,Ds(n);case 11:c=e.sent,i.isLoading=!1,a.setState({timeRecords:i,stats:c,projects:s}),e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}},e,null,[[0,16]])})),a.refreshEvents=Object(de.a)(pe.a.mark(function e(){var t,n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{events:Object(Da.a)({},e.events,{isLoading:!0})}}),t=a.state.events,n=t.filters,r=t.page,e.next=5,Ts(a.state.eventTypes.data,n,r);case 5:(s=e.sent).isLoading=!1,a.setState({events:s}),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,10]])})),a.getEvents=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{events:Object(Da.a)({},e.events,{isLoading:!0})}}),e.next=4,as([]);case 4:return r=e.sent,e.next=7,Ts(a.state.eventTypes.data,t,n);case 7:return(s=e.sent).isLoading=!1,a.setState({events:s,users:r}),e.abrupt("return",s);case 13:throw e.prev=13,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}},e,null,[[0,13]])}));return function(t,a){return e.apply(this,arguments)}}(),a.refreshTasks=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{tasks:Object(Da.a)({},e.tasks,{isLoading:!0})}}),t=a.state.tasks,n=t.filters,r=t.page,s=t.sort,i=a.state.states.data,e.next=6,Us(i,n,r,s);case 6:(c=e.sent).isLoading=!1,a.setState({tasks:c}),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}},e,null,[[0,11]])})),a.getTasks=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r,s){var i,c,l;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{tasks:Object(Da.a)({},e.tasks,{isLoading:!0})}}),i=[].concat(Object(Ae.a)(n),[{field:"projectId",op:"eq",value:t}]),c=a.state.states.data,e.next=6,Us(c,i,r,s);case 6:return(l=e.sent).isLoading=!1,a.setState({tasks:l}),e.abrupt("return",l);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),a.getOpenedTasks=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=[{field:"stateId",op:"ne",value:3},{field:"assignedToId",value:n._id}],e.next=4,a.getTasks(t,r,void 0);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.likeTag=function(e,t){a.setState(function(a){return{tags:Object(Da.a)({},a.tags,{data:a.tags.data.map(function(a){if(a._id===e){var n=a.likes.indexOf(t._id);n>-1?(a.likes.splice(n,1),a.likesCnt=a.likesCnt-1):(a.likes.push(t._id),a.likesCnt=a.likesCnt+1),Ms(a)}return a})})}})},a.getTimeRecords=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r,s,i,c,l;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{timeRecords:Object(Da.a)({},e.timeRecords,{isLoading:!0})}}),e.next=4,ws();case 4:return r=e.sent,e.next=7,as([]);case 7:return s=e.sent,i=[].concat(Object(Ae.a)(t),[{field:"projectId",op:"in",value:r.data.map(function(e){return e._id})}]),e.next=11,_s(r.data,i,n);case 11:return c=e.sent,e.next=14,Ds(i);case 14:return l=e.sent,c.isLoading=!1,a.setState({timeRecords:c,stats:l,projects:r,users:s}),e.abrupt("return",c);case 20:throw e.prev=20,e.t0=e.catch(0),e.t0;case 23:case"end":return e.stop()}},e,null,[[0,20]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleChangeCollection=function(e){console.log("CHANGED: "+e)},a.state={timeRecords:{total:0,data:[],filters:[],page:null,isLoading:!1},events:{total:0,data:[],filters:[],page:null,isLoading:!1},projects:{total:0,data:[],filters:[],isLoading:!1},project:null,client:null,stats:[],users:{total:0,data:[]},tasks:{total:0,data:[],isLoading:!1},clients:{total:0,data:[],isLoading:!1},states:{total:3,data:[{_id:1,name:"To do"},{_id:2,name:"Doing"},{_id:3,name:"Done"}]},eventTypes:{total:1,data:[{_id:1,name:"HO"}]},projectId:null,tags:{total:0,data:[],filters:[],isLoading:!1},tagTypes:{total:1,data:[{_id:1,name:"kompot"},{_id:2,name:"polievka"},{_id:3,name:"hlavne jedlo"}]},activities:{total:0,data:[],isLoading:!1}},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.children;return!Gr&&Yr.storage.getUser()&&(Gr=!0,function(e){var t=(new cs.a).withUrl("".concat(Xt.url.store,"/hub"),{accessTokenFactory:function(){return Yr.storage.getUser().refreshToken}}).configureLogging(cs.b.Error).build();t.start().catch(function(e){console.error(e)}),t.on("change",e)}(this.handleChangeCollection)),o.a.createElement(Ne.Provider,{value:Object(Da.a)({addTimeRecord:ls,addEvent:os,getTimeRecords:this.getTimeRecords,getEvents:this.getEvents,refreshEvents:this.refreshEvents,refreshTimeRecords:this.refreshTimeRecords,deleteTimeRecord:Is,deleteEvent:Ns,addProject:us,addClient:ps,addTag:ms,getClients:this.getClients,editClient:As,editTag:Ms,deleteClient:Ws,getProjects:this.getProjects,deleteProject:Fs,deleteTag:qs,addTask:Rs,editTask:Ls,deleteTask:Ps,refreshTasks:this.refreshTasks,editProject:vs,editTimeRecord:bs,editEvent:gs,getTasks:this.getTasks,getProject:this.getProject,getClient:this.getClient,getOpenedTasks:this.getOpenedTasks,handleChange:this.handleChange,getTags:this.getTags,likeTag:this.likeTag,getActivities:this.getActivities,getFile:hs,getUsersInClub:xs},this.state)},e)}}]),t}(o.a.Component),Gs=a(342);Object(Yr.init)(Xt);var Ys={type:"light",primary:{main:"#bd5d38"},secondary:{main:"#343a40"}},Ks=Object(te.createMuiTheme)({palette:Ys}),Zs=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.documentElement.style.setProperty("--primary-color",Ys.primary.main),document.title="".concat("app"," v").concat("0.2.7")}},{key:"render",value:function(){return o.a.createElement(is,null,o.a.createElement(Hs,null,o.a.createElement(te.MuiThemeProvider,{theme:Ks},o.a.createElement(he.b,{utils:Gs.a},o.a.createElement(Hr,null)))))}}]),t}(o.a.Component);p.a.render(o.a.createElement(Zs,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[372,1,2]]]);
//# sourceMappingURL=main.03f9a92d.chunk.js.map