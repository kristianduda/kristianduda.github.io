(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{30:function(e){e.exports={url:{store:"https://stored.azurewebsites.net",auth:"https://storeauth.azurewebsites.net"},_github:{id:"c426e790821064328634"},_google:{id:"548560778490-kpllp0k9fhf7bdkfvlbjl0p4m88t0ipt.apps.googleusercontent.com"},strava:{id:"39689"},"2fa":!1,home:"/activities",configId:"5c606e8afb6fc06f052da3c9"}},371:function(e,t,a){e.exports=a(745)},376:function(e,t,a){},726:function(e,t,a){},745:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a(12),s=a(14),i=a(13),c=a(15),o=a(0),l=a.n(o),u=a(42),p=a.n(u),d=(a(376),a(342)),h=a(146),f=a(45),m=a(336),v=a.n(m),b=a(37),g=a.n(b),w=a(337),x=a.n(w),k=a(9),O=a.n(k);function E(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}var y=l.a.createContext(),j=function(e){return function(t){return l.a.createElement(y.Consumer,null,function(a){return l.a.createElement(e,Object.assign({},t,{user:a}))})}},C=a(21),S=a(291),D=a.n(S),T=a(101),_=a.n(T),N=a(289),I=a.n(N),P=a(195),F=a.n(P),R=a(194),L=a.n(R),A=a(119),M=a.n(A),q=a(120),W=a.n(q),U=a(100),z=a.n(U),V=a(292),B=a.n(V),J=a(68),G=a.n(J),H=a(29),Y=a.n(H),K=a(293),X=a.n(K),Z=a(69),Q=a.n(Z),$=a(149),ee=a.n($),te=a(7),ae=a(147),ne=a.n(ae),re=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleMenu=function(e){a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleClickAccount=function(){a.props.history.push("/account"),a.handleClose()},a.handleDrawerToggle=function(){a.setState(function(e){return{mobileOpen:!e.mobileOpen}})},a.redirect=function(e){Object(ae.isWidthDown)("md",a.props.width)&&a.handleDrawerToggle(),a.props.history.push(e.path)},a.state={mobileOpen:!1,anchorEl:null},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.theme,r=t.routes,s=t.user,i=this.state.anchorEl,c=Boolean(i),o=this.props.history.location.pathname,u=r.find(function(e){return e.path===o}),p=l.a.createElement("div",null,l.a.createElement("div",{className:a.toolbar}),l.a.createElement(I.a,null),l.a.createElement(M.a,null,r.map(function(t){return!t.exact||t.hidden||t.permission&&!s.hasPermission(t.permission)?null:l.a.createElement(W.a,{button:!0,key:t.name,onClick:function(){return e.redirect(t)}},l.a.createElement(z.a,{primary:t.label}))})));return u&&u.anonymous?l.a.createElement("div",{className:a.root},this.props.children):l.a.createElement("div",{className:a.root},l.a.createElement(_.a,null),l.a.createElement(D.a,{position:"fixed",className:a.appBar},l.a.createElement(G.a,null,l.a.createElement(g.a,{color:"inherit","aria-label":"Open drawer",onClick:this.handleDrawerToggle,className:a.menuButton},l.a.createElement(B.a,null)),l.a.createElement(Y.a,{variant:"h6",color:"inherit",noWrap:!0,className:a.grow},u?u.label:"App"),l.a.createElement("div",null,l.a.createElement("span",null,s.user?s.user.name:null),l.a.createElement(g.a,{"aria-owns":c?"menu-appbar":void 0,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},l.a.createElement(X.a,null)),l.a.createElement(ee.a,{id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:c,onClose:this.handleClose},l.a.createElement(Q.a,{onClick:this.handleClickAccount},"My account"))))),l.a.createElement("nav",{className:a.drawer},l.a.createElement(L.a,{lgUp:!0,implementation:"css"},l.a.createElement(F.a,{variant:"temporary",anchor:"rtl"===n.direction?"right":"left",open:this.state.mobileOpen,onClose:this.handleDrawerToggle,classes:{paper:a.drawerPaper}},p)),l.a.createElement(L.a,{mdDown:!0,implementation:"css"},l.a.createElement(F.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0},p))),l.a.createElement("main",{className:a.content},l.a.createElement("div",{className:a.toolbar}),this.props.children))}}]),t}(l.a.Component),se=E(ne()(),Object(te.withStyles)(function(e){return{root:{display:"flex"},grow:{flexGrow:1},drawer:Object(C.a)({},e.breakpoints.up("lg"),{width:240,flexShrink:0}),appBar:Object(C.a)({marginLeft:240},e.breakpoints.up("lg"),{width:"calc(100% - ".concat(240,"px)")}),menuButton:Object(C.a)({marginRight:20},e.breakpoints.up("lg"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:240},content:{flexGrow:1,padding:2*e.spacing.unit,overflow:"auto"}}},{withTheme:!0}),f.f)(re),ie=a(33),ce=a.n(ie),oe=a(23),le=a.n(oe),ue=a(3),pe=a.n(ue),de=a(5),he=a(155);var fe=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:160}}})(function(e){var t=e.classes;return l.a.createElement(he.a,{className:t.formControl,keyboard:!0,label:e.label,format:"MM/DD/YYYY",clearable:!e.required,mask:function(e){return e?[/\d/,/\d/,"/",/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/]:[]},value:e.value||null,onChange:function(t){return e.onChange(e.field,t?t.toDate():null)},disableOpenOnEnter:!0,animateYearScrolling:!1,style:{flex:1,display:"flex"},disabled:e.disabled})}),me=a(58),ve=a.n(me),be=a(55),ge=a.n(be),we=a(57),xe=a.n(we);var ke=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:120}}})(function(e){var t=e.classes;return l.a.createElement(ve.a,{className:t.formControl,fullWidth:e.fullWidth,required:e.required},l.a.createElement(xe.a,{htmlFor:e.field},e.label),l.a.createElement(ge.a,{type:"new-password"===e.type?"password":e.type,id:e.field,value:e.value||"",onChange:function(t){return e.onChange(e.field,t.target.value)},placeholder:e.placeholder,autoComplete:"new-password"===e.type?"new-password":null,disabled:e.disabled,multiline:e.multiline,rows:e.rows}))});var Oe=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWwidth:80}}})(function(e){var t=e.classes;return l.a.createElement(ve.a,{className:t.formControl,required:e.required,fullWidth:e.fullWidth},l.a.createElement(xe.a,{htmlFor:e.field},e.label),l.a.createElement(ge.a,{id:e.field,value:e.value?e.value.toString():"0",onChange:function(t){return e.onChange(e.field,Number(t.target.value))},type:"number",disabled:e.disabled,inputProps:{min:e.min,max:e.max,step:e.step}}))}),Ee=a(145),ye=a.n(Ee),je=a(102),Ce=a.n(je);var Se=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,minWidth:120}}})(function(e){var t=e.classes,a=e.data,n=e.textField,r=e.required,s=e.value,i=e.onChange,c=e.field,o=e.multiple;r&&null===s&&a&&a.length>0&&i(c,a[0]._id);var u=function(e){var t=a.find(function(t){return t._id===e});return t?t[n]:null};return l.a.createElement(ve.a,{className:t.formControl,required:r,fullWidth:e.fullWidth},e.label&&l.a.createElement(xe.a,{htmlFor:e.field},e.label),l.a.createElement(ye.a,{value:null!==e.value?e.value:"",onChange:function(t){return i(e.field,t.target.value)},id:e.field,multiple:e.multiple,renderValue:function(e){return o?e.map(function(e){return u(e)}).join(" | "):u(e)},disabled:e.disabled},!e.required&&!o&&l.a.createElement(Q.a,{value:""},l.a.createElement("em",null,"None")),a.map(function(e){return l.a.createElement(Q.a,{key:e._id,value:e._id},o&&l.a.createElement(Ce.a,{checked:void 0!==s.find(function(t){return t===e._id})}),l.a.createElement(z.a,{primary:e[n]}))})))}),De=a(35),Te=a.n(De),_e=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=function(e){e.preventDefault(),a.props.onSubmit()},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.inline,n=e.disabled;return l.a.createElement("form",{className:a?t.formInline:t.form,onSubmit:this.handleSubmit},this.props.children,!n&&l.a.createElement(Te.a,{className:t.submitButton,type:"submit",variant:"contained",color:"primary",disabled:n},"Save"))}}]),t}(l.a.Component),Ne=Object(te.withStyles)(function(e){return{formInline:{display:"flex",flexWrap:"wrap",flexDirection:"row"},form:{display:"flex",flexDirection:"column"},submitButton:{margin:e.spacing.unit}}})(_e),Ie=l.a.createContext(),Pe=function(e){return function(t){return l.a.createElement(Ie.Consumer,null,function(a){return l.a.createElement(e,Object.assign({},t,{store:a}))})}},Fe={date:new Date,name:"",duration:0,projectId:null,taskId:null},Re=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||Fe,a.handleChangeProject=function(e,t){var n=a.props.user.user,r=a.props.store,s=r.getOpenedTasks,i=r.handleChange;s(t,n),a.props.data||i(e,t),a.handleChange(e,t)},a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addTimeRecord,r=t.refreshTimeRecords,s=t.editTimeRecord,i=a.props.user.user,a.state.projectId){e.next=4;break}return e.abrupt("return");case 4:if(e.prev=4,!a.state._id){e.next=10;break}return e.next=8,s(a.state,i);case 8:e.next=12;break;case 10:return e.next=12,n(a.state,i);case 12:r(),a.setState(Fe),a.props.onSubmit&&a.props.onSubmit(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),a.props.user.showError(e.t0);case 20:case"end":return e.stop()}},e,null,[[4,17]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.date,n=t.name,r=t.duration,s=t.projectId,i=t.taskId,c=this.props.store,o=c.projects,u=c.tasks;return l.a.createElement(Ne,{onSubmit:this.handleSubmit,inline:!0},l.a.createElement("div",{className:e.nameTextInput},l.a.createElement(ke,{label:"Name",value:n,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0})),l.a.createElement(Se,{label:"Project",value:s,field:"projectId",onChange:this.handleChangeProject,data:o.data,textField:"name",required:!0}),l.a.createElement(Se,{label:"Task",value:i,field:"taskId",onChange:this.handleChange,data:u.data,textField:"name"}),l.a.createElement(fe,{label:"Date",value:a,field:"date",onChange:this.handleChange,required:!0}),l.a.createElement(Oe,{label:"Duration",value:r,field:"duration",onChange:this.handleChange,min:0,step:.25,required:!0}))}}]),t}(l.a.Component),Le=E(Object(te.withStyles)(function(e){return{nameTextInput:{display:"flex",flex:1}}}),Pe,j)(Re),Ae=a(47),Me=a(307),qe=a.n(Me),We=a(308),Ue=a.n(We),ze=a(63),Ve=a.n(ze),Be=a(309),Je=a.n(Be),Ge=a(121),He=a.n(Ge),Ye=a(299),Ke=a.n(Ye),Xe=a(300),Ze=a.n(Xe),Qe=a(46),$e=a.n(Qe),et=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.onSelectAllClick,n=t.sort,r=t.numSelected,s=t.rowCount,i=t.rows,c=t.sortable;return l.a.createElement(Ke.a,null,l.a.createElement(He.a,null,l.a.createElement(Ve.a,{padding:"checkbox"},l.a.createElement(Ce.a,{indeterminate:r>0&&r<s,checked:r===s,onChange:a})),i.map(function(t){return l.a.createElement(Ve.a,{key:t.field,align:"num"===t.type?"right":"left",padding:t.disablePadding?"none":"default",sortDirection:n.field===t.field&&n.dir},!1===c||!1===t.sortable?t.label:l.a.createElement($e.a,{title:"Sort",placement:"num"===t.type?"bottom-end":"bottom-start",enterDelay:300},l.a.createElement(Ze.a,{active:n.field===t.field,direction:n.dir,onClick:e.createSortHandler(t.field)},t.label)))},this),l.a.createElement(Ve.a,{padding:"none"})))}}]),t}(l.a.Component),tt=a(6),at=a.n(tt),nt=a(301),rt=a.n(nt),st=a(302),it=a.n(st),ct=a(151),ot=a.n(ct),lt=a(152),ut=a.n(lt),pt=a(61),dt=Object(te.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(pt.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 auto"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}})(function(e){var t=e.numSelected,a=e.classes,n=e.onDelete,r=e.onFilter,s=e.title,i=e.onExport,c=e.isFilterSet,o=e.actions,u=e.onRefresh,p=e.exportDisabled;return l.a.createElement(G.a,{className:at()(a.root,Object(C.a)({},a.highlight,t>0))},l.a.createElement("div",{className:a.title},t>0?l.a.createElement(Y.a,{color:"inherit",variant:"subtitle1"},t," selected"):l.a.createElement(Y.a,{variant:"h6",id:"tableTitle"},s)),l.a.createElement("div",{className:a.spacer}),l.a.createElement("div",{className:a.actions},o,t>0?l.a.createElement($e.a,{title:"Delete"},l.a.createElement(g.a,{"aria-label":"Delete",onClick:n},l.a.createElement(rt.a,null))):l.a.createElement($e.a,{title:"Filter list"},l.a.createElement(g.a,{"aria-label":"Filter list",color:c?"primary":"default",onClick:r},l.a.createElement(ot.a,null))),l.a.createElement($e.a,{title:"Export"},l.a.createElement(g.a,{"aria-label":"Export",onClick:i,disabled:p},l.a.createElement(it.a,null))),l.a.createElement($e.a,{title:"Refresh list"},l.a.createElement(g.a,{"aria-label":"Refresh list",onClick:u},l.a.createElement(ut.a,null)))))}),ht=a(62),ft=a.n(ht),mt=a(76),vt=a.n(mt),bt=a(150),gt=a.n(bt),wt=a(303),xt=a.n(wt),kt=a(77),Ot=a.n(kt);var Et=function(e){return l.a.createElement(ft.a,{open:e.isOpen,onClose:e.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},l.a.createElement(Ot.a,{id:"alert-dialog-title"},e.title),l.a.createElement(gt.a,null,l.a.createElement(xt.a,{id:"alert-dialog-description"},e.description)),l.a.createElement(vt.a,null,l.a.createElement(Te.a,{onClick:e.onClose,color:"primary"},"Cancel"),l.a.createElement(Te.a,{onClick:e.onConfirm,color:"primary",autoFocus:!0},"OK")))},yt=a(22),jt=a.n(yt),Ct=function(e,t,a){var n,r,s=[];a&&(t.forEach(function(e){r=e.field,(n=a[r])&&s.push.apply(s,Object(Ae.a)(e.data.find(function(e){return e._id===n}).filters))}),e.forEach(function(e){switch(e.type){case"num":r=e.field,(n=a[r])&&s.push({field:r,op:"eq",value:n});break;case"date":r=e.field,(n=a[r])&&(s.push({field:r,op:"lte",value:jt()(n).endOf("day").toDate()}),s.push({field:r,op:"gte",value:jt()(n).startOf("day").toDate()}));break;case"enum":r=e.idField,(n=a[r])&&n.length>0&&s.push({field:r,op:"in",value:n});break;default:r=e.field,(n=a[r])&&s.push({field:r,op:"regex",value:n})}}));return s},St=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleClear=function(){var e={};a.props.filters.forEach(function(t){e[t.field]=null}),a.props.rows.forEach(function(t){var a="enum"===t.type?t.idField:t.field;e[a]=null}),a.props.onConfirm(null),a.setState(e)},a.handleSubmit=function(){a.props.onConfirm(a.state)},a.buildFilter=function(e){if(!1===e.filterable)return null;switch(e.type){case"enum":var t=e.field.split(".").pop();return l.a.createElement(Se,{key:e.label,label:e.label,value:a.state[e.idField]||[],field:e.idField,onChange:a.handleChange,data:a.props.store[e.data].data,textField:t,multiple:!0});case"date":return l.a.createElement(fe,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange});case"num":return l.a.createElement(Oe,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange,min:0});default:return l.a.createElement(ke,{key:e.label,label:e.label,value:a.state[e.field],field:e.field,onChange:a.handleChange})}},a.state=e.defaultState||{},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props;return l.a.createElement(ft.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:t.isOpen,onClose:t.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0},l.a.createElement(Ot.a,{id:"alert-dialog-title"},"Filters"),this.props.filters.map(function(t){return l.a.createElement(Se,{value:e.state[t.field],field:t.field,label:t.label,onChange:e.handleChange,data:t.data,textField:"name"})}),t.rows.map(function(t){return e.buildFilter(t)}),l.a.createElement(vt.a,null,l.a.createElement(Te.a,{onClick:this.handleClear,color:"primary"},"Clear"),l.a.createElement(Te.a,{onClick:this.handleSubmit,color:"primary",autoFocus:!0},"OK")))}}]),t}(l.a.Component),Dt=a(304),Tt=a.n(Dt),_t=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={anchorEl:null,isOpenDelete:!1},a.handleOpenMenu=function(e){a.setState({anchorEl:e.currentTarget})},a.handleCloseMenu=function(){a.setState({anchorEl:null})},a.handleCloseDelete=function(){a.setState({isOpenDelete:!1})},a.handleOpenDelete=function(){a.setState({isOpenDelete:!0,anchorEl:null})},a.onDelete=function(){a.props.onDelete(),a.handleCloseDelete()},a.onEdit=function(){a.props.onEdit(),a.handleCloseMenu()},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.anchorEl,a=e.isOpenDelete;return l.a.createElement("div",null,l.a.createElement(g.a,{"aria-owns":t?"actions-menu":void 0,"aria-haspopup":"true",edge:"end","aria-label":"actions",onClick:this.handleOpenMenu,disabled:this.props.disabled},l.a.createElement(Tt.a,null)),l.a.createElement(ee.a,{id:"actions-menu",anchorEl:t,open:Boolean(t),onClose:this.handleCloseMenu},l.a.createElement(Q.a,{onClick:this.onEdit},"Edit"),l.a.createElement(Q.a,{onClick:this.handleOpenDelete},"Delete")),l.a.createElement(Et,{isOpen:a,onClose:this.handleCloseDelete,onConfirm:this.onDelete,title:"Delete",description:"Are you sure?"}))}}]),t}(l.a.Component),Nt=a(305),It=a.n(Nt);var Pt=Object(te.withStyles)(function(e){return{progress:{backgroundColor:"white",opacity:.8,position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1800,display:"flex",justifyContent:"center",alignItems:"center"}}})(function(e){var t=e.classes;return e.isLoading?l.a.createElement("div",{className:t.progress},l.a.createElement(It.a,null)):null}),Ft=a(306),Rt=a(52),Lt=a.n(Rt),At=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleRequestSort=function(e,t){var n=t,r="desc";a.state.sort.field===t&&"desc"===a.state.sort.dir&&(r="asc");var s={field:n,dir:r},i=a.state,c=i.filters,o=i.page,l=i.rowsPerPage;a.onChange(c,o,l,s),a.setState({sort:s})},a.handleSelectAllClick=function(e){if(e.target.checked){var t=a.props.store[a.props.data].data;a.setState(function(e){return{selected:t.filter(function(e){return!1===a.props.isDisabled(e)}).map(function(e){return e._id})}})}else a.setState({selected:[]})},a.handleClick=function(e){var t=a.state.selected,n=t.indexOf(e),r=[];-1===n?r=r.concat(t,e):0===n?r=r.concat(t.slice(1)):n===t.length-1?r=r.concat(t.slice(0,-1)):n>0&&(r=r.concat(t.slice(0,n),t.slice(n+1))),a.setState({selected:r})},a.handleChangePage=function(e,t){var n=a.state,r=n.filters,s=n.rowsPerPage,i=n.sort;a.onChange(r,t,s,i),a.setState({page:t})},a.handleChangeRowsPerPage=function(e){var t=e.target.value,n=a.state,r=n.filters,s=n.page,i=n.sort;a.onChange(r,s,t,i),a.setState({rowsPerPage:t})},a.isSelected=function(e){return-1!==a.state.selected.indexOf(e)},a.onChange=function(e,t,n,r){a.props.onChange(e,{limit:n,skip:n*t},r)},a.componentDidMount=function(){var e=a.state,t=e.filters,n=e.page,r=e.rowsPerPage,s=e.sort;a.onChange(t,n,r,s)},a.handleOpenFilter=function(){a.setState({isOpenFilter:!0})},a.handleCloseFilter=function(){a.setState({isOpenFilter:!1})},a.handleConfirmFilter=function(e){var t=Ct(a.props.rows,a.props.filters,e),n=a.state,r=n.rowsPerPage,s=n.sort;a.onChange(t,0,r,s),a.setState({filters:t,page:0,isOpenFilter:!1})},a.onDeleteMultiple=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.selected,r=t.filters,s=t.page,i=t.rowsPerPage,c=t.sort,e.next=3,Promise.all(n.map(function(e){return a.props.onDelete(e)}));case 3:a.onChange(r,s,i,c),a.setState({selected:[]}),a.handleCloseDelete();case 6:case"end":return e.stop()}},e)})),a.strToDate=function(e){return new Date(e).toLocaleDateString("en-US")},a.getValue=function(e,t){var n=Lt.a.get(e,t.field);switch(t.type){case"date":return a.strToDate(n);default:return n}},a.onDeleteSingle=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,r=n.filters,s=n.page,i=n.rowsPerPage,c=n.sort,e.next=3,a.props.onDelete(t);case 3:a.onChange(r,s,i,c);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleCloseDelete=function(){a.setState({isOpenDelete:!1})},a.handleOpenDelete=function(){a.setState({isOpenDelete:!0})},a.onExport=Object(de.a)(pe.a.mark(function e(){var t,n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.filters,r=t.sort,e.next=3,a.props.onChange(n,void 0,r);case 3:(s=e.sent)&&(a.setState({exported:s.data}),a.exportRef.current.link.click());case 5:case"end":return e.stop()}},e)})),a.handleRefresh=function(){var e=a.state,t=e.filters,n=e.page,r=e.rowsPerPage,s=e.sort;a.onChange(t,n,r,s)},a.state={selected:[],page:0,rowsPerPage:5,filters:Ct(e.rows,e.filters,e.defaultFilters),sort:e.defaultSort||{field:"_id",dir:"asc"},isOpenDelete:!1,isOpenFilter:!1,filter:null,exported:[]},a.exportRef=l.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.rows,r=t.sortable,s=t.title,i=this.state,c=i.selected,o=i.rowsPerPage,u=i.page,p=i.sort,d=i.isOpenDelete,h=i.isOpenFilter,f=this.props.store[this.props.data],m=o-Math.min(o,f.total-u*o),v=this.props.filename||"data";return l.a.createElement(le.a,{className:a.root},l.a.createElement(dt,{numSelected:c.length,onDelete:this.handleOpenDelete,onExport:this.onExport,onFilter:this.handleOpenFilter,title:s,isFilterSet:this.state.filters.length>0,actions:this.props.actions,onRefresh:this.handleRefresh,exportDisabled:!this.props.headers}),l.a.createElement("div",{className:a.tableWrapper},l.a.createElement(Pt,{isLoading:f.isLoading}),l.a.createElement(qe.a,{className:a.table,"aria-labelledby":"tableTitle",size:"small"},l.a.createElement(et,{numSelected:c.length,sort:p,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:f.total,rows:n,sortable:r}),l.a.createElement(Ue.a,null,f.data.map(function(t){var a=e.isSelected(t._id),r=e.props.isDisabled(t);return l.a.createElement(He.a,{hover:!0,role:"checkbox","aria-checked":a,tabIndex:-1,key:t._id,selected:a},l.a.createElement(Ve.a,{padding:"checkbox"},l.a.createElement(Ce.a,{checked:a,onClick:function(a){return e.handleClick(t._id)},disabled:r})),n.map(function(a){return l.a.createElement(Ve.a,{key:a.field,align:"num"===a.type?"right":"left",padding:a.disablePadding?"none":"default"},e.getValue(t,a))}),l.a.createElement(Ve.a,null,l.a.createElement(_t,{onDelete:function(){return e.onDeleteSingle(t._id)},onEdit:function(){return e.props.onEdit(t)},disabled:r})))}),m>0&&l.a.createElement(He.a,{style:{height:49*m}},l.a.createElement(Ve.a,{colSpan:6}))))),l.a.createElement(Je.a,{rowsPerPageOptions:[5,10,25],component:"div",count:f.total,rowsPerPage:o,page:u,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}),l.a.createElement(Et,{isOpen:d,onClose:this.handleCloseDelete,onConfirm:this.onDeleteMultiple,title:"Delete time records",description:"Are you sure?"}),l.a.createElement(St,{isOpen:h,onClose:this.handleCloseFilter,onConfirm:this.handleConfirmFilter,store:this.props.store,rows:this.props.rows,filters:this.props.filters,defaultState:this.props.defaultFilters}),l.a.createElement(Ft.CSVLink,{data:this.state.exported,headers:this.props.headers,filename:"".concat(v,".csv"),style:{display:"none"},ref:this.exportRef,target:"_blank"}))}}]),t}(l.a.Component),Mt=Object(te.withStyles)(function(e){return{root:{width:"100%"},table:{},tableWrapper:{overflowX:"auto",position:"relative"}}})(At);var qt,Wt=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,width:160}}})(function(e){return l.a.createElement(ft.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:e.isOpen,fullWidth:!0},l.a.createElement(Ot.a,{id:"simple-dialog-title"},e.title),e.children)}),Ut=function(e){return[{field:"name",disablePadding:!0,label:"Name"},{field:"date",type:"date",label:"Date"},{field:"_project.name",label:"Project",type:"enum",data:"projects",idField:"projectId"},{field:"_task.name",label:"Task",type:"enum",data:"tasks",idField:"taskId",filterable:!1},{field:"_user.name",label:"User",type:"enum",data:"users",idField:"userId",filterable:void 0===e.find(function(e){return"userId"===e.field})},{field:"duration",type:"num",label:"Duration",filterable:!1}]},zt=[{label:"Name",key:"name"},{label:"Date",key:"date"},{label:"Project",key:"project.name"},{label:"Task",key:"task.name"},{label:"User",key:"user.name"},{label:"Duration",key:"duration"}],Vt=[{label:"Period",field:"period",data:[{_id:1,name:"today",filters:[{field:"date",op:"lte",value:jt()().endOf("day").toDate()},{field:"date",op:"gte",value:jt()().startOf("day").toDate()}]},{_id:2,name:"this week",filters:[{field:"date",op:"lte",value:jt()().endOf("week").toDate()},{field:"date",op:"gte",value:jt()().startOf("week").toDate()}]},{_id:3,name:"last week",filters:[{field:"date",op:"lte",value:jt()().subtract(1,"weeks").endOf("week").toDate()},{field:"date",op:"gte",value:jt()().subtract(1,"weeks").startOf("week").toDate()}]},{_id:4,name:"this month",filters:[{field:"date",op:"lte",value:jt()().endOf("month").toDate()},{field:"date",op:"gte",value:jt()().startOf("month").toDate()}]},{_id:5,name:"last month",filters:[{field:"date",op:"lte",value:jt()().subtract(1,"month").endOf("month").toDate()},{field:"date",op:"gte",value:jt()().subtract(1,"month").startOf("month").toDate()}]},{_id:6,name:"this year",filters:[{field:"date",op:"lte",value:jt()().endOf("year").toDate()},{field:"date",op:"gte",value:jt()().startOf("year").toDate()}]},{_id:7,name:"last year",filters:[{field:"date",op:"lte",value:jt()().subtract(1,"year").endOf("month").toDate()},{field:"date",op:"gte",value:jt()().subtract(1,"year").startOf("year").toDate()}]}]}],Bt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleClose=function(){var e=a.props.user.user,t=a.props.store,n=t.projectId;(0,t.getOpenedTasks)(n,e),a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=[].concat(Object(Ae.a)(a.props.filters),Object(Ae.a)(t)),e.next=4,a.props.store.getTimeRecords(r,n);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),a.props.user.showError(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),a.onEdit=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.user.user,e.next=3,a.props.store.getOpenedTasks(t.projectId,n);case 3:a.setState({x:t,isOpen:!0});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a.state={x:null,isOpen:!1},qt=Ut(e.filters),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(de.a)(pe.a.mark(function e(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{this.props.store.getClients()}catch(t){this.props.user.showError(t)}case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.store.deleteTimeRecord;return l.a.createElement("div",null,l.a.createElement(Mt,{rows:qt,data:"timeRecords",onChange:this.handleChange,sortable:!1,onDelete:e,title:"Time records",onEdit:this.onEdit,store:this.props.store,filters:Vt,defaultFilters:this.props.defaultFilters,isDisabled:this.isDisabled,headers:zt}),l.a.createElement(Wt,{title:"Edit time record",onClose:this.handleClose,isOpen:this.state.isOpen},l.a.createElement(Le,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(l.a.Component),Jt=E(Pe,j)(Bt);var Gt=E(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),j)(function(e){var t=e.user.user;return l.a.createElement(ce.a,{container:!0,spacing:16},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(le.a,{className:e.classes.paper},l.a.createElement(Le,null))),l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(Jt,{filters:[{field:"userId",value:t._id}]})))}),Ht=a(103),Yt=a.n(Ht),Kt=a(153),Xt=a.n(Kt),Zt=a(30),Qt=a(40),$t=a.n(Qt);var ea=function(e){return l.a.createElement($t.a,e,l.a.createElement("path",{d:"M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"}))},ta=function(e){return Zt.github?l.a.createElement(Te.a,{fullWidth:e.fullWidth,variant:"outlined",color:"primary",tooltip:"Github",onClick:function(){var e="https://github.com/login/oauth/authorize?client_id=".concat(Zt.github.id,"&scope=user&redirect_uri=").concat("https://kristianduda.sk/app","?provider=1");window.location.replace(e)},disabled:e.disabled},l.a.createElement(ea,{fontSize:"large"})," ",l.a.createElement("span",{style:{width:200}},e.title)):null};var aa=function(e){return l.a.createElement($t.a,e,l.a.createElement("path",{d:"M21.35,11.1H12.18V13.83H18.69C18.36,17.64 15.19,19.27 12.19,19.27C8.36,19.27 5,16.25 5,12C5,7.9 8.2,4.73 12.2,4.73C15.29,4.73 17.1,6.7 17.1,6.7L19,4.72C19,4.72 16.56,2 12.1,2C6.42,2 2.03,6.8 2.03,12C2.03,17.05 6.16,22 12.25,22C17.6,22 21.5,18.33 21.5,12.91C21.5,11.76 21.35,11.1 21.35,11.1V11.1Z"}))},na=function(e){return Zt.google?l.a.createElement(Te.a,{fullWidth:e.fullWidth,variant:"outlined",color:"primary",onClick:function(){var e="https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/userinfo.profile&redirect_uri=".concat("https://kristianduda.sk/app","?provider=2&response_type=code&client_id=").concat(Zt.google.id);window.location.replace(e)},disabled:e.disabled},l.a.createElement(aa,{fontSize:"large"})," ",l.a.createElement("span",{style:{width:200}},e.title)):null};var ra=function(e){return l.a.createElement($t.a,e,l.a.createElement("path",{d:"M14.92 17.16l1.83-3.63h2.7l-4.51 8.97l-4.57-8.97h2.7l1.85 3.63m-4.29-8.5l-2.45 4.89H4.55L10.61 1.5l6.13 12.05h-3.63l-2.48-4.89z"}))},sa=function(e){return Zt.strava?l.a.createElement(Te.a,{fullWidth:e.fullWidth,variant:"outlined",color:"primary",onClick:function(){var e="https://www.strava.com/oauth/authorize?client_id=".concat(Zt.strava.id,"&response_type=code&scope=read,activity:read&redirect_uri=").concat("https://kristianduda.sk/app","?provider=4");window.location.replace(e)},disabled:e.disabled},l.a.createElement(ra,{fontSize:"large"})," ",l.a.createElement("span",{style:{width:200}},e.title)):null},ia=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleSubmit=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({disabled:!0}),n=a.state,r=n.username,s=n.password,i=n.token,e.prev=3,e.next=6,a.props.user.auth(r.trim().toLowerCase(),s,i);case 6:null===e.sent&&a.props.user.showMsg("Unauthorized"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),a.props.user.showError(e.t0);case 13:a.setState({disabled:!1});case 14:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){a.setState(Object(C.a)({},e.target.name,e.target.value))},a.handleClickReset=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=a.state.username)){e.next=11;break}return e.prev=2,e.next=5,a.props.user.reset(t.trim().toLowerCase());case 5:a.props.user.showMsg("Mail sended."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),a.props.user.showError(e.t0);case 11:case"end":return e.stop()}},e,null,[[2,8]])})),a.state={username:"",password:"",token:"",disabled:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.user,n=this.state,r=n.username,s=n.password,i=n.disabled,c=n.oAuth,o=n.token,u=(this.props.location.state||{from:{pathname:Zt.home}}).from;return c?null:a.user?l.a.createElement(f.a,{to:u}):l.a.createElement("main",{className:t.main},l.a.createElement(_.a,null),l.a.createElement(le.a,{className:t.paper},l.a.createElement(Yt.a,{className:t.avatar},l.a.createElement(Xt.a,null)),l.a.createElement(ta,{fullWidth:!0,disabled:i,title:"Sign in with Github"}),l.a.createElement(na,{fullWidth:!0,disabled:i,title:"Sign in with Google"}),l.a.createElement(sa,{fullWidth:!0,disabled:i,title:"Sign in with Strava"}),l.a.createElement(Y.a,{variant:"body1"},"or use your account"),l.a.createElement("form",{className:t.form,onSubmit:this.handleSubmit},l.a.createElement(ve.a,{margin:"normal",required:!0,fullWidth:!0},l.a.createElement(xe.a,{htmlFor:"username"},"Username"),l.a.createElement(ge.a,{id:"username",name:"username",autoComplete:"username",autoFocus:!0,value:r,onChange:this.handleChange})),l.a.createElement(ve.a,{margin:"normal",required:!0,fullWidth:!0},l.a.createElement(xe.a,{htmlFor:"password"},"Password"),l.a.createElement(ge.a,{name:"password",type:"password",id:"password",autoComplete:"current-password",value:s,onChange:this.handleChange})),Zt["2fa"]&&l.a.createElement(ve.a,{margin:"normal",fullWidth:!0},l.a.createElement(xe.a,{htmlFor:"password"},"Token"),l.a.createElement(ge.a,{name:"token",id:"token",value:o,onChange:this.handleChange})),l.a.createElement(Te.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,disabled:i},"Sign in"))))}}]),t}(l.a.Component),ca=E(O()(function(e){return{main:Object(C.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:2*e.spacing.unit,marginBottom:2*e.spacing.unit},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main,marginBottom:2*e.spacing.unit},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit},forgot:{marginTop:e.spacing.unit}}}),j,Pe)(ia),oa={name:"",collaborators:[]},la=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||oa,a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addProject,r=t.getProjects,s=t.editProject,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,i);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i);case 10:r(),a.setState(oa),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(de.a)(pe.a.mark(function e(){var t,a,n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.user.getUsers,a=this.props.user.user,n=[{field:"_id",op:"ne",value:a._id}],e.prev=3,e.next=6,t(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),this.props.user.showError(e.t0);case 11:case"end":return e.stop()}},e,this,[[3,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.name,n=t.collaborators,r=this.props.user.users;return l.a.createElement(Ne,{onSubmit:this.handleSubmit,inline:!0},l.a.createElement(ke,{label:"Name",value:a,field:"name",onChange:this.handleChange,required:!0}),l.a.createElement("div",{className:e.collaborators},l.a.createElement(Se,{label:"Collaborators",value:n,field:"collaborators",onChange:this.handleChange,data:r.data,textField:"name",fullWidth:!0,multiple:!0})))}}]),t}(l.a.Component),ua=E(Object(te.withStyles)(function(e){return{collaborators:{display:"flex",flex:1}}}),Pe,j)(la),pa=a(310),da=a.n(pa),ha=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).onDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,r=n.onDelete,s=n.onChange,e.next=3,r(t);case 3:s();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.onChange()}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.onClick,r=t.primaryTextField,s=t.secondaryTextField,i=t.onEdit,c=t.isDisabled,o=t.classes;return l.a.createElement(le.a,{className:o.listWrapper},l.a.createElement(Pt,{isLoading:a.isLoading}),l.a.createElement(M.a,null,a.data.map(function(t){return l.a.createElement(W.a,{key:t._id,button:!0,onClick:function(){return n(t._id)}},l.a.createElement(z.a,{primary:Lt.a.get(t,r),secondary:s?Lt.a.get(t,s):null}),l.a.createElement(da.a,null,l.a.createElement(_t,{disabled:c(t),onEdit:function(){return i(t)},onDelete:function(){return e.onDelete(t._id)}})))})))}}]),t}(l.a.Component),fa=Object(te.withStyles)(function(e){return{listWrapper:{position:"relative"}}})(ha),ma=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleClick=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props.history.location.pathname+"/"+t,a.props.history.push(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){try{a.props.store.getProjects(a.props.user.user)}catch(t){a.props.user.showError(t)}},a.handleEdit=function(e){a.setState({x:e,isOpen:!0})},a.handleDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.deleteProject,e.prev=1,e.next=4,n(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.projects;return l.a.createElement("div",{className:e.list},l.a.createElement(fa,{data:t,primaryTextField:"name",onClick:this.handleClick,onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled}),l.a.createElement(Wt,{title:"Edit project",onClose:this.handleClose,isOpen:this.state.isOpen},l.a.createElement(ua,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(l.a.Component),va=E(Object(te.withStyles)(function(e){return{list:{marginTop:e.spacing.unit}}}),Pe,j,f.f)(ma);var ba=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return l.a.createElement(ce.a,{container:!0,spacing:24},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(le.a,{className:e.classes.paper},l.a.createElement(ua,null)),l.a.createElement(va,null)))}),ga={name:"",assignedToId:null,stateId:1},wa=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||ga,a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addTask,r=t.refreshTasks,s=t.editTask,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i,a.props.projectId);case 10:r(),a.setState(ga),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.states,a=this.state,n=a.name,r=a.assignedToId,s=a.stateId,i=this.props.store.users;return l.a.createElement(Ne,{onSubmit:this.handleSubmit,inline:!0},l.a.createElement("div",{className:e.name},l.a.createElement(ke,{label:"Name",value:n,field:"name",onChange:this.handleChange,required:!0,fullWidth:!0})),l.a.createElement(Se,{label:"Assigned to",value:r,field:"assignedToId",onChange:this.handleChange,data:i.data,textField:"name"}),l.a.createElement(Se,{label:"State",value:s,field:"stateId",onChange:this.handleChange,data:t.data,required:!0,textField:"name"}))}}]),t}(l.a.Component),xa=E(Object(te.withStyles)(function(e){return{name:{display:"flex",flex:1}}}),Pe,j)(wa),ka=[{field:"name",disablePadding:!0,label:"Name"},{field:"_assignedTo.name",label:"Assigned to",type:"enum",data:"users",idField:"assignedToId",sortable:!1},{field:"_state.name",label:"State",type:"enum",data:"states",idField:"stateId",sortable:!1}],Oa=[{label:"Name",key:"name"},{label:"Assigned to",key:"assignedTo.name"},{label:"State",key:"state.name"}],Ea=[],ya=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getTasks(a.props.projectId,t,n,r);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onEdit=function(e){a.setState({x:e,isOpen:!0})},a.isDisabled=function(e){return a.props.user.user._id!==e.userId&&a.props.user.user._id!==e.assignedToId},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store,t=e.deleteTask,a=e.project,n=a?"".concat(a.name,"_tasks"):null;return l.a.createElement("div",null,l.a.createElement(Mt,{rows:ka,data:"tasks",onChange:this.handleChange,onDelete:t,title:"Tasks",onEdit:this.onEdit,store:this.props.store,filters:Ea,isDisabled:this.isDisabled,filename:n,headers:Oa}),l.a.createElement(Wt,{title:"Edit task",onClose:this.handleClose,isOpen:this.state.isOpen},l.a.createElement(xa,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(l.a.Component),ja=E(Pe,j)(ya),Ca=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(de.a)(pe.a.mark(function e(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.store.getProject(this.props.match.params.id);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.props.user.showError(e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return l.a.createElement(ce.a,{container:!0,spacing:24},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(le.a,{className:this.props.classes.paper},l.a.createElement(xa,{projectId:this.props.match.params.id}))),l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(ja,{projectId:this.props.match.params.id})))}}]),t}(l.a.Component),Sa=E(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),Pe)(Ca),Da=a(34);var Ta=Object(te.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,width:160}}})(function(e){return l.a.createElement(ft.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:e.isOpen,fullWidth:!0},l.a.createElement(Ot.a,{id:"simple-dialog-title"},e.title),e.children,l.a.createElement(vt.a,null,e.onCancel&&l.a.createElement(Te.a,{onClick:e.onCancel,color:"primary"},"Cancel"),e.onConfirm&&l.a.createElement(Te.a,{onClick:e.onConfirm,color:"primary",autoFocus:!0},"OK")))}),_a=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.defaultValue,n=e.tooltip,r=e.onClick,s=e.className,i=e.placement;return l.a.createElement($e.a,{title:n,"aria-label":n,placement:i},l.a.createElement(Yt.a,{style:{textTransform:"uppercase"},alt:a,src:t?"data:image/jpeg;base64,"+t:null,onClick:r,className:s},n[0]))}}]),t}(l.a.Component),Na=Object(te.withStyles)(function(e){return{}})(_a),Ia=function(e){return{col:{display:"flex",flex:1,flexDirection:"column",marginBottom:e.spacing.unit},row:{display:"flex",flexWrap:"wrap",flexDirection:"row"},center:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},paper:{padding:e.spacing.unit},flex:{display:"flex"}}},Pa=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).resize=function(e,t){return new Promise(function(n){var r=new Image,s=a.canvasRef.current;r.onload=function(){r.height>t&&(r.width*=t/r.height,r.height=t);var e=s.getContext("2d");e.clearRect(0,0,s.width,s.height),s.width=r.width,s.height=r.height,e.drawImage(r,0,0,r.width,r.height);var a=s.toDataURL("image/jpeg");n(a)},r.src=e})},a.onChange=function(e){e.preventDefault();var t=new FileReader;t.onloadend=Object(de.a)(pe.a.mark(function e(){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.resize(t.result,320);case 2:n=(n=e.sent).split(",").pop(),a.props.onChange(a.props.field,n);case 5:case"end":return e.stop()}},e)})),t.readAsDataURL(e.target.files[0])},a.onClick=function(){a.props.disabled||a.inputRef.current.click()},a.inputRef=l.a.createRef(),a.canvasRef=l.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.value,n=e.tooltip,r=e.disabled;return l.a.createElement("div",{className:t.center,style:{cursor:r?"default":"pointer"}},l.a.createElement(Na,{className:t.bigAvatar,value:a,onClick:this.onClick,tooltip:n,placement:"right"}),l.a.createElement("input",{ref:this.inputRef,style:{display:"none"},type:"file",accept:"image/jpeg",onChange:this.onChange}),l.a.createElement("canvas",{style:{display:"none"},ref:this.canvasRef}))}}]),t}(l.a.Component),Fa=Object(te.withStyles)(function(e){return Object(Da.a)({},Ia(e),{bigAvatar:{margin:e.spacing.unit,width:80,height:80}})})(Pa),Ra=a(311),La=a.n(Ra),Aa=a(312),Ma=a.n(Aa);var qa=Object(te.withStyles)(function(e){return{formControl:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit}}})(function(e){var t=e.classes;return l.a.createElement(La.a,{className:t.formControl,control:l.a.createElement(Ma.a,{checked:e.value,onChange:function(t){return e.onChange(e.field,t.target.checked)},value:e.field,disabled:e.disabled}),label:e.label})}),Wa={password:"",repeatedPassword:"",name:"",username:"",email:"",otp:!1,avatar:null},Ua=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=Object(Da.a)({},Wa,a.props.user.user,{isOpenSecretDialog:!1,avatarChanged:!1}),a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleChangeAvatar=function(e,t){var n;a.setState((n={},Object(C.a)(n,e,t),Object(C.a)(n,"avatarChanged",!0),n))},a.generateSecret=Object(de.a)(pe.a.mark(function e(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.user.generateSecret();case 3:a.handleOpenSecretDialog(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])})),a.handleOpenSecretDialog=function(){a.setState({isOpenSecretDialog:!0})},a.handleCloseSecretDialog=function(){a.setState({isOpenSecretDialog:!1})},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c,o,l,u;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.password,r=t.repeatedPassword,s=t.name,i=t.username,c=t.email,o=t.otp,l=t.avatar,u=t.avatarChanged,n===r){e.next=4;break}return a.props.user.showMsg("Passwords do not match."),e.abrupt("return");case 4:return e.prev=4,e.next=7,a.props.user.updateUser(a.state._id,{name:s,username:i,email:c,password:n,otp:o,avatar:u?l:null});case 7:a.setState(Object(Da.a)({},a.props.user.user)),a.props.user.showMsg("Ok."),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),a.props.user.showError(e.t0);case 14:case"end":return e.stop()}},e,null,[[4,11]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.password,s=n.repeatedPassword,i=n.username,c=n.name,o=n.email,u=n.otp,p=n.avatar;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Ne,{onSubmit:this.handleSubmit,disabled:a},l.a.createElement(Fa,{field:"avatar",onChange:this.handleChangeAvatar,value:p,disabled:a,tooltip:c||""}),l.a.createElement("div",{className:t.row},l.a.createElement("div",{className:t.col},l.a.createElement(ke,{label:"Name",value:c,field:"name",onChange:this.handleChange,required:!0,disabled:a})),l.a.createElement("div",{className:t.col},l.a.createElement(ke,{label:"Email",value:o,field:"email",onChange:this.handleChange,disabled:a}))),l.a.createElement("div",{className:t.row},l.a.createElement("div",{className:t.col},l.a.createElement(ke,{label:"Username",value:i,field:"username",onChange:this.handleChange,required:!0,disabled:!0})),l.a.createElement("div",{className:t.col},l.a.createElement(ke,{label:"Password",value:r,field:"password",type:"new-password",onChange:this.handleChange,disabled:a})),l.a.createElement("div",{className:t.col},l.a.createElement(ke,{label:"Password again",value:s,field:"repeatedPassword",type:"password",onChange:this.handleChange,disabled:a}))),Zt["2fa"]&&l.a.createElement("div",{className:t.row},l.a.createElement("div",{className:t.col},l.a.createElement("div",null,l.a.createElement(qa,{label:"2FA",value:u,field:"otp",onChange:this.handleChange,disabled:a}),l.a.createElement(Te.a,{color:"primary",disabled:a||!this.state.otp,onClick:this.generateSecret},"Generate secret"))))),l.a.createElement(Ta,{title:"Secret",isOpen:this.state.isOpenSecretDialog,onConfirm:this.handleCloseSecretDialog},l.a.createElement("div",{className:t.center},this.props.user.secret&&l.a.createElement("img",{src:"data:image/jpeg;base64,"+this.props.user.secret.qrCode,alt:"secret",width:320,height:320}))))}}]),t}(l.a.Component),za=E(Object(te.withStyles)(function(e){return Object(Da.a)({},Ia(e),{heading:{marginLeft:e.spacing.unit},detailHeading:{marginLeft:e.spacing.unit,marginTop:3*e.spacing.unit},actions:{float:"right",margin:e.spacing.unit}})}),Pe,j)(Ua),Va={user:1,store:2,mail:4,file:8,report:16,tags:1024,tasks:2048,events:4096,activities:2};var Ba=E(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit},heading:{marginLeft:e.spacing.unit},connected:{padding:e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"flex-start"}}}),j)(function(e){var t=e.user,a=t.user,n=!(0,t.hasPermission)(Va.user);return l.a.createElement(ce.a,{container:!0,spacing:16},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(le.a,{className:e.classes.paper},l.a.createElement(za,{disabled:n}))),l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(le.a,{className:e.classes.connected},l.a.createElement(Y.a,{variant:"h6",className:e.classes.heading},"Connected apps"),l.a.createElement(ta,{disabled:n||a.github,title:e.user.user.github?e.user.user.github.name:"Connect Github"}),l.a.createElement(na,{disabled:n||a.google,title:e.user.user.google?e.user.user.google.name:"Connect Google"}),l.a.createElement("div",null,l.a.createElement(sa,{disabled:n,title:e.user.user.strava?"Sync ".concat(e.user.user.strava.name):"Connect Strava"}),e.user.user.strava&&e.user.user.strava.synced&&l.a.createElement("span",null," (last sync ",new Date(e.user.user.strava.synced).toLocaleDateString(),") ")))))}),Ja=a(86),Ga=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.stats,t=this.props.theme;return l.a.createElement(le.a,{className:this.props.classes.paper},l.a.createElement(Ja.b,{width:800,height:300,data:e.data},l.a.createElement(Ja.c,{strokeDasharray:"3 3"}),l.a.createElement(Ja.e,{dataKey:"name"}),l.a.createElement(Ja.f,null),l.a.createElement(Ja.d,null),l.a.createElement(Ja.a,{dataKey:"val",fill:t.palette.primary.main})),l.a.createElement(Y.a,{variant:"body2",color:"textPrimary",component:"p",className:this.props.classes.heading},"Total: ",e.sum))}}]),t}(o.PureComponent),Ha=E(Pe,Object(te.withStyles)(function(e){return{paper:{width:"100%",padding:e.spacing.unit,overflowX:"auto",margin:"auto"},heading:{marginLeft:e.spacing.unit}}}),Object(te.withTheme)())(Ga);var Ya,Ka,Xa,Za=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return l.a.createElement(ce.a,{container:!0,spacing:16},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(Ha,null)),l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(Jt,{filters:[],defaultFilters:{period:4}})))}),Qa=function(e){function t(e){var a;Object(n.a)(this,t),a=Object(s.a)(this,Object(i.a)(t).call(this,e));var r=new URLSearchParams(a.props.location.search);return Ka=r.get("provider"),Ya=r.get("code"),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ka||Xa){e.next=22;break}if(Xa=!0,t=this.props.user,e.prev=3,!t.user){e.next=10;break}return e.next=7,t.updateOauth(Ka,Ya);case 7:this.props.history.replace("/account"),e.next=15;break;case 10:return e.next=12,t.oAuth(Ka,Ya);case 12:if(e.sent){e.next=14;break}t.showMsg("Unauthorized");case 14:this.props.history.replace(Zt.home);case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),this.props.user.showError(e.t0),this.props.history.replace("/login");case 21:Xa=!1;case 22:case"end":return e.stop()}},e,this,[[3,17]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.classes;return Ka?l.a.createElement("main",{className:e.main},l.a.createElement(_.a,null),l.a.createElement(le.a,{className:e.paper},l.a.createElement(Yt.a,{className:e.avatar},l.a.createElement(Xt.a,null)),l.a.createElement("div",{className:e.loader},l.a.createElement(Y.a,{component:"h1",variant:"h5"},"loading...")))):l.a.createElement(f.a,{to:{pathname:Zt.home}})}}]),t}(l.a.Component),$a=E(O()(function(e){return{main:Object(C.a)({width:"100%",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},loader:{marginTop:e.spacing.unit}}}),j,Pe)(Qa),en={name:"",address:"",ico:"",dic:"",icdph:"",rate:0,reportId:"",activity:""},tn=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||en,a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addClient,r=t.getClients,s=t.editClient,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,i);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i);case 10:r(),a.props.onSubmit&&a.props.onSubmit(),a.setState(en),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.name,s=n.address,i=n.ico,c=n.dic,o=n.icdph,u=n.rate,p=n.reportId,d=n.activity;return l.a.createElement(Ne,{onSubmit:this.handleSubmit,disabled:a},l.a.createElement("div",{className:t.row},l.a.createElement("div",{className:t.col},l.a.createElement(ke,{label:"Name",value:r,field:"name",onChange:this.handleChange,required:!0,disabled:a}))),l.a.createElement("div",{className:t.row},l.a.createElement("div",{className:t.col},l.a.createElement(ke,{className:t.col,label:"Address",value:s,field:"address",onChange:this.handleChange,required:!0,disabled:a}))),l.a.createElement("div",{className:t.row},l.a.createElement("div",{className:t.col},l.a.createElement(ke,{label:"I\u010cO",value:i,field:"ico",onChange:this.handleChange,required:!0,disabled:a})),l.a.createElement("div",{className:t.col},l.a.createElement(ke,{className:t.col,label:"DI\u010c",value:c,field:"dic",onChange:this.handleChange,required:!0,disabled:a})),l.a.createElement("div",{className:t.col},l.a.createElement(ke,{className:t.col,label:"I\u010c DPH",value:o,field:"icdph",onChange:this.handleChange,required:!0,disabled:a}))),l.a.createElement("div",{className:t.row},l.a.createElement("div",{className:t.col},l.a.createElement(ke,{label:"Activity",value:d,field:"activity",onChange:this.handleChange,required:!0,disabled:a})),l.a.createElement("div",{className:t.col},l.a.createElement(Oe,{label:"Rate",value:u,field:"rate",onChange:this.handleChange,min:0,step:.5,required:!0})),l.a.createElement("div",{className:t.col},l.a.createElement(ke,{className:t.col,label:"ReportId",value:p,field:"reportId",onChange:this.handleChange,required:!0,disabled:a}))))}}]),t}(l.a.Component),an=E(Object(te.withStyles)(function(e){return Object(Da.a)({},Ia(e))}),Pe,j)(tn),nn=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleClick=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props.history.location.pathname+"/"+t,a.props.history.push(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){try{a.props.store.getClients()}catch(t){a.props.user.showError(t)}},a.handleEdit=function(e){a.setState({x:e,isOpen:!0})},a.handleDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.deleteClient,e.prev=1,e.next=4,n(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.clients;return l.a.createElement("div",{className:e.list},l.a.createElement(fa,{data:t,primaryTextField:"name",onClick:this.handleClick,onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled}),l.a.createElement(Wt,{title:"Edit client",onClose:this.handleClose,isOpen:this.state.isOpen},l.a.createElement(an,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(l.a.Component),rn=E(Object(te.withStyles)(function(e){return{list:{marginTop:e.spacing.unit}}}),Pe,j,f.f)(nn);var sn=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return l.a.createElement(ce.a,{container:!0,spacing:24},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(le.a,{className:e.classes.paper},l.a.createElement(an,null)),l.a.createElement(rn,null)))}),cn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).getInitState=function(e){var t=e.date||jt()().add(1,"days").toDate();return{start:t,end:t,name:"",eventTypeId:1}},a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleChangeStart=function(e,t){t.getTime()>a.state.end.getTime()?a.setState({start:t,end:t}):a.setState({start:t})},a.handleChangeEnd=function(e,t){t.getTime()<a.state.start.getTime()?a.setState({start:t,end:t}):a.setState({end:t})},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addEvent,r=t.refreshEvents,s=t.editEvent,i=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,i);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,i);case 10:r(),a.setState(a.getInitState(a.props)),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a.state=e.data||a.getInitState(e),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.disabled,n=this.state,r=n.name,s=n.eventTypeId,i=n.start,c=n.end,o=this.props.store.eventTypes;return l.a.createElement(Ne,{onSubmit:this.handleSubmit,inline:!0,disabled:a},l.a.createElement("div",{className:t.nameTextInput},l.a.createElement(ke,{label:"Name",value:r,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:a})),l.a.createElement(Se,{label:"Type",value:s,field:"eventTypeId",onChange:this.handleChange,data:o.data,textField:"name",required:!0,disabled:a}),l.a.createElement("div",{className:t.nameTextInput},l.a.createElement(fe,{label:"Start",value:i,field:"start",onChange:this.handleChangeStart,required:!0,disabled:a}),l.a.createElement(fe,{label:"End",value:c,field:"end",onChange:this.handleChangeEnd,required:!0,disabled:a})))}}]),t}(l.a.Component),on=E(Object(te.withStyles)(function(e){return{nameTextInput:{display:"flex",flex:1}}}),Pe,j)(cn),ln=[{field:"name",disablePadding:!0,label:"Name"},{field:"_eventType.name",label:"Type",type:"enum",data:"eventTypes",idField:"eventTypeId"},{field:"start",type:"date",label:"Start",filterable:!1},{field:"end",type:"date",label:"End",filterable:!1},{field:"_user.name",label:"User",type:"enum",data:"users",idField:"userId"}],un=[{label:"Name",key:"name"},{label:"Type",key:"eventType.name"},{label:"Start",key:"start"},{label:"End",key:"end"},{label:"User",key:"user.name"}],pn=[{label:"Period",field:"period",data:[{_id:1,name:"today",filters:[{field:"start",op:"lte",value:jt()().endOf("day").toDate()},{field:"start",op:"gte",value:jt()().startOf("day").toDate()}]},{_id:2,name:"this week",filters:[{field:"start",op:"lte",value:jt()().endOf("week").toDate()},{field:"start",op:"gte",value:jt()().startOf("week").toDate()}]},{_id:3,name:"last week",filters:[{field:"start",op:"lte",value:jt()().subtract(1,"weeks").endOf("week").toDate()},{field:"start",op:"gte",value:jt()().subtract(1,"weeks").startOf("week").toDate()}]},{_id:4,name:"this month",filters:[{field:"start",op:"lte",value:jt()().endOf("month").toDate()},{field:"start",op:"gte",value:jt()().startOf("month").toDate()}]},{_id:5,name:"last month",filters:[{field:"start",op:"lte",value:jt()().subtract(1,"month").endOf("month").toDate()},{field:"start",op:"gte",value:jt()().subtract(1,"month").startOf("month").toDate()}]}]}],dn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChangeClient=function(e,t){a.setState({clientId:t})},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getEvents(t,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.onEdit=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({x:t,isOpen:!0});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a.state={x:null,isOpen:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.deleteEvent;return l.a.createElement("div",null,l.a.createElement(Mt,{rows:ln,data:"events",onChange:this.handleChange,sortable:!1,onDelete:e,title:"Events",onEdit:this.onEdit,store:this.props.store,filters:pn,isDisabled:this.isDisabled,headers:un}),l.a.createElement(Wt,{title:"Edit event",onClose:this.handleClose,isOpen:this.state.isOpen},l.a.createElement(on,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(l.a.Component),hn=E(Pe,j)(dn);var fn=E(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),j)(function(e){return l.a.createElement(ce.a,{container:!0,spacing:16},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(le.a,{className:e.classes.paper},l.a.createElement(on,null))),l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(hn,null)))}),mn=a(321),vn=a(111),bn=a(322),gn=a(323),wn=(a(723),a(724),a(725),a(726),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).calendarComponentRef=l.a.createRef(),a.state={defaultView:"dayGridMonth",defaultDate:new Date},a.eventDataTransform=function(e){return e.id=e._id,e.title=e[a.props.textField],e.color=a.props.getColor(e),e},a.handleDateClick=function(e){a.props.onSelect(null,e.date)},a.handleEventClick=function(e){var t=a.props.data.data.find(function(t){return t._id===e.event.id});a.props.onSelect(t,e.date)},a.handleViewDisplay=function(e){var t=[{field:"start",op:"gte",value:e.view.activeStart},{field:"end",op:"lte",value:e.view.activeEnd}];a.props.onChange(t,{limit:200,skip:0},null),a.setState({defaultView:e.view.type,defaultDate:e.view.activeStart})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.defaultDate,a=e.defaultView;return l.a.createElement("div",{className:"Calendar"},l.a.createElement(mn.a,{defaultView:a,defaultDate:t,header:{left:"today, prev, next, title",right:"dayGridMonth, timeGridWeek"},plugins:[vn.d,bn.a,gn.a],ref:this.calendarComponentRef,weekends:!0,events:this.props.data.data,dateClick:this.handleDateClick,eventClick:this.handleEventClick,eventDataTransform:this.eventDataTransform,datesRender:this.handleViewDisplay,eventColor:this.props.theme.palette.primary.main}))}}]),t}(l.a.Component)),xn=Object(te.withTheme)()(wn),kn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).getColor=function(e){var t=a.props.theme;switch(e.eventTypeId){case 1:return t.palette.primary.main;case 2:default:return t.palette.secondary.main}},a.handleSelect=function(e,t){a.setState({x:e,isOpen:!0,date:t})},a.handleClose=function(){a.setState({isOpen:!1})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getEvents(t,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.state={x:null,isOpen:!1,date:null},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.store.events,t=this.props.user.user,a=this.state.x&&this.state.x.userId!==t._id;return l.a.createElement(ce.a,{container:!0,spacing:16},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(le.a,{className:this.props.classes.paper},l.a.createElement(xn,{onSelect:this.handleSelect,onChange:this.handleChange,textField:"name",data:e,getColor:this.getColor}),l.a.createElement(Wt,{title:"Event",onClose:this.handleClose,isOpen:this.state.isOpen},l.a.createElement(on,{data:this.state.x,onSubmit:this.handleClose,date:this.state.date,disabled:a})))))}}]),t}(l.a.Component),On=E(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),j,Pe,Object(te.withTheme)())(kn),En=a(85),yn=a(324),jn=a.n(yn),Cn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).state={delay:500,legacy:!0},a.handleScan=a.handleScan.bind(Object(En.a)(Object(En.a)(a))),a.openImageDialog=a.openImageDialog.bind(Object(En.a)(Object(En.a)(a))),a.myRef=l.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"handleScan",value:function(e){if(e){var t=e.split(".");if(2===t.length)try{this.props.user.verify(t[0],t[1])}catch(a){this.props.user.showError(a)}}}},{key:"handleError",value:function(e){console.error(e)}},{key:"openImageDialog",value:function(){var e=this;this.setState({legacy:!0},function(){e.myRef.current.openImageDialog()})}},{key:"render",value:function(){var e=this.props.classes;return l.a.createElement("div",{className:e.row},l.a.createElement("div",{className:e.col},l.a.createElement("div",{className:e.center},l.a.createElement(jn.a,{ref:this.myRef,delay:this.state.delay,style:{height:320,width:320},onError:this.handleError,onScan:this.handleScan,legacyMode:this.state.legacy}),l.a.createElement(Te.a,{variant:"contained",color:"primary",className:e.submit,onClick:this.openImageDialog},"Scan"))),l.a.createElement("div",{className:e.col},l.a.createElement(le.a,{className:e.paper},l.a.createElement(Y.a,{variant:"h6"},"Data"),this.props.user.signature&&l.a.createElement("div",null,l.a.createElement(Y.a,{variant:"body1"},this.props.user.signature.data)))))}}]),t}(o.Component),Sn=E(Object(te.withStyles)(function(e){return Object(Da.a)({},Ia(e))}),Pe,j)(Cn),Dn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleSubmit=function(){try{a.props.user.sign(a.state.data)}catch(e){a.props.user.showError(e)}},a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.state={data:""},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes;return l.a.createElement("div",{className:e.row},l.a.createElement("div",{className:e.col},l.a.createElement(le.a,{className:e.paper},l.a.createElement(Ne,{onSubmit:this.handleSubmit},l.a.createElement("div",{className:e.flex},l.a.createElement(ke,{label:"Data",value:this.state.data,field:"data",onChange:this.handleChange,required:!0,multiline:!0,fullWidth:!0,rows:8}))))),l.a.createElement("div",{className:e.col},l.a.createElement("div",{className:e.center},this.props.user.signature&&l.a.createElement("img",{src:"data:image/jpeg;base64,"+this.props.user.signature.qrCode,alt:"signature",width:320,height:320}))))}}]),t}(o.Component),Tn=E(Object(te.withStyles)(function(e){return Object(Da.a)({},Ia(e))}),Pe,j)(Dn),_n=a(326),Nn=a.n(_n);var In=Object(te.withStyles)(function(e){return{}})(function(e){var t=e.color,a=e.onClick,n=e.tooltip,r=e.disabled,s=e.className;return l.a.createElement($e.a,{title:n},l.a.createElement(g.a,{color:t,onClick:a,"aria-label":n,disabled:r,className:s},e.children))}),Pn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).onChange=function(e){e.preventDefault();var t=e.target.files[0];a.props.onChange(a.props.field,t)},a.onClick=function(){a.props.disabled||a.inputRef.current.click()},a.inputRef=l.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.value,n=e.disabled,r=e.mimeType;return l.a.createElement("div",null,l.a.createElement(In,{className:t.button,tooltip:"Attach file",color:a?"primary":"default",onClick:this.onClick,disabled:n},l.a.createElement(Nn.a,null)),l.a.createElement("input",{ref:this.inputRef,style:{display:"none"},type:"file",accept:r,onChange:this.onChange}))}}]),t}(l.a.Component),Fn=Object(te.withStyles)(function(e){return Object(Da.a)({},Ia(e),{button:{marginTop:e.spacing.unit,marginBottom:e.spacing.unit}})})(Pn),Rn={name:"",likes:[],likesCnt:0,typesId:[],unavailable:!1,_img:null},Ln=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state=a.props.data||Rn,a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.handleSubmit=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.store,n=t.addTag,r=t.getTags,s=t.editTag,i=t.tags,c=a.props.user.user,e.prev=2,!a.state._id){e.next=8;break}return e.next=6,s(a.state,c);case 6:e.next=10;break;case 8:return e.next=10,n(a.state,c);case 10:r(i.filters),a.setState(Rn),a.props.onSubmit&&a.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a.props.user.showError(e.t0);case 18:case"end":return e.stop()}},e,null,[[2,15]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.name,n=t.typesId,r=t.unavailable,s=t._img,i=this.props.store.tagTypes;return l.a.createElement(Ne,{onSubmit:this.handleSubmit,inline:!0},l.a.createElement(ke,{label:"Name",value:a,field:"name",onChange:this.handleChange,required:!0}),l.a.createElement("div",{className:e.collaborators},l.a.createElement(Se,{label:"Types",value:n,field:"typesId",onChange:this.handleChange,data:i.data,textField:"name",fullWidth:!0,multiple:!0})),l.a.createElement(Fn,{mimeType:"image/jpeg",value:s,field:"_img",onChange:this.handleChange,disabled:void 0!==this.state._id}),l.a.createElement(qa,{label:"",value:r,field:"unavailable",onChange:this.handleChange}))}}]),t}(l.a.Component),An=E(Object(te.withStyles)(function(e){return{collaborators:{display:"flex",flex:1}}}),Pe,j)(Ln),Mn=a(334),qn=a.n(Mn),Wn=a(335),Un=a.n(Wn),zn=a(328),Vn=a.n(zn),Bn=a(329),Jn=a.n(Bn),Gn=a(330),Hn=a.n(Gn),Yn=a(201),Kn=a.n(Yn),Xn=a(331),Zn=a.n(Xn),Qn=a(333),$n=a.n(Qn),er=a(192),tr=a.n(er),ar=a(332),nr=a.n(ar),rr=a(327),sr=a.n(rr),ir=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={imgViz:!1,img:null},a.state={expanded:!1},a.handleExpandClick=function(){a.setState(function(e){return{expanded:!e.expanded}})},a.onViz=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onViz();case 2:n=e.sent,a.setState({imgViz:!0}),n&&((r=new FileReader).onloadend=function(){a.setState({img:r.result})},r.readAsDataURL(n));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.actions,n=e.children,r=e.cardActions,s=e.primary,i=e.secondary,c=e.avatar,o=e.defaultAvatar,u=e.tooltip,p=e.content;return l.a.createElement(sr.a,{partialVisibility:!0,onChange:this.onViz},l.a.createElement(Vn.a,{className:t.card},l.a.createElement(Jn.a,{avatar:l.a.createElement(Na,{className:t.bigAvatar,defaultValue:o,value:c,tooltip:u}),action:a,title:s,subheader:i}),l.a.createElement(Hn.a,{className:t.media,image:this.state.img||"https://next.material-ui.com/static/images/cards/paella.jpg",title:"media",style:{opacity:this.state.imgViz?1:.25,transition:"opacity 500ms linear"}}),l.a.createElement(Kn.a,null,p),l.a.createElement(Zn.a,{className:t.actions,disableActionSpacing:!0},r,n&&l.a.createElement(g.a,{className:at()(t.expand,Object(C.a)({},t.expandOpen,this.state.expanded)),onClick:this.handleExpandClick,"aria-expanded":this.state.expanded,"aria-label":"Show more"},l.a.createElement(nr.a,null))),l.a.createElement($n.a,{in:this.state.expanded,timeout:"auto",unmountOnExit:!0},l.a.createElement(Kn.a,null,n))))}}]),t}(l.a.Component),cr=Object(te.withStyles)(function(e){return{card:{margin:e.spacing.unit,width:"100%",maxWidth:480},media:{height:0,paddingTop:"56.25%"},actions:{display:"flex"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:tr.a[500]}}})(ir),or=Object(te.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(pt.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 auto"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}})(function(e){var t=e.classes,a=e.onFilter,n=e.title,r=e.isFilterSet,s=e.actions,i=e.onRefresh;return l.a.createElement(G.a,{className:t.root},l.a.createElement("div",{className:t.title},l.a.createElement(Y.a,{variant:"h6",id:"tableTitle"},n)),l.a.createElement("div",{className:t.spacer}),l.a.createElement("div",{className:t.actions},s,l.a.createElement($e.a,{title:"Filter list"},l.a.createElement(g.a,{"aria-label":"Filter list",color:r?"primary":"default",onClick:a},l.a.createElement(ot.a,null))),l.a.createElement($e.a,{title:"Refresh list"},l.a.createElement(g.a,{"aria-label":"Refresh list",onClick:i},l.a.createElement(ut.a,null)))))}),lr=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleOpenFilter=function(){a.setState({isOpenFilter:!0})},a.handleCloseFilter=function(){a.setState({isOpenFilter:!1})},a.onDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,r=n.onDelete,s=n.onChange,e.next=3,r(t);case 3:s(a.state.filters);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleConfirmFilter=function(e){var t=Ct(a.props.rows,a.props.filters,e);a.props.onChange(t),a.setState({filters:t,isOpenFilter:!1})},a.handleRefresh=function(){a.props.onChange(a.state.filters)},a.state={isOpenFilter:!1,filters:Ct(e.rows,e.filters,e.defaultFilters)},a.exportRef=l.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.onChange(this.state.filters)}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.primaryTextField,r=t.secondaryTextField,s=t.onEdit,i=t.isDisabled,c=t.classes,o=t.onLike,u=t.isLiked,p=t.avatarField,d=t.defaultAvatarField,h=t.tooltipField,f=t.onMsg,m=t.cntField,v=t.theme,b=t.onViz;return l.a.createElement(le.a,{className:c.listWrapper},l.a.createElement(or,{onFilter:this.handleOpenFilter,isFilterSet:this.state.filters.length>0,actions:this.props.actions,title:this.props.title,onRefresh:this.handleRefresh}),l.a.createElement(Pt,{isLoading:a.isLoading}),l.a.createElement("div",{className:c.list},a.data.map(function(t){return l.a.createElement(cr,{content:e.props.getContent(t),primary:Lt.a.get(t,n),secondary:Lt.a.get(t,r),avatar:Lt.a.get(t,p),defaultAvatar:Lt.a.get(t,d),tooltip:Lt.a.get(t,h),onLike:function(){return o(t)},onViz:function(){return b(t)},actions:l.a.createElement(_t,{disabled:i(t),onEdit:function(){return s(t)},onDelete:function(){return e.onDelete(t)}}),cardActions:l.a.createElement(l.a.Fragment,null,l.a.createElement($e.a,{title:"Like"},l.a.createElement(Te.a,{onClick:function(){return o(t._id)},style:{color:u(t)?v.palette.primary.main:"rgba(0, 0, 0, 0.54)"}},l.a.createElement(qn.a,null),Lt.a.get(t,m))),l.a.createElement(In,{tooltip:"Send message",onClick:function(){return f(t)}},l.a.createElement(Un.a,null)))})})),l.a.createElement(St,{isOpen:this.state.isOpenFilter,onClose:this.handleCloseFilter,onConfirm:this.handleConfirmFilter,store:this.props.store,rows:this.props.rows,filters:this.props.filters,defaultState:this.props.defaultFilters}))}}]),t}(l.a.Component),ur=Object(te.withTheme)()(Object(te.withStyles)(function(e){return{listWrapper:{position:"relative"},list:{display:"flex",flexWrap:"wrap"}}})(lr)),pr=[{field:"user.name",label:"Tag",type:"enum",data:"tagTypes",idField:"typesId"}],dr=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={x:null,isOpen:!1},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.store.getTags(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),a.props.user.showError(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),a.handleEdit=function(e){a.setState({x:e,isOpen:!0})},a.handleDelete=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.deleteTag,e.prev=1,e.next=4,n(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),a.isDisabled=function(e){return a.props.user.user._id!==e.userId},a.handleLike=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.likeTag,r=a.props.user.user,e.prev=2,e.next=5,n(t,r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),a.props.user.showError(e.t0);case 10:case"end":return e.stop()}},e,null,[[2,7]])}));return function(t){return e.apply(this,arguments)}}(),a.handleMsg=function(e){var t=a.props.user.user;window.open("mailto:".concat(e._user.email,"?subject=APP: ").concat(e.name,"&body=%0D%0A").concat(t.name),"_self")},a.isLiked=function(e){return e.likes.includes(a.props.user.user._id)},a.getContent=function(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement(Y.a,{variant:"subtitle1",color:"textPrimary"},e.name),l.a.createElement(Y.a,{variant:"body2",color:"textSecondary",component:"p"},e._tagTypesStr||"\u017eiadne"))},a.getFilters=function(){return[{label:"Likes",field:"likes",data:[{_id:1,name:"Me",filters:[{field:"likes",value:a.props.user.user._id}]}]}]},a.handleViz=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.imgId){e.next=6;break}return e.next=3,a.props.store.getFile(t.imgId);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=null;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.store.tags;return l.a.createElement("div",{className:e.list},l.a.createElement(ur,{data:t,getContent:this.getContent,primaryTextField:"_user.name",secondaryTextField:"_dateStr",avatarField:"_user.avatar",tooltipField:"_user.name",cntField:"likesCnt",onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled,onLike:this.handleLike,isLiked:this.isLiked,filters:this.getFilters(),onViz:this.handleViz,rows:pr,store:this.props.store,title:"Tags",onMsg:this.handleMsg}),l.a.createElement(Wt,{title:"Edit tag",onClose:this.handleClose,isOpen:this.state.isOpen},l.a.createElement(An,{data:this.state.x,onSubmit:this.handleClose})))}}]),t}(l.a.Component),hr=E(Object(te.withStyles)(function(e){return{list:{marginTop:e.spacing.unit}}}),Pe,j,f.f)(dr);var fr,mr,vr,br,gr,wr,xr=Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}})(function(e){return l.a.createElement(ce.a,{container:!0,spacing:24},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(le.a,{className:e.classes.paper},l.a.createElement(An,null)),l.a.createElement(hr,null)))}),kr=[{_id:1,name:"total distance"},{_id:2,name:"total elevation"},{_id:3,name:"total time"},{_id:8,name:"total kudos"},{_id:4,name:"max distance"},{_id:5,name:"max elevation"},{_id:6,name:"max time"},{_id:9,name:"max kudos"},{_id:7,name:"count"}],Or=[{_id:8,name:"#tatranskakoza (12.11. - 12.12.)"},{_id:1,name:"this week"},{_id:2,name:"last week"},{_id:3,name:"this month"},{_id:4,name:"last month"},{_id:5,name:"this year"},{_id:6,name:"my months"},{_id:7,name:"my years"}],Er=[{_id:0,name:"all"},{_id:1,name:"ride"},{_id:2,name:"run"},{_id:3,name:"walk"},{_id:4,name:"hike"}],yr=function(e){switch(e){case 6:return"month";case 7:return"year";default:return"userId"}},jr=function(e){switch(e){case 1:case 2:case 3:case 8:return"sum";case 4:case 5:case 6:case 9:return"max";case 7:default:return"count"}},Cr=function(e){switch(e){case 1:case 4:return"dis";case 2:case 5:return"total_elevation_gain";case 3:case 6:return"moving_time";case 8:case 9:return"kudos_count";default:return"_id"}},Sr=function(e,t){return{field:yr(e),op:jr(t),opField:Cr(t)}},Dr=function(e){switch(e){case 1:return[{field:"type",value:"Ride"}];case 2:return[{field:"type",value:"Run"}];case 3:return[{field:"type",value:"Walk"}];case 4:return[{field:"type",value:"Hike"}];case 0:default:return[]}},Tr=function(e,t){switch(e){case 1:return[{field:"start_date",op:"lte",value:jt()().endOf("week").toDate()},{field:"start_date",op:"gte",value:jt()().startOf("week").toDate()}];case 2:return[{field:"start_date",op:"lte",value:jt()().subtract(1,"weeks").endOf("week").toDate()},{field:"start_date",op:"gte",value:jt()().subtract(1,"weeks").startOf("week").toDate()}];case 3:return[{field:"start_date",op:"lte",value:jt()().endOf("month").toDate()},{field:"start_date",op:"gte",value:jt()().startOf("month").toDate()}];case 4:return[{field:"start_date",op:"lte",value:jt()().subtract(1,"month").endOf("month").toDate()},{field:"start_date",op:"gte",value:jt()().subtract(1,"month").startOf("month").toDate()}];case 5:return[{field:"start_date",op:"lte",value:jt()().endOf("year").toDate()},{field:"start_date",op:"gte",value:jt()().startOf("year").toDate()}];case 6:case 7:return[{field:"userId",value:t._id}];case 8:return[{field:"start_date",op:"lte",value:new Date(2020,11,12,23,59,0,0)},{field:"start_date",op:"gte",value:new Date(2020,10,12,0,0,0,0)}];default:return[]}},_r=function(e){switch(e){case 6:return{field:"_id",label:"Months",filterable:!1,disablePadding:!0};case 7:return{field:"_id",label:"Years",filterable:!1,disablePadding:!0};default:return{field:"_user.name",label:"User",filterable:!1,sortable:!1,disablePadding:!0}}},Nr=function(e){switch(e){case 1:case 4:return{field:"val",label:"Distance *",filterable:!1};case 2:case 5:return{field:"val",label:"Elevation",filterable:!1};case 3:case 6:return{field:"val",label:"Time",filterable:!1};case 7:return{field:"val",label:"Count",filterable:!1};case 8:case 9:return{field:"val",label:"Kudos",filterable:!1};default:return{field:"val",label:"Value",filterable:!1}}},Ir=function(e,t){return[_r(e),Nr(t)]},Pr=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e,t,n){gr=e,mr=n,vr=t,a.getList()},a.getList=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=[].concat(Object(Ae.a)(fr),Object(Ae.a)(gr),Object(Ae.a)(wr)),e.next=4,a.props.store.getActivities(br,t,vr,mr);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),a.props.user.showError(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])})),a.isDisabled=function(e){return!0},a.handleChangeType=function(e,t){a.setState(Object(C.a)({},e,t)),wr=Dr(t),a.getList()},a.handleChangeOp=function(e,t){a.setState(Object(C.a)({},e,t)),br=Sr(a.state.groupId,t),a.getList()},a.handleChangeGroup=function(e,t){var n=a.props.user.user;a.setState(Object(C.a)({},e,t)),fr=Tr(t,n),br=Sr(t,a.state.opId),a.getList()},a.state={opId:1,groupId:8,typeId:0},fr=Tr(8,e.user.user),br=Sr(8,1),wr=[],a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.opId,a=e.groupId,n=e.typeId;return l.a.createElement("div",null,l.a.createElement(le.a,{className:this.props.classes.paper},l.a.createElement(Se,{label:"Type",value:n,field:"typeId",onChange:this.handleChangeType,data:Er,textField:"name",required:!0}),l.a.createElement(Se,{label:"Stats",value:t,field:"opId",onChange:this.handleChangeOp,data:kr,textField:"name",required:!0}),l.a.createElement(Se,{label:"Group",value:a,field:"groupId",onChange:this.handleChangeGroup,data:Or,textField:"name",required:!0})),l.a.createElement(Mt,{rows:Ir(this.state.groupId,this.state.opId),data:"activities",onChange:this.handleChange,title:"Activities",store:this.props.store,filters:[{label:"Sex",field:"sex",data:[{_id:1,name:"Male",filters:[{field:"sex",op:"eq",value:"M"}]},{_id:2,name:"Female",filters:[{field:"sex",op:"eq",value:"F"}]}]}],defaultSort:{field:"val",dir:"desc"},isDisabled:this.isDisabled}),l.a.createElement(Y.a,{variant:"body1",className:this.props.classes.footer},"* bike distance calc as distance * 0.33"))}}]),t}(l.a.Component),Fr=E(Pe,j,Object(te.withStyles)(function(e){return{paper:{marginBottom:e.spacing.unit},footer:{marginTop:e.spacing.unit}}}))(Pr);var Rr=E(Object(te.withStyles)(function(e){return{paper:{padding:e.spacing.unit}}}),j)(function(e){return l.a.createElement(ce.a,{container:!0,spacing:16},l.a.createElement(ce.a,{item:!0,xs:12},l.a.createElement(Fr,null)))}),Lr=[{name:"records",path:"/records",component:Gt,label:"Records",exact:!0,permission:Va.tasks},{name:"clients",path:"/clients",component:sn,label:"Clients",exact:!0,permission:Va.report},{name:"projects",path:"/projects",component:ba,label:"Projects",exact:!0,permission:Va.tasks},{name:"reports",path:"/reports",component:Za,label:"Reports",exact:!0,permission:Va.tasks},{name:"events",path:"/events",component:fn,label:"Events",exact:!0,permission:Va.tasks},{name:"calendar",path:"/calendar",component:On,label:"Calendar",exact:!0,permission:Va.events},{name:"sign",path:"/sign",component:Tn,label:"Sign data",exact:!0,permission:Va.report},{name:"verify",path:"/verify",component:Sn,label:"Verify data",exact:!0,permission:Va.report},{name:"project",path:"/projects/:id",component:Sa,label:"Project",permission:Va.tasks},{name:"login",path:"/login",component:ca,label:"Login",anonymous:!0,exact:!0,hidden:!0},{name:"oauth",path:"/",component:$a,label:"Auth",anonymous:!0,exact:!0,hidden:!0},{name:"tags",path:"/tags",component:xr,label:"Tags",exact:!0,permission:Va.tags},{name:"activities",path:"/activities",component:Rr,label:"Activities",exact:!0,permission:Va.activities},{name:"account",path:"/account",component:Ba,label:"Account",exact:!0}],Ar="/",Mr=function(e){function t(e){var a;Object(n.a)(this,t),a=Object(s.a)(this,Object(i.a)(t).call(this,e));var r=new URL("https://kristianduda.sk/app");return Ar=r.pathname,a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.classes;return l.a.createElement(l.a.Fragment,null,l.a.createElement(h.a,{basename:Ar},l.a.createElement(se,{user:t,routes:Lr},Lr.map(function(e){return e.anonymous?l.a.createElement(f.b,{key:e.name,path:e.path,exact:e.exact,component:e.component}):l.a.createElement(qr,{exact:e.exact,key:e.name,path:e.path,component:e.component,user:t,permission:e.permission})}))),l.a.createElement(v.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t.msg,autoHideDuration:6e3,onClose:t.hideMsg,ContentProps:{"aria-describedby":"message-id"},message:l.a.createElement("span",{id:"message-id"},t.msg),action:[l.a.createElement(g.a,{key:"close","aria-label":"Close",color:"inherit",className:a.close,onClick:t.hideMsg},l.a.createElement(x.a,null))]}))}}]),t}(l.a.Component);function qr(e){var t=e.component,a=e.user,n=e.permission,r=Object(d.a)(e,["component","user","permission"]);return l.a.createElement(f.b,Object.assign({},r,{render:function(e){return a.user?n&&!a.hasPermission(n)?l.a.createElement(f.a,{to:{pathname:Zt.home,state:{from:e.location}}}):l.a.createElement(t,e):l.a.createElement(f.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var Wr=E(O()(function(e){return{close:{padding:e.spacing.unit/2}}}),j)(Mr);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ur,zr=function(){return e="USER",JSON.parse(sessionStorage.getItem(e));var e},Vr=function(e){var t,a;t="USER",a=e,sessionStorage.setItem(t,JSON.stringify(a))},Br=function(){var e;e="USER",sessionStorage.removeItem(e)},Jr=a(202),Gr=(a(340),[]),Hr={limit:1e3,skip:0},Yr={field:"_id",dir:"asc"},Kr=[],Xr=function(){var e=zr();return{Accept:"application/json","Content-Type":"application/json",Authorization:e?"Bearer  ".concat(e.token):null}},Zr=function(){var e=Object(de.a)(pe.a.mark(function e(){var t,a,n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(Zt.url.auth,"/api/User/refresh"),a=zr(),e.next=4,fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:a?"Bearer ".concat(a.refreshToken):null}});case 4:if(200!==(n=e.sent).status){e.next=14;break}return e.next=8,n.json();case 8:return(r=e.sent).refreshToken=a.refreshToken,Vr(r),e.abrupt("return",!0);case 14:return Br(),e.abrupt("return",!1);case 16:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Qr=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(t,"/").concat(a),e.next=3,fetch(n,{headers:Xr()});case 3:if(200!==(r=e.sent).status){e.next=10;break}return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 10:if(404!==r.status){e.next=14;break}return e.abrupt("return",null);case 14:if(e.t0=401===r.status,!e.t0){e.next=19;break}return e.next=18,Zr();case 18:e.t0=e.sent;case 19:if(!e.t0){e.next=25;break}return e.next=22,Qr(t,a);case 22:return e.abrupt("return",e.sent);case 25:throw new Error(r.statusText);case 26:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),$r=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a,n,r,s,i,c,o,l=arguments;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:Gr,n=l.length>2&&void 0!==l[2]?l[2]:Yr,r=l.length>3&&void 0!==l[3]?l[3]:Hr,s=l.length>4&&void 0!==l[4]?l[4]:Kr,i="".concat(t,"?filters=").concat(JSON.stringify(a),"&page=").concat(JSON.stringify(r),"&sort=").concat(JSON.stringify(n),"&fields=").concat(JSON.stringify(s)),e.next=7,fetch(i,{headers:Xr()});case 7:if(200!==(c=e.sent).status){e.next=19;break}return e.next=11,c.json();case 11:return(o=e.sent).filters=a,o.sort=n,o.page=r,o.fields=s,e.abrupt("return",o);case 19:if(e.t0=401===c.status,!e.t0){e.next=24;break}return e.next=23,Zr();case 23:e.t0=e.sent;case 24:if(!e.t0){e.next=30;break}return e.next=27,$r(t,a,n,r,s);case 27:return e.abrupt("return",e.sent);case 30:throw new Error(c.statusText);case 31:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),es=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n){var r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t,"/").concat(n),e.next=3,fetch(r,{method:"PUT",headers:Xr(),body:JSON.stringify(a)});case 3:if(200!==(s=e.sent).status){e.next=10;break}return e.next=7,s.json();case 7:return e.abrupt("return",e.sent);case 10:if(e.t0=401===s.status,!e.t0){e.next=15;break}return e.next=14,Zr();case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=21;break}return e.next=18,es(t,a,n);case 18:return e.abrupt("return",e.sent);case 21:throw new Error(s.statusText);case 22:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),ts=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,(r=new FormData).append("file",a),e.next=5,fetch(n,{method:"POST",headers:{Authorization:"Bearer "+zr().token},body:r});case 5:if(200!==(s=e.sent).status){e.next=12;break}return e.next=9,s.json();case 9:return e.abrupt("return",e.sent);case 12:if(e.t0=401===s.status,!e.t0){e.next=17;break}return e.next=16,Zr();case 16:e.t0=e.sent;case 17:if(!e.t0){e.next=23;break}return e.next=20,rs(t,a);case 20:return e.abrupt("return",e.sent);case 23:throw new Error(s.statusText);case 24:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),as=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(t,"/").concat(a),e.next=3,fetch(n,{method:"GET",headers:{Authorization:"Bearer "+zr().token}});case 3:if(200!==(r=e.sent).status){e.next=10;break}return e.next=7,r.blob();case 7:return e.abrupt("return",e.sent);case 10:if(e.t0=401===r.status,!e.t0){e.next=15;break}return e.next=14,Zr();case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=21;break}return e.next=18,as(t,a);case 18:return e.abrupt("return",e.sent);case 21:throw new Error(r.statusText);case 22:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),ns=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(t,"/").concat(a),e.next=3,fetch(n,{method:"DELETE",headers:{Authorization:"Bearer "+zr().token}});case 3:if(200!==(r=e.sent).status){e.next=7;break}e.next=19;break;case 7:if(e.t0=401===r.status,!e.t0){e.next=12;break}return e.next=11,Zr();case 11:e.t0=e.sent;case 12:if(!e.t0){e.next=18;break}return e.next=15,ns(t,a);case 15:return e.abrupt("return",e.sent);case 18:throw new Error(r.statusText);case 19:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),rs=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,fetch(n,{method:"POST",headers:Xr(),body:JSON.stringify(a)});case 3:if(200!==(r=e.sent).status){e.next=10;break}return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 10:if(e.t0=401===r.status,!e.t0){e.next=15;break}return e.next=14,Zr();case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=21;break}return e.next=18,rs(t,a);case 18:return e.abrupt("return",e.sent);case 21:throw new Error(r.statusText);case 22:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),ss=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(t,"/").concat(a),e.next=3,fetch(n,{method:"DELETE",headers:Xr()});case 3:if(200!==(r=e.sent).status){e.next=7;break}e.next=19;break;case 7:if(e.t0=401===r.status,!e.t0){e.next=12;break}return e.next=11,Zr();case 11:e.t0=e.sent;case 12:if(!e.t0){e.next=18;break}return e.next=15,ss(t,a);case 15:return e.abrupt("return",e.sent);case 18:throw new Error(r.statusText);case 19:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),is=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(t,"?filters=").concat(JSON.stringify(a)),e.next=3,fetch(n,{method:"DELETE",headers:Xr()});case 3:if(200!==(r=e.sent).status){e.next=7;break}e.next=19;break;case 7:if(e.t0=401===r.status,!e.t0){e.next=12;break}return e.next=11,Zr();case 11:e.t0=e.sent;case 12:if(!e.t0){e.next=18;break}return e.next=15,is(t,a);case 15:return e.abrupt("return",e.sent);case 18:throw new Error(r.statusText);case 19:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),cs=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r,s,i,c,o=arguments;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:Gr,r=o.length>3&&void 0!==o[3]?o[3]:Yr,s=o.length>4&&void 0!==o[4]?o[4]:Hr,i="".concat(t,"/aggregation?group=").concat(JSON.stringify(a),"&filters=").concat(JSON.stringify(n),"&sort=").concat(JSON.stringify(r),"&page=").concat(JSON.stringify(s)),e.next=6,fetch(i,{headers:Xr()});case 6:if(200!==(c=e.sent).status){e.next=13;break}return e.next=10,c.json();case 10:return e.abrupt("return",e.sent);case 13:if(e.t0=401===c.status,!e.t0){e.next=18;break}return e.next=17,Zr();case 17:e.t0=e.sent;case 18:if(!e.t0){e.next=24;break}return e.next=21,cs(t,a,n,r);case 21:return e.abrupt("return",e.sent);case 24:throw new Error(c.statusText);case 25:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),os=function(){return new Promise(function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){var a={type:"Point",coordinates:[t.coords.latitude,t.coords.longitude]};e(a)},function(e){var a;switch(e.code){case e.PERMISSION_DENIED:a="User denied the request for Geolocation.";break;case e.POSITION_UNAVAILABLE:a="Location information is unavailable.";break;case e.TIMEOUT:a="The request to get user location timed out.";break;case e.UNKNOWN_ERROR:default:a="An unknown error occurred."}t(new Error(a))}):t("Geolocation is not supported by this browser.")})},ls=function(){return"".concat(Zt.url.auth,"/api/user")},us=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r,s,i,c=arguments;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:"",r="".concat(Zt.url.auth,"/api/user/auth"),e.next=4,fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:a,token:n})});case 4:if(200!==(s=e.sent).status){e.next=13;break}return e.next=8,s.json();case 8:return i=e.sent,Vr(i),e.abrupt("return",i);case 13:if(401!==s.status){e.next=17;break}return e.abrupt("return",null);case 17:throw new Error(s.statusText);case 18:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),ps=function(e){return"".concat("https://kristianduda.sk/app","?provider=").concat(e)},ds=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(Zt.url.auth,"/api/user/oauth"),e.next=3,fetch(n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({provider:t,code:a,redirect_uri:ps(t),config:Zt.configId})});case 3:if(200!==(r=e.sent).status){e.next=12;break}return e.next=7,r.json();case 7:return s=e.sent,Vr(s),e.abrupt("return",s);case 12:if(401!==r.status){e.next=16;break}return e.abrupt("return",null);case 16:throw new Error(r.statusText);case 17:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),hs=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a,n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(Zt.url.auth,"/api/user/reset"),e.next=3,fetch(a,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,redirectUri:"https://kristianduda.sk/app"})});case 3:if(200===(n=e.sent).status){e.next=6;break}throw new Error(n.statusText);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),fs=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(Zt.url.auth,"/api/user/oauth"),e.next=3,fetch(n,{method:"PUT",headers:Xr(),body:JSON.stringify({provider:t,code:a,redirect_uri:ps(t)})});case 3:if(200!==(r=e.sent).status){e.next=10;break}return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 10:if(e.t0=401===r.status,!e.t0){e.next=15;break}return e.next=14,Zr();case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=21;break}return e.next=18,fs(t,a);case 18:return e.abrupt("return",e.sent);case 21:throw new Error(r.statusText);case 22:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),ms=function(){var e=Object(de.a)(pe.a.mark(function e(){var t,a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(Zt.url.auth,"/api/user/secret"),e.next=3,fetch(t,{method:"POST",headers:Xr()});case 3:if(200!==(a=e.sent).status){e.next=10;break}return e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 10:if(e.t0=401===a.status,!e.t0){e.next=15;break}return e.next=14,Zr();case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=21;break}return e.next=18,ms();case 18:return e.abrupt("return",e.sent);case 21:throw new Error(a.statusText);case 22:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),vs=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a,n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(Zt.url.auth,"/api/user/sign?withQrCode=true"),e.next=3,fetch(a,{method:"POST",headers:Xr(),body:JSON.stringify({data:t})});case 3:if(200!==(n=e.sent).status){e.next=10;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 10:if(e.t0=401===n.status,!e.t0){e.next=15;break}return e.next=14,Zr();case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=21;break}return e.next=18,vs(t);case 18:return e.abrupt("return",e.sent);case 21:throw new Error(n.statusText);case 22:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),bs=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(Zt.url.auth,"/api/user/verify"),e.next=3,fetch(n,{method:"POST",headers:Xr(),body:JSON.stringify({data:t,signature:a})});case 3:if(200!==(r=e.sent).status){e.next=8;break}return e.abrupt("return",!0);case 8:if(400!==r.status){e.next=12;break}return e.abrupt("return",!1);case 12:if(e.t0=401===r.status,!e.t0){e.next=17;break}return e.next=16,Zr();case 16:e.t0=e.sent;case 17:if(!e.t0){e.next=23;break}return e.next=20,bs(t,a);case 20:return e.abrupt("return",e.sent);case 23:throw new Error(r.statusText);case 24:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),gs=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a,n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={field:"name",dir:"asc"},e.next=4,$r(ls(),t,a);case 4:return n=e.sent,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),ws={},xs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,ws[t]){e.next=5;break}return e.next=4,ks(t);case 4:ws[t]=e.sent;case 5:return e.abrupt("return",ws[t]);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),ks=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qr(ls(),t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),Os=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,es(ls(),a,t);case 3:return n=e.sent,r=zr(),Vr(Object(Da.a)({},n,{token:r.token,refreshToken:r.refreshToken})),e.abrupt("return",n);case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t,a){return e.apply(this,arguments)}}(),Es=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={user:zr(),msg:null,users:{total:0,data:[]},secret:null,signature:null},a.showMsg=function(e){a.setState({msg:e})},a.showError=function(e){a.setState({msg:e.message})},a.hideMsg=function(){a.setState({msg:null})},a.auth=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r){var s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,us(t,n,r);case 3:return s=e.sent,a.setState({user:s}),e.abrupt("return",s);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.generateSecret=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ms();case 3:t=e.sent,a.setState({secret:t}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])})),a.sign=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,vs(btoa(t));case 3:n=e.sent,a.setState({signature:n}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.verify=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bs(t,n);case 3:r=e.sent,a.setState({signature:{data:r?atob(t):"NOT VALID",signature:n}}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),a.oAuth=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ds(t,n);case 3:return r=e.sent,a.setState({user:r}),e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),a.updateOauth=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fs(t,n);case 3:r=e.sent,a.setState({user:r}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),a.updateUser=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Os(t,n);case 3:return r=e.sent,a.setState({user:r}),e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),a.reset=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,hs(t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),a.getUsers=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,gs(t);case 3:n=e.sent,a.setState({users:n}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.hasPermission=function(e){return a.state.user&&(a.state.user.permissions&e)>0},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.children;return l.a.createElement(y.Provider,{value:Object(Da.a)({auth:this.auth,hideMsg:this.hideMsg,showMsg:this.showMsg,showError:this.showError,generateSecret:this.generateSecret,oAuth:this.oAuth,updateOauth:this.updateOauth,getUsers:this.getUsers,getUser:ks,updateUser:this.updateUser,hasPermission:this.hasPermission,reset:this.reset,sign:this.sign,verify:this.verify},this.state)},e)}}]),t}(l.a.Component),ys=function(e){return"".concat(Zt.url.store,"/api/store/").concat(e)},js=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.date.setHours(0,0,0,0),e.next=5,rs(ys("timeRecords"),t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),Cs=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.start.setHours(0,0,0,0),t.end.setHours(23,59,0,0),e.next=6,rs(ys("events"),t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),Ss=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.collaborators=[].concat(Object(Ae.a)(t.collaborators),[a._id]),e.next=5,rs(ys("projects"),t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),Ds=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,e.next=4,rs(ys("clients"),t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),Ts=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a="".concat(Zt.url.store,"/api/file"),e.next=4,ts(a,t);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),_s=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a="".concat(Zt.url.store,"/api/file"),e.next=4,as(a,t);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Ns=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a="".concat(Zt.url.store,"/api/file"),e.next=4,ns(a,t);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Is=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.date=new Date,e.next=5,os();case 5:if(t.location=e.sent,!t._img){e.next=12;break}return e.next=9,Ts(t._img);case 9:n=e.sent,t.imgId=n._id,t._img=null;case 12:return e.next=14,rs(ys("tags"),t);case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}},e,null,[[0,16]])}));return function(t,a){return e.apply(this,arguments)}}(),Ps=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.collaborators=[].concat(Object(Ae.a)(t.collaborators),[a._id]),e.next=4,es(ys("projects"),t,t._id);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),Fs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.date.setHours(0,0,0,0),e.next=4,es(ys("timeRecords"),t,t._id);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),Rs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.start.setHours(0,0,0,0),t.end.setHours(23,59,0,0),e.next=5,es(ys("events"),t,t._id);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Ls=function(){var e=Object(de.a)(pe.a.mark(function e(){var t,a,n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=zr(),a={field:"_id",dir:"desc"},n=[{field:"collaborators",op:"eq",value:t._id}],e.next=6,$r(ys("projects"),n,a);case 6:return(r=e.sent).data.forEach(function(e){e.collaborators=e.collaborators.filter(function(e){return e!==t._id})}),e.abrupt("return",r);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}(),As=function(){var e=Object(de.a)(pe.a.mark(function e(t,a){var n,r,s,i,c,o,l,u,p,d,h,f;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,os();case 3:return(n=e.sent).max=null,r=jt()().subtract(1,"day").toDate(),s=[].concat(Object(Ae.a)(t),[{field:"location",op:"near",value:n},{field:"date",op:"gt",value:r}]),i={field:"location",dir:"asc"},e.next=10,$r(ys("tags"),s,i);case 10:(c=e.sent).filters=t,o=!0,l=!1,u=void 0,e.prev=15,p=c.data[Symbol.iterator]();case 17:if(o=(d=p.next()).done){e.next=30;break}return(h=d.value).date=h.date?new Date(h.date):null,h._dateStr=h.date.toLocaleString(),e.next=23,xs(h.userId);case 23:h._user=e.sent,f="",h.typesId.forEach(function(e,t){0!==t&&(f+=" | ");var n=a.data.find(function(t){return t._id===e});f+=n.name}),h._tagTypesStr=f;case 27:o=!0,e.next=17;break;case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(15),l=!0,u=e.t0;case 36:e.prev=36,e.prev=37,o||null==p.return||p.return();case 39:if(e.prev=39,!l){e.next=42;break}throw u;case 42:return e.finish(39);case 43:return e.finish(36);case 44:return e.abrupt("return",c);case 47:throw e.prev=47,e.t1=e.catch(0),e.t1;case 50:case"end":return e.stop()}},e,null,[[0,47],[15,32,36,44],[37,,39,43]])}));return function(t,a){return e.apply(this,arguments)}}(),Ms=function(e,t){switch(e.opField){case"dis":return"".concat(Math.round(t/100)/10," km");case"total_elevation_gain":return"".concat(t," m");case"moving_time":return function(e){var t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return a<10&&(a="0"+a),n<10&&(n="0"+n),"".concat(t,":").concat(a,":").concat(n)}(t);default:return t.toString()}},qs=function(e){return function(e){var t=e.substring(0,4),a=e.substring(4,6),n=e.substring(6,8);return new Date(t,a,n)}(e.toString()).toLocaleString("default",{month:"long",year:"numeric"})},Ws=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n,r){var s,i,c,o,l,u,p;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,cs(ys("activities"),t,a,r,n);case 3:s=e.sent,i=!0,c=!1,o=void 0,e.prev=7,l=s.data[Symbol.iterator]();case 9:if(i=(u=l.next()).done){e.next=22;break}if(p=u.value,"userId"!==t.field){e.next=17;break}return e.next=14,xs(p._id);case 14:p._user=e.sent,e.next=18;break;case 17:"month"===t.field?p._id=qs(p._id):"year"===t.field&&(p._id=p._id.toString().substring(0,4));case 18:p.val=Ms(t,p.val);case 19:i=!0,e.next=9;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(7),c=!0,o=e.t0;case 28:e.prev=28,e.prev=29,i||null==l.return||l.return();case 31:if(e.prev=31,!c){e.next=34;break}throw o;case 34:return e.finish(31);case 35:return e.finish(28);case 36:return e.abrupt("return",s);case 39:throw e.prev=39,e.t1=e.catch(0),e.t1;case 42:case"end":return e.stop()}},e,null,[[0,39],[7,24,28,36],[29,,31,35]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),Us=function(){var e=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$r(ys("clients"));case 3:return t=e.sent,e.abrupt("return",t);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),zs=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qr(ys("projects"),t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Vs=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qr(ys("clients"),t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Bs=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a,n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={field:"date",op:"sum",opField:"duration"},e.next=4,cs(ys("timeRecords"),a,t);case 4:return(n=e.sent).sum=0,n.data.forEach(function(e){e.name=new Date(e._id).toLocaleDateString("en-US"),n.sum+=e.val}),e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),Js=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n){var r,s,i,c,o,l,u,p;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={field:"date",dir:"desc"},e.next=4,$r(ys("timeRecords"),a,r,n);case 4:s=e.sent,i=!0,c=!1,o=void 0,e.prev=8,l=pe.a.mark(function e(){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=p.value).date=a.date?new Date(a.date):null,a._project=t.find(function(e){return e._id===a.projectId}),!a.taskId){e.next=9;break}return e.next=6,ii(a.taskId);case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0={name:null};case 10:return a._task=e.t0,e.next=13,xs(a.userId);case 13:a._user=e.sent;case 14:case"end":return e.stop()}},e)}),u=s.data[Symbol.iterator]();case 11:if(i=(p=u.next()).done){e.next=16;break}return e.delegateYield(l(),"t0",13);case 13:i=!0,e.next=11;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(8),c=!0,o=e.t1;case 22:e.prev=22,e.prev=23,i||null==u.return||u.return();case 25:if(e.prev=25,!c){e.next=28;break}throw o;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",s);case 33:throw e.prev=33,e.t2=e.catch(0),e.t2;case 36:case"end":return e.stop()}},e,null,[[0,33],[8,18,22,30],[23,,25,29]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Gs=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n){var r,s,i,c,o,l,u,p;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={field:"start",dir:"desc"},e.next=4,$r(ys("events"),a,r,n);case 4:s=e.sent,i=!0,c=!1,o=void 0,e.prev=8,l=pe.a.mark(function e(){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=p.value).start=a.start?new Date(a.start):null,a.end=a.end?new Date(a.end):null,e.next=5,xs(a.userId);case 5:a._user=e.sent,a._eventType=t.find(function(e){return e._id===a.eventTypeId});case 7:case"end":return e.stop()}},e)}),u=s.data[Symbol.iterator]();case 11:if(i=(p=u.next()).done){e.next=16;break}return e.delegateYield(l(),"t0",13);case 13:i=!0,e.next=11;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(8),c=!0,o=e.t1;case 22:e.prev=22,e.prev=23,i||null==u.return||u.return();case 25:if(e.prev=25,!c){e.next=28;break}throw o;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",s);case 33:throw e.prev=33,e.t2=e.catch(0),e.t2;case 36:case"end":return e.stop()}},e,null,[[0,33],[8,18,22,30],[23,,25,29]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Hs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ss(ys("timeRecords"),t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Ys=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ss(ys("events"),t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),Ks=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ss(ys("projects"),t);case 3:return e.next=5,is(ys("tasks"),[{field:"projectId",value:t}]);case 5:return e.next=7,is(ys("timeRecords"),[{field:"projectId",value:t}]);case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),Xs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ss(ys("tasks"),t);case 3:return e.next=5,is(ys("timeRecords"),[{field:"taskId",value:t}]);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),Zs=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.projectId=n,e.next=5,rs(ys("tasks"),t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Qs=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,es(ys("tasks"),t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),$s=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,es(ys("clients"),t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),ei=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,es(ys("tags"),t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),ti=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ss(ys("clients"),t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),ai=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ss(ys("tags"),t._id);case 3:if(!t.imgId){e.next=6;break}return e.next=6,Ns(t.imgId);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),ni=function(){var e=Object(de.a)(pe.a.mark(function e(t,a,n,r){var s,i,c,o,l,u,p;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$r(ys("tasks"),a,r,n);case 3:s=e.sent,i=!0,c=!1,o=void 0,e.prev=7,l=pe.a.mark(function e(){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=p.value).assignedToId){e.next=7;break}return e.next=4,xs(a.assignedToId);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=null;case 8:a._assignedTo=e.t0,a._state=t.find(function(e){return e._id===a.stateId});case 10:case"end":return e.stop()}},e)}),u=s.data[Symbol.iterator]();case 10:if(i=(p=u.next()).done){e.next=15;break}return e.delegateYield(l(),"t0",12);case 12:i=!0,e.next=10;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(7),c=!0,o=e.t1;case 21:e.prev=21,e.prev=22,i||null==u.return||u.return();case 24:if(e.prev=24,!c){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return e.abrupt("return",s);case 32:throw e.prev=32,e.t2=e.catch(0),e.t2;case 35:case"end":return e.stop()}},e,null,[[0,32],[7,17,21,29],[22,,24,28]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),ri=function(){var e=Object(de.a)(pe.a.mark(function e(t){var a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qr(ys("tasks"),t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),si={},ii=function(){var e=Object(de.a)(pe.a.mark(function e(t){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,si[t]){e.next=5;break}return e.next=4,ri(t);case 4:si[t]=e.sent;case 5:return e.abrupt("return",si[t]);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),ci=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).getProjects=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{projects:Object(Da.a)({},e.projects,{isLoading:!0})}}),e.next=4,Ls();case 4:(t=e.sent).isLoading=!1,a.setState({projects:t}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])})),a.getTags=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{tags:Object(Da.a)({},e.tags,{isLoading:!0})}}),e.next=4,As(t,a.state.tagTypes);case 4:(n=e.sent).isLoading=!1,a.setState({tags:n}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),a.setState(function(e){return{tags:Object(Da.a)({},e.tags,{isLoading:!1})}}),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),a.getActivities=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r,s){var i;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{activities:Object(Da.a)({},e.activities,{isLoading:!0})}}),e.next=4,Ws(t,n,r,s);case 4:(i=e.sent).isLoading=!1,a.setState({activities:i}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),a.setState(function(e){return{activities:Object(Da.a)({},e.activities,{isLoading:!1})}}),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),a.handleChange=function(e,t){a.setState(Object(C.a)({},e,t))},a.getProject=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n,r,s,i,c,o,l,u,p;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,zs(t);case 3:n=e.sent,r=[],s=!0,i=!1,c=void 0,e.prev=8,o=n.collaborators[Symbol.iterator]();case 10:if(s=(l=o.next()).done){e.next=19;break}return u=l.value,e.next=14,xs(u);case 14:p=e.sent,r.push(p);case 16:s=!0,e.next=10;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(8),i=!0,c=e.t0;case 25:e.prev=25,e.prev=26,s||null==o.return||o.return();case 28:if(e.prev=28,!i){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(25);case 33:a.setState({project:n,users:{total:r.length,data:r}}),e.next=39;break;case 36:throw e.prev=36,e.t1=e.catch(0),e.t1;case 39:case"end":return e.stop()}},e,null,[[0,36],[8,21,25,33],[26,,28,32]])}));return function(t){return e.apply(this,arguments)}}(),a.getClient=function(){var e=Object(de.a)(pe.a.mark(function e(t){var n;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Vs(t);case 3:n=e.sent,a.setState({client:n}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.getClients=Object(de.a)(pe.a.mark(function e(){var t;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{clients:Object(Da.a)({},e.clients,{isLoading:!0})}}),e.next=4,Us();case 4:(t=e.sent).isLoading=!1,a.setState({clients:t}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,null,[[0,9]])})),a.refreshTimeRecords=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{timeRecords:Object(Da.a)({},e.timeRecords,{isLoading:!0})}}),t=a.state.timeRecords,n=t.filters,r=t.page,e.next=5,Ls();case 5:return s=e.sent,e.next=8,Js(s.data,n,r);case 8:return i=e.sent,e.next=11,Bs(n);case 11:c=e.sent,i.isLoading=!1,a.setState({timeRecords:i,stats:c,projects:s}),e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}},e,null,[[0,16]])})),a.refreshEvents=Object(de.a)(pe.a.mark(function e(){var t,n,r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{events:Object(Da.a)({},e.events,{isLoading:!0})}}),t=a.state.events,n=t.filters,r=t.page,e.next=5,Gs(a.state.eventTypes.data,n,r);case 5:(s=e.sent).isLoading=!1,a.setState({events:s}),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,10]])})),a.getEvents=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r,s;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{events:Object(Da.a)({},e.events,{isLoading:!0})}}),e.next=4,gs([]);case 4:return r=e.sent,e.next=7,Gs(a.state.eventTypes.data,t,n);case 7:return(s=e.sent).isLoading=!1,a.setState({events:s,users:r}),e.abrupt("return",s);case 13:throw e.prev=13,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}},e,null,[[0,13]])}));return function(t,a){return e.apply(this,arguments)}}(),a.refreshTasks=Object(de.a)(pe.a.mark(function e(){var t,n,r,s,i,c;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{tasks:Object(Da.a)({},e.tasks,{isLoading:!0})}}),t=a.state.tasks,n=t.filters,r=t.page,s=t.sort,i=a.state.states.data,e.next=6,ni(i,n,r,s);case 6:(c=e.sent).isLoading=!1,a.setState({tasks:c}),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}},e,null,[[0,11]])})),a.getTasks=function(){var e=Object(de.a)(pe.a.mark(function e(t,n,r,s){var i,c,o;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{tasks:Object(Da.a)({},e.tasks,{isLoading:!0})}}),i=[].concat(Object(Ae.a)(n),[{field:"projectId",op:"eq",value:t}]),c=a.state.states.data,e.next=6,ni(c,i,r,s);case 6:return(o=e.sent).isLoading=!1,a.setState({tasks:o}),e.abrupt("return",o);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),a.getOpenedTasks=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=[{field:"stateId",op:"ne",value:3},{field:"assignedToId",value:n._id}],e.next=4,a.getTasks(t,r,void 0);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.likeTag=function(e,t){a.setState(function(a){return{tags:Object(Da.a)({},a.tags,{data:a.tags.data.map(function(a){if(a._id===e){var n=a.likes.indexOf(t._id);n>-1?(a.likes.splice(n,1),a.likesCnt=a.likesCnt-1):(a.likes.push(t._id),a.likesCnt=a.likesCnt+1),ei(a)}return a})})}})},a.getTimeRecords=function(){var e=Object(de.a)(pe.a.mark(function e(t,n){var r,s,i,c,o;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState(function(e){return{timeRecords:Object(Da.a)({},e.timeRecords,{isLoading:!0})}}),e.next=4,Ls();case 4:return r=e.sent,e.next=7,gs([]);case 7:return s=e.sent,i=[].concat(Object(Ae.a)(t),[{field:"projectId",op:"in",value:r.data.map(function(e){return e._id})}]),e.next=11,Js(r.data,i,n);case 11:return c=e.sent,e.next=14,Bs(i);case 14:return o=e.sent,c.isLoading=!1,a.setState({timeRecords:c,stats:o,projects:r,users:s}),e.abrupt("return",c);case 20:throw e.prev=20,e.t0=e.catch(0),e.t0;case 23:case"end":return e.stop()}},e,null,[[0,20]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleChangeCollection=function(e){console.log("CHANGED: "+e)},a.state={timeRecords:{total:0,data:[],filters:[],page:null,isLoading:!1},events:{total:0,data:[],filters:[],page:null,isLoading:!1},projects:{total:0,data:[],filters:[],isLoading:!1},project:null,client:null,stats:[],users:{total:0,data:[]},tasks:{total:0,data:[],isLoading:!1},clients:{total:0,data:[],isLoading:!1},states:{total:3,data:[{_id:1,name:"To do"},{_id:2,name:"Doing"},{_id:3,name:"Done"}]},eventTypes:{total:1,data:[{_id:1,name:"HO"}]},projectId:null,tags:{total:0,data:[],filters:[],isLoading:!1},tagTypes:{total:1,data:[{_id:1,name:"kompot"},{_id:2,name:"polievka"},{_id:3,name:"hlavne jedlo"}]},activities:{total:0,data:[],isLoading:!1}},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.children;return!Ur&&zr()&&(Ur=!0,function(e){var t=(new Jr.a).withUrl("".concat(Zt.url.store,"/hub"),{accessTokenFactory:function(){return zr().refreshToken}}).configureLogging(Jr.b.Error).build();t.start().catch(function(e){console.error(e)}),t.on("change",e)}(this.handleChangeCollection)),l.a.createElement(Ie.Provider,{value:Object(Da.a)({addTimeRecord:js,addEvent:Cs,getTimeRecords:this.getTimeRecords,getEvents:this.getEvents,refreshEvents:this.refreshEvents,refreshTimeRecords:this.refreshTimeRecords,deleteTimeRecord:Hs,deleteEvent:Ys,addProject:Ss,addClient:Ds,addTag:Is,getClients:this.getClients,editClient:$s,editTag:ei,deleteClient:ti,getProjects:this.getProjects,deleteProject:Ks,deleteTag:ai,addTask:Zs,editTask:Qs,deleteTask:Xs,refreshTasks:this.refreshTasks,editProject:Ps,editTimeRecord:Fs,editEvent:Rs,getTasks:this.getTasks,getProject:this.getProject,getClient:this.getClient,getOpenedTasks:this.getOpenedTasks,handleChange:this.handleChange,getTags:this.getTags,likeTag:this.likeTag,getActivities:this.getActivities,getFile:_s},this.state)},e)}}]),t}(l.a.Component),oi=a(341),li={type:"light",primary:{main:"#bd5d38"},secondary:{main:"#343a40"}},ui=Object(te.createMuiTheme)({palette:li}),pi=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.documentElement.style.setProperty("--primary-color",li.primary.main),document.title="".concat("app"," v").concat("0.2.4")}},{key:"render",value:function(){return l.a.createElement(Es,null,l.a.createElement(ci,null,l.a.createElement(te.MuiThemeProvider,{theme:ui},l.a.createElement(he.b,{utils:oi.a},l.a.createElement(Wr,null)))))}}]),t}(l.a.Component);p.a.render(l.a.createElement(pi,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[371,1,2]]]);
//# sourceMappingURL=main.128e677b.chunk.js.map